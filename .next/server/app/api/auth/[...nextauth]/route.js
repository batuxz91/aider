"use strict";(()=>{var e={};e.id=912,e.ids=[912],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},25528:e=>{e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},23459:(e,t,s)=>{s.r(t),s.d(t,{headerHooks:()=>k,originalPathname:()=>q,requestAsyncStorage:()=>w,routeModule:()=>m,serverHooks:()=>x,staticGenerationAsyncStorage:()=>y,staticGenerationBailout:()=>f});var r={};s.r(r),s.d(r,{GET:()=>g,POST:()=>g});var a=s(10884),n=s(16132),o=s(94020),i=s.n(o),u=s(49375),l=s(39448);let c=process.env.NEXT_PUBLIC_API_URL||"http://localhost:8080/api";let ApiClient=class ApiClient{constructor(e){this.token=null,this.baseURL=e,this.token=null}setToken(e){this.token=e}async request(e,t={}){let s=`${this.baseURL}${e}`,r={"Content-Type":"application/json",...t.headers};this.token&&(r.Authorization=`Bearer ${this.token}`);try{let e=await fetch(s,{...t,headers:r}),a=await e.json();if(!e.ok)throw{message:a.message||"Error en la solicitud",status:e.status,details:a};return{data:a,success:!0}}catch(e){if(e instanceof Error)throw{message:e.message,status:0};throw e}}async get(e,t){let s=new URL(e,this.baseURL);return t&&Object.entries(t).forEach(([e,t])=>{null!=t&&s.searchParams.append(e,String(t))}),this.request(s.pathname+s.search)}async post(e,t){return this.request(e,{method:"POST",body:t?JSON.stringify(t):void 0})}async put(e,t){return this.request(e,{method:"PUT",body:t?JSON.stringify(t):void 0})}async delete(e){return this.request(e,{method:"DELETE"})}async patch(e,t){return this.request(e,{method:"PATCH",body:t?JSON.stringify(t):void 0})}};let p=new ApiClient(c);let AuthService=class AuthService{async login(e){let t=await p.post("/users/login",e);return t.data.token&&p.setToken(t.data.token),t.data}async register(e){let t=await p.post("/users/register",e);return t.data}async getCurrentUser(){let e=await p.get("/users/me");return e.data}async getUserProfile(){let e=await p.get("/users/profile");return e.data}async updateProfile(e){let t=await p.put("/users/me",e);return t.data}async completeProfile(e){let t=await p.post("/users/complete-profile",e);return t.data}async changePassword(e){await p.post("/users/change-password",e)}async forgotPassword(e){await p.post("/users/forgot-password",{email:e})}async resetPassword(e,t){await p.post("/users/reset-password",{token:e,newPassword:t})}async checkEmailExists(e){let t=await p.get(`/users/exists?email=${e}`);return t.data.exists}async deleteAccount(){await p.delete("/users/me"),this.logout()}logout(){p.setToken(null)}isAuthenticated(){return null!==p.token}getToken(){return p.token}};let d=new AuthService,h={providers:[(0,u.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET}),(0,l.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;try{let t=await d.login({email:e.email,password:e.password});return{id:t.user.id.toString(),email:t.user.email,name:`${t.user.firstName} ${t.user.lastName}`,accessToken:t.token}}catch(e){return console.error("Login error:",e),null}}})],callbacks:{jwt:async({token:e,user:t,account:s})=>(t&&s&&(e.accessToken=t.accessToken,e.userId=t.id),e),session:async({session:e,token:t})=>(t&&(e.accessToken=t.accessToken,e.user.id=t.userId),e),async signIn({user:e,account:t,profile:s}){if(t?.provider==="google")try{let t=await d.checkEmailExists(e.email);t||await d.register({firstName:e.name?.split(" ")[0]||"",lastName:e.name?.split(" ").slice(1).join(" ")||"",email:e.email,password:"google-oauth-"+Math.random().toString(36).substring(7),confirmPassword:"google-oauth-"+Math.random().toString(36).substring(7)})}catch(e){return console.error("Google sign in error:",e),!1}return!0}},pages:{signIn:"/login"},session:{strategy:"jwt"},secret:process.env.NEXTAUTH_SECRET},g=i()(h),m=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"C:\\aider\\app\\api\\auth\\[...nextauth]\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:w,staticGenerationAsyncStorage:y,serverHooks:x,headerHooks:k,staticGenerationBailout:f}=m,q="/api/auth/[...nextauth]/route"}};var t=require("../../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[657,568],()=>__webpack_exec__(23459));module.exports=s})();