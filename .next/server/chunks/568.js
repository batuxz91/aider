exports.id=568,exports.ids=[568],exports.modules={85808:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.hkdf=void 0;let u=c(72863);function normalizeDigest(t){switch(t){case"sha256":case"sha384":case"sha512":case"sha1":return t;default:throw TypeError('unsupported "digest" value')}}function normalizeUint8Array(t,r){if("string"==typeof t)return new TextEncoder().encode(t);if(!(t instanceof Uint8Array))throw TypeError(`"${r}"" must be an instance of Uint8Array or a string`);return t}function normalizeIkm(t){let r=normalizeUint8Array(t,"ikm");if(!r.byteLength)throw TypeError('"ikm" must be at least one byte in length');return r}function normalizeInfo(t){let r=normalizeUint8Array(t,"info");if(r.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return r}function normalizeKeylen(t,r){if("number"!=typeof t||!Number.isInteger(t)||t<1)throw TypeError('"keylen" must be a positive integer');let c=parseInt(r.substr(3),10)>>3||20;if(t>255*c)throw TypeError('"keylen" too large');return t}async function hkdf(t,r,c,E,P){return(0,u.default)(normalizeDigest(t),normalizeIkm(r),normalizeUint8Array(c,"salt"),normalizeInfo(E),normalizeKeylen(P,t))}r.hkdf=hkdf,r.default=hkdf},78308:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113);r.default=(t,r,c,E,P)=>{let O=parseInt(t.substr(3),10)>>3||20,J=(0,u.createHmac)(t,c.byteLength?c:new Uint8Array(O)).update(r).digest(),W=Math.ceil(P/O),K=new Uint8Array(O*W+E.byteLength+1),R=0,U=0;for(let r=1;r<=W;r++)K.set(E,U),K[U+E.byteLength]=r,K.set((0,u.createHmac)(t,J).update(K.subarray(R,U+E.byteLength+1)).digest(),U),R=U,U+=O;return K.slice(0,P)}},72863:(t,r,c)=>{"use strict";let u;Object.defineProperty(r,"__esModule",{value:!0});let E=c(6113),P=c(78308);"function"!=typeof E.hkdf||process.versions.electron||(u=async(...t)=>new Promise((r,c)=>{E.hkdf(...t,(t,u)=>{t?c(t):r(new Uint8Array(u))})})),r.default=async(t,r,c,E,O)=>(u||P.default)(t,r,c,E,O)},32133:(t,r,c)=>{"use strict";var u=c(2049);Object.defineProperty(r,"__esModule",{value:!0}),r.UnsupportedStrategy=r.UnknownError=r.OAuthCallbackError=r.MissingSecret=r.MissingAuthorize=r.MissingAdapterMethods=r.MissingAdapter=r.MissingAPIRoute=r.InvalidCallbackUrl=r.AccountNotLinkedError=void 0,r.adapterErrorHandler=adapterErrorHandler,r.capitalize=capitalize,r.eventsErrorHandler=eventsErrorHandler,r.upperSnake=upperSnake;var E=u(c(21264)),P=u(c(48824)),O=u(c(92174)),J=u(c(36707)),W=u(c(91390)),K=u(c(17257)),R=u(c(51327)),U=u(c(52603)),D=u(c(49903));function _callSuper(t,r,c){return r=(0,R.default)(r),(0,K.default)(t,_isNativeReflectConstruct()?Reflect.construct(r,c||[],(0,R.default)(t).constructor):r.apply(t,c))}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}var B=r.UnknownError=function(t){function UnknownError(t){var r,c;return(0,J.default)(this,UnknownError),(c=_callSuper(this,UnknownError,[null!==(r=null==t?void 0:t.message)&&void 0!==r?r:t])).name="UnknownError",c.code=t.code,t instanceof Error&&(c.stack=t.stack),c}return(0,U.default)(UnknownError,t),(0,W.default)(UnknownError,[{key:"toJSON",value:function(){return{name:this.name,message:this.message,stack:this.stack}}}])}((0,D.default)(Error));function upperSnake(t){return t.replace(/([A-Z])/g,"_$1").toUpperCase()}function capitalize(t){return"".concat(t[0].toUpperCase()).concat(t.slice(1))}function eventsErrorHandler(t,r){return Object.keys(t).reduce(function(c,u){return c[u]=(0,P.default)(E.default.mark(function _callee(){var c,P=arguments;return E.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.prev=0,c=t[u],E.next=4,c.apply(void 0,P);case 4:return E.abrupt("return",E.sent);case 7:E.prev=7,E.t0=E.catch(0),r.error("".concat(upperSnake(u),"_EVENT_ERROR"),E.t0);case 10:case"end":return E.stop()}},_callee,null,[[0,7]])})),c},{})}function adapterErrorHandler(t,r){if(t)return Object.keys(t).reduce(function(c,u){return c[u]=(0,P.default)(E.default.mark(function _callee2(){var c,P,O,J,W,K=arguments;return E.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:for(E.prev=0,P=Array(c=K.length),O=0;O<c;O++)P[O]=K[O];return r.debug("adapter_".concat(u),{args:P}),J=t[u],E.next=6,J.apply(void 0,P);case 6:return E.abrupt("return",E.sent);case 9:throw E.prev=9,E.t0=E.catch(0),r.error("adapter_error_".concat(u),E.t0),(W=new B(E.t0)).name="".concat(capitalize(u),"Error"),W;case 15:case"end":return E.stop()}},_callee2,null,[[0,9]])})),c},{})}r.OAuthCallbackError=function(t){function OAuthCallbackError(){var t;(0,J.default)(this,OAuthCallbackError);for(var r=arguments.length,c=Array(r),u=0;u<r;u++)c[u]=arguments[u];return t=_callSuper(this,OAuthCallbackError,[].concat(c)),(0,O.default)(t,"name","OAuthCallbackError"),t}return(0,U.default)(OAuthCallbackError,t),(0,W.default)(OAuthCallbackError)}(B),r.AccountNotLinkedError=function(t){function AccountNotLinkedError(){var t;(0,J.default)(this,AccountNotLinkedError);for(var r=arguments.length,c=Array(r),u=0;u<r;u++)c[u]=arguments[u];return t=_callSuper(this,AccountNotLinkedError,[].concat(c)),(0,O.default)(t,"name","AccountNotLinkedError"),t}return(0,U.default)(AccountNotLinkedError,t),(0,W.default)(AccountNotLinkedError)}(B),r.MissingAPIRoute=function(t){function MissingAPIRoute(){var t;(0,J.default)(this,MissingAPIRoute);for(var r=arguments.length,c=Array(r),u=0;u<r;u++)c[u]=arguments[u];return t=_callSuper(this,MissingAPIRoute,[].concat(c)),(0,O.default)(t,"name","MissingAPIRouteError"),(0,O.default)(t,"code","MISSING_NEXTAUTH_API_ROUTE_ERROR"),t}return(0,U.default)(MissingAPIRoute,t),(0,W.default)(MissingAPIRoute)}(B),r.MissingSecret=function(t){function MissingSecret(){var t;(0,J.default)(this,MissingSecret);for(var r=arguments.length,c=Array(r),u=0;u<r;u++)c[u]=arguments[u];return t=_callSuper(this,MissingSecret,[].concat(c)),(0,O.default)(t,"name","MissingSecretError"),(0,O.default)(t,"code","NO_SECRET"),t}return(0,U.default)(MissingSecret,t),(0,W.default)(MissingSecret)}(B),r.MissingAuthorize=function(t){function MissingAuthorize(){var t;(0,J.default)(this,MissingAuthorize);for(var r=arguments.length,c=Array(r),u=0;u<r;u++)c[u]=arguments[u];return t=_callSuper(this,MissingAuthorize,[].concat(c)),(0,O.default)(t,"name","MissingAuthorizeError"),(0,O.default)(t,"code","CALLBACK_CREDENTIALS_HANDLER_ERROR"),t}return(0,U.default)(MissingAuthorize,t),(0,W.default)(MissingAuthorize)}(B),r.MissingAdapter=function(t){function MissingAdapter(){var t;(0,J.default)(this,MissingAdapter);for(var r=arguments.length,c=Array(r),u=0;u<r;u++)c[u]=arguments[u];return t=_callSuper(this,MissingAdapter,[].concat(c)),(0,O.default)(t,"name","MissingAdapterError"),(0,O.default)(t,"code","EMAIL_REQUIRES_ADAPTER_ERROR"),t}return(0,U.default)(MissingAdapter,t),(0,W.default)(MissingAdapter)}(B),r.MissingAdapterMethods=function(t){function MissingAdapterMethods(){var t;(0,J.default)(this,MissingAdapterMethods);for(var r=arguments.length,c=Array(r),u=0;u<r;u++)c[u]=arguments[u];return t=_callSuper(this,MissingAdapterMethods,[].concat(c)),(0,O.default)(t,"name","MissingAdapterMethodsError"),(0,O.default)(t,"code","MISSING_ADAPTER_METHODS_ERROR"),t}return(0,U.default)(MissingAdapterMethods,t),(0,W.default)(MissingAdapterMethods)}(B),r.UnsupportedStrategy=function(t){function UnsupportedStrategy(){var t;(0,J.default)(this,UnsupportedStrategy);for(var r=arguments.length,c=Array(r),u=0;u<r;u++)c[u]=arguments[u];return t=_callSuper(this,UnsupportedStrategy,[].concat(c)),(0,O.default)(t,"name","UnsupportedStrategyError"),(0,O.default)(t,"code","CALLBACK_CREDENTIALS_JWT_ERROR"),t}return(0,U.default)(UnsupportedStrategy,t),(0,W.default)(UnsupportedStrategy)}(B),r.InvalidCallbackUrl=function(t){function InvalidCallbackUrl(){var t;(0,J.default)(this,InvalidCallbackUrl);for(var r=arguments.length,c=Array(r),u=0;u<r;u++)c[u]=arguments[u];return t=_callSuper(this,InvalidCallbackUrl,[].concat(c)),(0,O.default)(t,"name","InvalidCallbackUrl"),(0,O.default)(t,"code","INVALID_CALLBACK_URL_ERROR"),t}return(0,U.default)(InvalidCallbackUrl,t),(0,W.default)(InvalidCallbackUrl)}(B)},80749:(t,r,c)=>{"use strict";var u=c(2049);Object.defineProperty(r,"__esModule",{value:!0}),r.AuthHandler=AuthHandler;var E=_interopRequireWildcard(c(20546)),P=c(72538),O=_interopRequireWildcard(c(93693)),J=u(c(53450)),W=c(22563),K=c(27985),R=c(50358),U=c(40754);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(t){return t?c:r})(t)}function _interopRequireWildcard(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var c=_getRequireWildcardCache(r);if(c&&c.has(t))return c.get(t);var u={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in t)if("default"!==P&&({}).hasOwnProperty.call(t,P)){var O=E?Object.getOwnPropertyDescriptor(t,P):null;O&&(O.get||O.set)?Object.defineProperty(u,P,O):u[P]=t[P]}return u.default=t,c&&c.set(t,u),u}async function getBody(t){try{return await t.json()}catch(t){}}async function toInternalRequest(t){var r,c,u,E;if(t instanceof Request){let r=new URL(t.url),O=r.pathname.split("/").slice(3),J=Object.fromEntries(t.headers),W=Object.fromEntries(r.searchParams);return W.nextauth=O,{action:O[0],method:t.method,headers:J,body:await getBody(t),cookies:(0,U.parse)(null!==(c=t.headers.get("cookie"))&&void 0!==c?c:""),providerId:O[1],error:null!==(u=r.searchParams.get("error"))&&void 0!==u?u:O[1],origin:(0,P.detectOrigin)(null!==(E=J["x-forwarded-host"])&&void 0!==E?E:J.host,J["x-forwarded-proto"]),query:W}}let{headers:O}=t,J=null!==(r=null==O?void 0:O["x-forwarded-host"])&&void 0!==r?r:null==O?void 0:O.host;return t.origin=(0,P.detectOrigin)(J,null==O?void 0:O["x-forwarded-proto"]),t}async function AuthHandler(t){var r,c,u,P,U,D,B;let{options:F,req:q}=t,G=await toInternalRequest(q);(0,E.setLogger)(F.logger,F.debug);let V=(0,K.assertConfig)({options:F,req:G});if(Array.isArray(V))V.forEach(E.default.warn);else if(V instanceof Error){if(E.default.error(V.code,V),!["signin","signout","error","verify-request"].includes(G.action)||"GET"!==G.method)return{status:500,headers:[{key:"Content-Type",value:"application/json"}],body:{message:"There is a problem with the server configuration. Check the server logs for more information."}};let{pages:t,theme:r}=F,c=(null==t?void 0:t.error)&&(null===(U=G.query)||void 0===U||null===(U=U.callbackUrl)||void 0===U?void 0:U.startsWith(t.error));if(!(null!=t&&t.error)||c){c&&E.default.error("AUTH_ON_ERROR_PAGE_ERROR",Error(`The error page ${null==t?void 0:t.error} should not require authentication`));let u=(0,J.default)({theme:r});return u.error({error:"configuration"})}return{redirect:`${t.error}?error=Configuration`}}let{action:X,providerId:Y,error:Z,method:Q="GET"}=G,{options:ee,cookies:et}=await (0,W.init)({authOptions:F,action:X,providerId:Y,origin:G.origin,callbackUrl:null!==(r=null===(c=G.body)||void 0===c?void 0:c.callbackUrl)&&void 0!==r?r:null===(u=G.query)||void 0===u?void 0:u.callbackUrl,csrfToken:null===(P=G.body)||void 0===P?void 0:P.csrfToken,cookies:G.cookies,isPost:"POST"===Q}),er=new R.SessionStore(ee.cookies.sessionToken,G,ee.logger);if("GET"===Q){let t=(0,J.default)({...ee,query:G.query,cookies:et}),{pages:r}=ee;switch(X){case"providers":return await O.providers(ee.providers);case"session":{let t=await O.session({options:ee,sessionStore:er});return t.cookies&&et.push(...t.cookies),{...t,cookies:et}}case"csrf":return{headers:[{key:"Content-Type",value:"application/json"}],body:{csrfToken:ee.csrfToken},cookies:et};case"signin":if(r.signIn){let t=`${r.signIn}${r.signIn.includes("?")?"&":"?"}callbackUrl=${encodeURIComponent(ee.callbackUrl)}`;return Z&&(t=`${t}&error=${encodeURIComponent(Z)}`),{redirect:t,cookies:et}}return t.signin();case"signout":if(r.signOut)return{redirect:r.signOut,cookies:et};return t.signout();case"callback":if(ee.provider){let t=await O.callback({body:G.body,query:G.query,headers:G.headers,cookies:G.cookies,method:Q,options:ee,sessionStore:er});return t.cookies&&et.push(...t.cookies),{...t,cookies:et}}break;case"verify-request":if(r.verifyRequest)return{redirect:r.verifyRequest,cookies:et};return t.verifyRequest();case"error":if(["Signin","OAuthSignin","OAuthCallback","OAuthCreateAccount","EmailCreateAccount","Callback","OAuthAccountNotLinked","EmailSignin","CredentialsSignin","SessionRequired"].includes(Z))return{redirect:`${ee.url}/signin?error=${Z}`,cookies:et};if(r.error)return{redirect:`${r.error}${r.error.includes("?")?"&":"?"}error=${Z}`,cookies:et};return t.error({error:Z})}}else if("POST"===Q)switch(X){case"signin":if(ee.csrfTokenVerified&&ee.provider){let t=await O.signin({query:G.query,body:G.body,options:ee});return t.cookies&&et.push(...t.cookies),{...t,cookies:et}}return{redirect:`${ee.url}/signin?csrf=true`,cookies:et};case"signout":if(ee.csrfTokenVerified){let t=await O.signout({options:ee,sessionStore:er});return t.cookies&&et.push(...t.cookies),{...t,cookies:et}}return{redirect:`${ee.url}/signout?csrf=true`,cookies:et};case"callback":if(ee.provider){if("credentials"===ee.provider.type&&!ee.csrfTokenVerified)return{redirect:`${ee.url}/signin?csrf=true`,cookies:et};let t=await O.callback({body:G.body,query:G.query,headers:G.headers,cookies:G.cookies,method:Q,options:ee,sessionStore:er});return t.cookies&&et.push(...t.cookies),{...t,cookies:et}}break;case"_log":if(F.logger)try{let{code:t,level:r,...c}=null!==(D=G.body)&&void 0!==D?D:{};E.default[r](t,c)}catch(t){E.default.error("LOGGER_ERROR",t)}return{};case"session":if(ee.csrfTokenVerified){let t=await O.session({options:ee,sessionStore:er,newSession:null===(B=G.body)||void 0===B?void 0:B.data,isUpdate:!0});return t.cookies&&et.push(...t.cookies),{...t,cookies:et}}return{status:400,body:{},cookies:et}}return{status:400,body:`Error: This action with HTTP ${Q} is not supported by NextAuth.js`}}},22563:(t,r,c)=>{"use strict";var u=c(2049);Object.defineProperty(r,"__esModule",{value:!0}),r.init=init;var E=c(6113),P=u(c(20546)),O=c(32133),J=u(c(67721)),W=c(49105),K=_interopRequireWildcard(c(50358)),R=_interopRequireWildcard(c(87938)),U=c(11410),D=c(3826),B=c(51454),F=u(c(44254));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(t){return t?c:r})(t)}function _interopRequireWildcard(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var c=_getRequireWildcardCache(r);if(c&&c.has(t))return c.get(t);var u={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in t)if("default"!==P&&({}).hasOwnProperty.call(t,P)){var O=E?Object.getOwnPropertyDescriptor(t,P):null;O&&(O.get||O.set)?Object.defineProperty(u,P,O):u[P]=t[P]}return u.default=t,c&&c.set(t,u),u}async function init({authOptions:t,providerId:r,action:c,origin:u,cookies:q,callbackUrl:G,csrfToken:V,isPost:X}){var Y,Z;let Q=(0,F.default)(u),ee=(0,W.createSecret)({authOptions:t,url:Q}),{providers:et,provider:er}=(0,J.default)({providers:t.providers,url:Q,providerId:r}),en={debug:!1,pages:{},theme:{colorScheme:"auto",logo:"",brandColor:"",buttonText:""},...t,url:Q,action:c,provider:er,cookies:{...K.defaultCookies(null!==(Y=t.useSecureCookies)&&void 0!==Y?Y:Q.base.startsWith("https://")),...t.cookies},secret:ee,providers:et,session:{strategy:t.adapter?"database":"jwt",maxAge:2592e3,updateAge:86400,generateSessionToken:()=>{var t;return null!==(t=null===E.randomUUID||void 0===E.randomUUID?void 0:(0,E.randomUUID)())&&void 0!==t?t:(0,E.randomBytes)(32).toString("hex")},...t.session},jwt:{secret:ee,maxAge:2592e3,encode:R.encode,decode:R.decode,...t.jwt},events:(0,O.eventsErrorHandler)(null!==(Z=t.events)&&void 0!==Z?Z:{},P.default),adapter:(0,O.adapterErrorHandler)(t.adapter,P.default),callbacks:{...U.defaultCallbacks,...t.callbacks},logger:P.default,callbackUrl:Q.origin},ei=[],{csrfToken:eo,cookie:ea,csrfTokenVerified:es}=(0,D.createCSRFToken)({options:en,cookieValue:null==q?void 0:q[en.cookies.csrfToken.name],isPost:X,bodyValue:V});en.csrfToken=eo,en.csrfTokenVerified=es,ea&&ei.push({name:en.cookies.csrfToken.name,value:ea,options:en.cookies.csrfToken.options});let{callbackUrl:ec,callbackUrlCookie:el}=await (0,B.createCallbackUrl)({options:en,cookieValue:null==q?void 0:q[en.cookies.callbackUrl.name],paramValue:G});return en.callbackUrl=ec,el&&ei.push({name:en.cookies.callbackUrl.name,value:el,options:en.cookies.callbackUrl.options}),{options:en,cookies:ei}}},27985:(t,r,c)=>{"use strict";var u=c(2049);Object.defineProperty(r,"__esModule",{value:!0}),r.assertConfig=assertConfig;var E=c(32133),P=u(c(44254)),O=c(50358);let J=!1;function isValidHttpUrl(t,r){try{return/^https?:/.test(new URL(t,t.startsWith("/")?r:void 0).protocol)}catch(t){return!1}}function assertConfig(t){var r,c,u,W,K,R,U;let D,B,F;let{options:q,req:G}=t,V=[];if(!J&&(G.origin||V.push("NEXTAUTH_URL"),q.secret,q.debug&&V.push("DEBUG_ENABLED")),!q.secret)return new E.MissingSecret("Please define a `secret` in production.");if(!(null!==(r=G.query)&&void 0!==r&&r.nextauth)&&!G.action)return new E.MissingAPIRoute("Cannot find [...nextauth].{js,ts} in `/pages/api/auth`. Make sure the filename is written correctly.");let X=null===(c=G.query)||void 0===c?void 0:c.callbackUrl,Y=(0,P.default)(G.origin);if(X&&!isValidHttpUrl(X,Y.base))return new E.InvalidCallbackUrl(`Invalid callback URL. Received: ${X}`);let{callbackUrl:Z}=(0,O.defaultCookies)(null!==(u=q.useSecureCookies)&&void 0!==u?u:Y.base.startsWith("https://")),Q=null===(W=G.cookies)||void 0===W?void 0:W[null!==(K=null===(R=q.cookies)||void 0===R||null===(R=R.callbackUrl)||void 0===R?void 0:R.name)&&void 0!==K?K:Z.name];if(Q&&!isValidHttpUrl(Q,Y.base))return new E.InvalidCallbackUrl(`Invalid callback URL. Received: ${Q}`);for(let t of q.providers)"credentials"===t.type?D=!0:"email"===t.type?B=!0:"twitter"===t.id&&"2.0"===t.version&&(F=!0);if(D){let t=(null===(U=q.session)||void 0===U?void 0:U.strategy)==="database",r=!q.providers.some(t=>"credentials"!==t.type);if(t&&r)return new E.UnsupportedStrategy("Signin in with credentials only supported if JWT strategy is enabled");let c=q.providers.some(t=>"credentials"===t.type&&!t.authorize);if(c)return new E.MissingAuthorize("Must define an authorize() handler to use credentials authentication provider")}if(B){let{adapter:t}=q;if(!t)return new E.MissingAdapter("E-mail login requires an adapter.");let r=["createVerificationToken","useVerificationToken","getUserByEmail"].filter(r=>!t[r]);if(r.length)return new E.MissingAdapterMethods(`Required adapter methods were missing: ${r.join(", ")}`)}return J||(F&&V.push("TWITTER_OAUTH_2_BETA"),J=!0),V}},62742:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=callbackHandler;var u=c(32133),E=c(49105);async function callbackHandler(t){var r,c,P,O,J,W;let{sessionToken:K,profile:R,account:U,options:D}=t;if(!(null!=U&&U.providerAccountId)||!U.type)throw Error("Missing or invalid provider account");if(!["email","oauth"].includes(U.type))throw Error("Provider not supported");let{adapter:B,jwt:F,events:q,session:{strategy:G,generateSessionToken:V}}=D;if(!B)return{user:R,account:U};let{createUser:X,updateUser:Y,getUser:Z,getUserByAccount:Q,getUserByEmail:ee,linkAccount:et,createSession:er,getSessionAndUser:en,deleteSession:ei}=B,eo=null,ea=null,es=!1,ec="jwt"===G;if(K){if(ec)try{(eo=await F.decode({...F,token:K}))&&"sub"in eo&&eo.sub&&(ea=await Z(eo.sub))}catch(t){}else{let t=await en(K);t&&(eo=t.session,ea=t.user)}}if("email"===U.type){let t=await ee(R.email);if(t)(null===(r=ea)||void 0===r?void 0:r.id)!==t.id&&!ec&&K&&await ei(K),ea=await Y({id:t.id,emailVerified:new Date}),await (null===(c=q.updateUser)||void 0===c?void 0:c.call(q,{user:ea}));else{let{id:t,...r}={...R,emailVerified:new Date};ea=await X(r),await (null===(P=q.createUser)||void 0===P?void 0:P.call(q,{user:ea})),es=!0}return{session:eo=ec?{}:await er({sessionToken:await V(),userId:ea.id,expires:(0,E.fromDate)(D.session.maxAge)}),user:ea,isNewUser:es}}if("oauth"===U.type){let t=await Q({providerAccountId:U.providerAccountId,provider:U.provider});if(t){if(ea){if(t.id===ea.id)return{session:eo,user:ea,isNewUser:es};throw new u.AccountNotLinkedError("The account is already associated with another user")}return{session:eo=ec?{}:await er({sessionToken:await V(),userId:t.id,expires:(0,E.fromDate)(D.session.maxAge)}),user:t,isNewUser:es}}{if(ea)return await et({...U,userId:ea.id}),await (null===(W=q.linkAccount)||void 0===W?void 0:W.call(q,{user:ea,account:U,profile:R})),{session:eo,user:ea,isNewUser:es};let t=R.email?await ee(R.email):null;if(t){let r=D.provider;if(null!=r&&r.allowDangerousEmailAccountLinking)ea=t;else throw new u.AccountNotLinkedError("Another account already exists with the same e-mail address")}else{let{id:t,...r}={...R,emailVerified:null};ea=await X(r)}return await (null===(O=q.createUser)||void 0===O?void 0:O.call(q,{user:ea})),await et({...U,userId:ea.id}),await (null===(J=q.linkAccount)||void 0===J?void 0:J.call(q,{user:ea,account:U,profile:R})),{session:eo=ec?{}:await er({sessionToken:await V(),userId:ea.id,expires:(0,E.fromDate)(D.session.maxAge)}),user:ea,isNewUser:!0}}}throw Error("Unsupported account type")}},51454:(t,r)=>{"use strict";async function createCallbackUrl({options:t,paramValue:r,cookieValue:c}){let{url:u,callbacks:E}=t,P=u.origin;return r?P=await E.redirect({url:r,baseUrl:u.origin}):c&&(P=await E.redirect({url:c,baseUrl:u.origin})),{callbackUrl:P,callbackUrlCookie:P!==c?P:void 0}}Object.defineProperty(r,"__esModule",{value:!0}),r.createCallbackUrl=createCallbackUrl},50358:(t,r)=>{"use strict";function _classPrivateMethodInitSpec(t,r){_checkPrivateRedeclaration(t,r),r.add(t)}function _classPrivateFieldInitSpec(t,r,c){_checkPrivateRedeclaration(t,r),r.set(t,c)}function _checkPrivateRedeclaration(t,r){if(r.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(t,r){return t.get(_assertClassBrand(t,r))}function _classPrivateFieldSet(t,r,c){return t.set(_assertClassBrand(t,r),c),c}function _assertClassBrand(t,r,c){if("function"==typeof t?t===r:t.has(r))return arguments.length<3?r:c;throw TypeError("Private element is not present on this object")}function defaultCookies(t){let r=t?"__Secure-":"";return{sessionToken:{name:`${r}next-auth.session-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t}},callbackUrl:{name:`${r}next-auth.callback-url`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t}},csrfToken:{name:`${t?"__Host-":""}next-auth.csrf-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t}},pkceCodeVerifier:{name:`${r}next-auth.pkce.code_verifier`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t,maxAge:900}},state:{name:`${r}next-auth.state`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t,maxAge:900}},nonce:{name:`${r}next-auth.nonce`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:t}}}}Object.defineProperty(r,"__esModule",{value:!0}),r.SessionStore=void 0,r.defaultCookies=defaultCookies;var c=new WeakMap,u=new WeakMap,E=new WeakMap,P=new WeakSet;let SessionStore=class SessionStore{constructor(t,r,O){_classPrivateMethodInitSpec(this,P),_classPrivateFieldInitSpec(this,c,{}),_classPrivateFieldInitSpec(this,u,void 0),_classPrivateFieldInitSpec(this,E,void 0),_classPrivateFieldSet(E,this,O),_classPrivateFieldSet(u,this,t);let{cookies:J}=r,{name:W}=t;if("function"==typeof(null==J?void 0:J.getAll))for(let{name:t,value:r}of J.getAll())t.startsWith(W)&&(_classPrivateFieldGet(c,this)[t]=r);else if(J instanceof Map)for(let t of J.keys())t.startsWith(W)&&(_classPrivateFieldGet(c,this)[t]=J.get(t));else for(let t in J)t.startsWith(W)&&(_classPrivateFieldGet(c,this)[t]=J[t])}get value(){let t=Object.keys(_classPrivateFieldGet(c,this)).sort((t,r)=>{var c,u;let E=parseInt(null!==(c=t.split(".").pop())&&void 0!==c?c:"0"),P=parseInt(null!==(u=r.split(".").pop())&&void 0!==u?u:"0");return E-P});return t.map(t=>_classPrivateFieldGet(c,this)[t]).join("")}chunk(t,r){let c=_assertClassBrand(P,this,_clean).call(this),E=_assertClassBrand(P,this,_chunk).call(this,{name:_classPrivateFieldGet(u,this).name,value:t,options:{..._classPrivateFieldGet(u,this).options,...r}});for(let t of E)c[t.name]=t;return Object.values(c)}clean(){return Object.values(_assertClassBrand(P,this,_clean).call(this))}};function _chunk(t){let r=Math.ceil(t.value.length/3933);if(1===r)return _classPrivateFieldGet(c,this)[t.name]=t.value,[t];let u=[];for(let E=0;E<r;E++){let r=`${t.name}.${E}`,P=t.value.substr(3933*E,3933);u.push({...t,name:r,value:P}),_classPrivateFieldGet(c,this)[r]=P}return _classPrivateFieldGet(E,this).debug("CHUNKING_SESSION_COOKIE",{message:"Session cookie exceeds allowed 4096 bytes.",emptyCookieSize:163,valueSize:t.value.length,chunks:u.map(t=>t.value.length+163)}),u}function _clean(){let t={};for(let E in _classPrivateFieldGet(c,this)){var r;null===(r=_classPrivateFieldGet(c,this))||void 0===r||delete r[E],t[E]={name:E,value:"",options:{..._classPrivateFieldGet(u,this).options,maxAge:0}}}return t}r.SessionStore=SessionStore},3826:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createCSRFToken=createCSRFToken;var u=c(6113);function createCSRFToken({options:t,cookieValue:r,isPost:c,bodyValue:E}){if(r){let[P,O]=r.split("|"),J=(0,u.createHash)("sha256").update(`${P}${t.secret}`).digest("hex");if(O===J){let t=c&&P===E;return{csrfTokenVerified:t,csrfToken:P}}}let P=(0,u.randomBytes)(32).toString("hex"),O=(0,u.createHash)("sha256").update(`${P}${t.secret}`).digest("hex"),J=`${P}|${O}`;return{cookie:J,csrfToken:P}}},11410:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.defaultCallbacks=void 0,r.defaultCallbacks={signIn:()=>!0,redirect:({url:t,baseUrl:r})=>t.startsWith("/")?`${r}${t}`:new URL(t).origin===r?t:r,session:({session:t})=>t,jwt:({token:t})=>t}},3727:(t,r)=>{"use strict";async function getAdapterUserFromEmail({email:t,adapter:r}){let{getUserByEmail:c}=r,u=t?await c(t):null;return u||{id:t,email:t,emailVerified:null}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=getAdapterUserFromEmail},81499:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=email;var u=c(6113),E=c(49105);async function email(t,r){var c,P,O,J;let{url:W,adapter:K,provider:R,callbackUrl:U,theme:D}=r,B=null!==(c=await (null===(P=R.generateVerificationToken)||void 0===P?void 0:P.call(R)))&&void 0!==c?c:(0,u.randomBytes)(32).toString("hex"),F=new Date(Date.now()+(null!==(O=R.maxAge)&&void 0!==O?O:86400)*1e3),q=new URLSearchParams({callbackUrl:U,token:B,email:t}),G=`${W}/callback/${R.id}?${q}`;return await Promise.all([R.sendVerificationRequest({identifier:t,token:B,expires:F,url:G,provider:R,theme:D}),null===(J=K.createVerificationToken)||void 0===J?void 0:J.call(K,{identifier:t,token:(0,E.hashToken)(B,r),expires:F})]),`${W}/verify-request?${new URLSearchParams({provider:R.id,type:R.type})}`}},35896:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=getAuthorizationUrl;var u=c(55431),E=c(13715),P=_interopRequireWildcard(c(7519));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(t){return t?c:r})(t)}function _interopRequireWildcard(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var c=_getRequireWildcardCache(r);if(c&&c.has(t))return c.get(t);var u={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in t)if("default"!==P&&({}).hasOwnProperty.call(t,P)){var O=E?Object.getOwnPropertyDescriptor(t,P):null;O&&(O.get||O.set)?Object.defineProperty(u,P,O):u[P]=t[P]}return u.default=t,c&&c.set(t,u),u}async function getAuthorizationUrl({options:t,query:r}){var c,O,J;let{logger:W,provider:K}=t,R={};if("string"==typeof K.authorization){let t=new URL(K.authorization),r=Object.fromEntries(t.searchParams);R={...R,...r}}else R={...R,...null===(O=K.authorization)||void 0===O?void 0:O.params};if(R={...R,...r},null!==(c=K.version)&&void 0!==c&&c.startsWith("1.")){let r=(0,E.oAuth1Client)(t),c=await r.getOAuthRequestToken(R),u=`${null===(J=K.authorization)||void 0===J?void 0:J.url}?${new URLSearchParams({oauth_token:c.oauth_token,oauth_token_secret:c.oauth_token_secret,...c.params})}`;return E.oAuth1TokenStore.set(c.oauth_token,c.oauth_token_secret),W.debug("GET_AUTHORIZATION_URL",{url:u,provider:K}),{redirect:u}}let U=await (0,u.openidClient)(t),D=R,B=[];await P.state.create(t,B,D),await P.pkce.create(t,B,D),await P.nonce.create(t,B,D);let F=U.authorizationUrl(D);return W.debug("GET_AUTHORIZATION_URL",{url:F,cookies:B,provider:K}),{redirect:F,cookies:B}}},15721:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=oAuthCallback;var u=c(78165),E=c(55431),P=c(13715),O=_interopRequireWildcard(c(7519)),J=c(32133);function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(t){return t?c:r})(t)}function _interopRequireWildcard(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var c=_getRequireWildcardCache(r);if(c&&c.has(t))return c.get(t);var u={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in t)if("default"!==P&&({}).hasOwnProperty.call(t,P)){var O=E?Object.getOwnPropertyDescriptor(t,P):null;O&&(O.get||O.set)?Object.defineProperty(u,P,O):u[P]=t[P]}return u.default=t,c&&c.set(t,u),u}async function oAuthCallback(t){var r,c,W,K,R,U;let{options:D,query:B,body:F,method:q,cookies:G}=t,{logger:V,provider:X}=D,Y=null!==(r=null==F?void 0:F.error)&&void 0!==r?r:null==B?void 0:B.error;if(Y){let t=Error(Y);throw V.error("OAUTH_CALLBACK_HANDLER_ERROR",{error:t,error_description:null==B?void 0:B.error_description,providerId:X.id}),V.debug("OAUTH_CALLBACK_HANDLER_ERROR",{body:F}),t}if(null!==(c=X.version)&&void 0!==c&&c.startsWith("1."))try{let t=await (0,P.oAuth1Client)(D),{oauth_token:r,oauth_verifier:c}=null!=B?B:{},u=await t.getOAuthAccessToken(r,P.oAuth1TokenStore.get(r),c),E=await t.get(X.profileUrl,u.oauth_token,u.oauth_token_secret);"string"==typeof E&&(E=JSON.parse(E));let O=await getProfile({profile:E,tokens:u,provider:X,logger:V});return{...O,cookies:[]}}catch(t){throw V.error("OAUTH_V1_GET_ACCESS_TOKEN_ERROR",t),t}null!=B&&B.oauth_token&&P.oAuth1TokenStore.delete(B.oauth_token);try{let t,r;let c=await (0,E.openidClient)(D),P={},J=[];await O.state.use(G,J,D,P),await O.pkce.use(G,J,D,P),await O.nonce.use(G,J,D,P);let Y={...c.callbackParams({url:`http://n?${new URLSearchParams(B)}`,body:F,method:q}),...null===(W=X.token)||void 0===W?void 0:W.params};if(null!==(K=X.token)&&void 0!==K&&K.request){let r=await X.token.request({provider:X,params:Y,checks:P,client:c});t=new u.TokenSet(r.tokens)}else t=X.idToken?await c.callback(X.callbackUrl,Y,P):await c.oauthCallback(X.callbackUrl,Y,P);Array.isArray(t.scope)&&(t.scope=t.scope.join(" ")),r=null!==(R=X.userinfo)&&void 0!==R&&R.request?await X.userinfo.request({provider:X,tokens:t,client:c}):X.idToken?t.claims():await c.userinfo(t,{params:null===(U=X.userinfo)||void 0===U?void 0:U.params});let Z=await getProfile({profile:r,provider:X,tokens:t,logger:V});return{...Z,cookies:J}}catch(t){throw new J.OAuthCallbackError(t)}}async function getProfile({profile:t,tokens:r,provider:c,logger:u}){try{var E;u.debug("PROFILE_DATA",{OAuthProfile:t});let P=await c.profile(t,r);if(P.email=null===(E=P.email)||void 0===E?void 0:E.toLowerCase(),!P.id)throw TypeError(`Profile id is missing in ${c.name} OAuth profile response`);return{profile:P,account:{provider:c.id,type:c.type,providerAccountId:P.id.toString(),...r},OAuthProfile:t}}catch(r){u.error("OAUTH_PARSE_PROFILE_ERROR",{error:r,OAuthProfile:t})}}},7519:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.pkce=r.nonce=r.PKCE_CODE_CHALLENGE_METHOD=void 0,r.signCookie=signCookie,r.state=void 0;var u=c(78165),E=_interopRequireWildcard(c(87938));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(t){return t?c:r})(t)}function _interopRequireWildcard(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var c=_getRequireWildcardCache(r);if(c&&c.has(t))return c.get(t);var u={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in t)if("default"!==P&&({}).hasOwnProperty.call(t,P)){var O=E?Object.getOwnPropertyDescriptor(t,P):null;O&&(O.get||O.set)?Object.defineProperty(u,P,O):u[P]=t[P]}return u.default=t,c&&c.set(t,u),u}async function signCookie(t,r,c,u){let{cookies:P,logger:O}=u;O.debug(`CREATE_${t.toUpperCase()}`,{value:r,maxAge:c});let{name:J}=P[t],W=new Date;return W.setTime(W.getTime()+1e3*c),{name:J,value:await E.encode({...u.jwt,maxAge:c,token:{value:r},salt:J}),options:{...P[t].options,expires:W}}}let P=r.PKCE_CODE_CHALLENGE_METHOD="S256";r.pkce={async create(t,r,c){var E,O;if(!(null!==(E=t.provider)&&void 0!==E&&null!==(E=E.checks)&&void 0!==E&&E.includes("pkce")))return;let J=u.generators.codeVerifier(),W=u.generators.codeChallenge(J);c.code_challenge=W,c.code_challenge_method=P;let K=null!==(O=t.cookies.pkceCodeVerifier.options.maxAge)&&void 0!==O?O:900;r.push(await signCookie("pkceCodeVerifier",J,K,t))},async use(t,r,c,u){var P;if(!(null!==(P=c.provider)&&void 0!==P&&null!==(P=P.checks)&&void 0!==P&&P.includes("pkce")))return;let O=null==t?void 0:t[c.cookies.pkceCodeVerifier.name];if(!O)throw TypeError("PKCE code_verifier cookie was missing.");let{name:J}=c.cookies.pkceCodeVerifier,W=await E.decode({...c.jwt,token:O,salt:J});if(!(null!=W&&W.value))throw TypeError("PKCE code_verifier value could not be parsed.");r.push({name:J,value:"",options:{...c.cookies.pkceCodeVerifier.options,maxAge:0}}),u.code_verifier=W.value}},r.state={async create(t,r,c){var E,P;if(!(null!==(E=t.provider.checks)&&void 0!==E&&E.includes("state")))return;let O=u.generators.state();c.state=O;let J=null!==(P=t.cookies.state.options.maxAge)&&void 0!==P?P:900;r.push(await signCookie("state",O,J,t))},async use(t,r,c,u){var P;if(!(null!==(P=c.provider.checks)&&void 0!==P&&P.includes("state")))return;let O=null==t?void 0:t[c.cookies.state.name];if(!O)throw TypeError("State cookie was missing.");let{name:J}=c.cookies.state,W=await E.decode({...c.jwt,token:O,salt:J});if(!(null!=W&&W.value))throw TypeError("State value could not be parsed.");r.push({name:J,value:"",options:{...c.cookies.state.options,maxAge:0}}),u.state=W.value}},r.nonce={async create(t,r,c){var E,P;if(!(null!==(E=t.provider.checks)&&void 0!==E&&E.includes("nonce")))return;let O=u.generators.nonce();c.nonce=O;let J=null!==(P=t.cookies.nonce.options.maxAge)&&void 0!==P?P:900;r.push(await signCookie("nonce",O,J,t))},async use(t,r,c,u){var P;if(!(null!==(P=c.provider)&&void 0!==P&&null!==(P=P.checks)&&void 0!==P&&P.includes("nonce")))return;let O=null==t?void 0:t[c.cookies.nonce.name];if(!O)throw TypeError("Nonce cookie was missing.");let{name:J}=c.cookies.nonce,W=await E.decode({...c.jwt,token:O,salt:J});if(!(null!=W&&W.value))throw TypeError("Nonce value could not be parsed.");r.push({name:J,value:"",options:{...c.cookies.nonce.options,maxAge:0}}),u.nonce=W.value}}},13715:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.oAuth1Client=oAuth1Client,r.oAuth1TokenStore=void 0;var u=c(72369);function oAuth1Client(t){var r,c;let E=t.provider,P=new u.OAuth(E.requestTokenUrl,E.accessTokenUrl,E.clientId,E.clientSecret,null!==(r=E.version)&&void 0!==r?r:"1.0",E.callbackUrl,null!==(c=E.encoding)&&void 0!==c?c:"HMAC-SHA1"),O=P.get.bind(P);P.get=async(...t)=>await new Promise((r,c)=>{O(...t,(t,u)=>{if(t)return c(t);r(u)})});let J=P.getOAuthAccessToken.bind(P);P.getOAuthAccessToken=async(...t)=>await new Promise((r,c)=>{J(...t,(t,u,E)=>{if(t)return c(t);r({oauth_token:u,oauth_token_secret:E})})});let W=P.getOAuthRequestToken.bind(P);return P.getOAuthRequestToken=async(t={})=>await new Promise((r,c)=>{W(t,(t,u,E,P)=>{if(t)return c(t);r({oauth_token:u,oauth_token_secret:E,params:P})})}),P}r.oAuth1TokenStore=new Map},55431:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.openidClient=openidClient;var u=c(78165);async function openidClient(t){let r;let c=t.provider;if(c.httpOptions&&u.custom.setHttpOptionsDefaults(c.httpOptions),c.wellKnown)r=await u.Issuer.discover(c.wellKnown);else{var E,P,O;r=new u.Issuer({issuer:c.issuer,authorization_endpoint:null===(E=c.authorization)||void 0===E?void 0:E.url,token_endpoint:null===(P=c.token)||void 0===P?void 0:P.url,userinfo_endpoint:null===(O=c.userinfo)||void 0===O?void 0:O.url,jwks_uri:c.jwks_endpoint})}let J=new r.Client({client_id:c.clientId,client_secret:c.clientSecret,redirect_uris:[c.callbackUrl],...c.client},c.jwks);return J[u.custom.clock_tolerance]=10,J}},67721:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=parseProviders;var u=c(96300);function parseProviders(t){let{url:r,providerId:c}=t,E=t.providers.map(({options:t,...c})=>{var E,P;if("oauth"===c.type){let E=normalizeOAuthOptions(c),O=normalizeOAuthOptions(t,!0),J=null!==(P=null==O?void 0:O.id)&&void 0!==P?P:c.id;return(0,u.merge)(E,{...O,signinUrl:`${r}/signin/${J}`,callbackUrl:`${r}/callback/${J}`})}let O=null!==(E=null==t?void 0:t.id)&&void 0!==E?E:c.id;return(0,u.merge)(c,{...t,signinUrl:`${r}/signin/${O}`,callbackUrl:`${r}/callback/${O}`})});return{providers:E,provider:E.find(({id:t})=>t===c)}}function normalizeOAuthOptions(t,r=!1){var c,u,E,P,O;if(!t)return;let J=Object.entries(t).reduce((t,[r,c])=>{if(["authorization","token","userinfo"].includes(r)&&"string"==typeof c){var u;let E=new URL(c);t[r]={url:`${E.origin}${E.pathname}`,params:Object.fromEntries(null!==(u=E.searchParams)&&void 0!==u?u:[])}}else t[r]=c;return t},{});return r||null!==(c=J.version)&&void 0!==c&&c.startsWith("1.")||(J.idToken=!!(null!==(u=null!==(E=J.idToken)&&void 0!==E?E:null===(P=J.wellKnown)||void 0===P?void 0:P.includes("openid-configuration"))&&void 0!==u?u:null===(O=J.authorization)||void 0===O||null===(O=O.params)||void 0===O||null===(O=O.scope)||void 0===O?void 0:O.includes("openid")),J.checks||(J.checks=["state"])),J}},49105:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createSecret=createSecret,r.fromDate=fromDate,r.hashToken=hashToken;var u=c(6113);function fromDate(t,r=Date.now()){return new Date(r+1e3*t)}function hashToken(t,r){var c;let{provider:E,secret:P}=r;return(0,u.createHash)("sha256").update(`${t}${null!==(c=E.secret)&&void 0!==c?c:P}`).digest("hex")}function createSecret(t){var r;let{authOptions:c,url:E}=t;return null!==(r=c.secret)&&void 0!==r?r:(0,u.createHash)("sha256").update(JSON.stringify({...E,...c})).digest("hex")}},96369:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=ErrorPage;var u=c(22838);function ErrorPage(t){var r;let{url:c,error:E="default",theme:P}=t,O=`${c}/signin`,J={default:{status:200,heading:"Error",message:(0,u.h)("p",null,(0,u.h)("a",{className:"site",href:null==c?void 0:c.origin},null==c?void 0:c.host))},configuration:{status:500,heading:"Server error",message:(0,u.h)("div",null,(0,u.h)("p",null,"There is a problem with the server configuration."),(0,u.h)("p",null,"Check the server logs for more information."))},accessdenied:{status:403,heading:"Access Denied",message:(0,u.h)("div",null,(0,u.h)("p",null,"You do not have permission to sign in."),(0,u.h)("p",null,(0,u.h)("a",{className:"button",href:O},"Sign in")))},verification:{status:403,heading:"Unable to sign in",message:(0,u.h)("div",null,(0,u.h)("p",null,"The sign in link is no longer valid."),(0,u.h)("p",null,"It may have been used already or it may have expired.")),signin:(0,u.h)("a",{className:"button",href:O},"Sign in")}},{status:W,heading:K,message:R,signin:U}=null!==(r=J[E.toLowerCase()])&&void 0!==r?r:J.default;return{status:W,html:(0,u.h)("div",{className:"error"},(null==P?void 0:P.brandColor)&&(0,u.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${null==P?void 0:P.brandColor}
        }
      `}}),(0,u.h)("div",{className:"card"},(null==P?void 0:P.logo)&&(0,u.h)("img",{src:P.logo,alt:"Logo",className:"logo"}),(0,u.h)("h1",null,K),(0,u.h)("div",{className:"message"},R),U))}}},53450:(t,r,c)=>{"use strict";var u=c(2049);Object.defineProperty(r,"__esModule",{value:!0}),r.default=renderPage;var E=u(c(54412)),P=u(c(29181)),O=u(c(30264)),J=u(c(60923)),W=u(c(96369)),K=u(c(67630));function renderPage(t){let{url:r,theme:c,query:u,cookies:R}=t;function send({html:t,title:r,status:u}){var P;return{cookies:R,status:u,headers:[{key:"Content-Type",value:"text/html"}],body:`<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>${(0,K.default)()}</style><title>${r}</title></head><body class="__next-auth-theme-${null!==(P=null==c?void 0:c.colorScheme)&&void 0!==P?P:"auto"}"><div class="page">${(0,E.default)(t)}</div></body></html>`}}return{signin:r=>send({html:(0,P.default)({csrfToken:t.csrfToken,providers:t.providers,callbackUrl:t.callbackUrl,theme:c,...u,...r}),title:"Sign In"}),signout:u=>send({html:(0,O.default)({csrfToken:t.csrfToken,url:r,theme:c,...u}),title:"Sign Out"}),verifyRequest:t=>send({html:(0,J.default)({url:r,theme:c,...t}),title:"Verify Request"}),error:t=>send({...(0,W.default)({url:r,theme:c,...t}),title:"Error"})}}},29181:(t,r,c)=>{"use strict";var u=c(2049);Object.defineProperty(r,"__esModule",{value:!0}),r.default=SigninPage;var E=c(22838),P=u(c(14432));function hexToRgba(t,r=1){if(!t)return;3===(t=t.replace(/^#/,"")).length&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);let c=parseInt(t,16);r=Math.min(Math.max(r,0),1);let u=`rgba(${c>>16&255}, ${c>>8&255}, ${255&c}, ${r})`;return u}function SigninPage(t){var r;let{csrfToken:c,providers:u,callbackUrl:O,theme:J,email:W,error:K}=t,R=u.filter(t=>"oauth"===t.type||"email"===t.type||"credentials"===t.type&&!!t.credentials);"undefined"!=typeof document&&J.buttonText&&document.documentElement.style.setProperty("--button-text-color",J.buttonText),"undefined"!=typeof document&&J.brandColor&&document.documentElement.style.setProperty("--brand-color",J.brandColor);let U={Signin:"Try signing in with a different account.",OAuthSignin:"Try signing in with a different account.",OAuthCallback:"Try signing in with a different account.",OAuthCreateAccount:"Try signing in with a different account.",EmailCreateAccount:"Try signing in with a different account.",Callback:"Try signing in with a different account.",OAuthAccountNotLinked:"To confirm your identity, sign in with the same account you used originally.",EmailSignin:"The e-mail could not be sent.",CredentialsSignin:"Sign in failed. Check the details you provided are correct.",SessionRequired:"Please sign in to access this page.",default:"Unable to sign in."},D=K&&(null!==(r=U[K])&&void 0!==r?r:U.default),B="https://authjs.dev/img/providers";return(0,E.h)("div",{className:"signin"},J.brandColor&&(0,E.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${J.brandColor}
        }
      `}}),J.buttonText&&(0,E.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${J.buttonText}
        }
      `}}),(0,E.h)("div",{className:"card"},J.logo&&(0,E.h)("img",{src:J.logo,alt:"Logo",className:"logo"}),D&&(0,E.h)("div",{className:"error"},(0,E.h)("p",null,D)),R.map((t,r)=>{let u,J,K,U,D,F;if("oauth"===t.type){var q;({bg:u="",text:J="",logo:K="",bgDark:D=u,textDark:F=J,logoDark:U=""}=null!==(q=t.style)&&void 0!==q?q:{}),K=K.startsWith("/")?`${B}${K}`:K,(U=U.startsWith("/")?`${B}${U}`:U||K)||(U=K)}return(0,E.h)("div",{key:t.id,className:"provider"},"oauth"===t.type&&(0,E.h)("form",{action:t.signinUrl,method:"POST"},(0,E.h)("input",{type:"hidden",name:"csrfToken",value:c}),O&&(0,E.h)("input",{type:"hidden",name:"callbackUrl",value:O}),(0,E.h)("button",{type:"submit",className:"button",style:{"--provider-bg":u,"--provider-dark-bg":D,"--provider-color":J,"--provider-dark-color":F,"--provider-bg-hover":hexToRgba(u,.8),"--provider-dark-bg-hover":hexToRgba(D,.8)}},K&&(0,E.h)("img",{loading:"lazy",height:24,width:24,id:"provider-logo",src:`${K.startsWith("/")?B:""}${K}`}),U&&(0,E.h)("img",{loading:"lazy",height:24,width:24,id:"provider-logo-dark",src:`${K.startsWith("/")?B:""}${U}`}),(0,E.h)("span",null,"Sign in with ",t.name))),("email"===t.type||"credentials"===t.type)&&r>0&&"email"!==R[r-1].type&&"credentials"!==R[r-1].type&&(0,E.h)("hr",null),"email"===t.type&&(0,E.h)("form",{action:t.signinUrl,method:"POST"},(0,E.h)("input",{type:"hidden",name:"csrfToken",value:c}),(0,E.h)("label",{className:"section-header",htmlFor:`input-email-for-${t.id}-provider`},"Email"),(0,E.h)("input",{id:`input-email-for-${t.id}-provider`,autoFocus:!0,type:"email",name:"email",value:W,placeholder:"email@example.com",required:!0}),(0,E.h)("button",{id:"submitButton",type:"submit"},"Sign in with ",t.name)),"credentials"===t.type&&(0,E.h)("form",{action:t.callbackUrl,method:"POST"},(0,E.h)("input",{type:"hidden",name:"csrfToken",value:c}),Object.keys(t.credentials).map(r=>{var c,u,O;return(0,E.h)("div",{key:`input-group-${t.id}`},(0,E.h)("label",{className:"section-header",htmlFor:`input-${r}-for-${t.id}-provider`},null!==(c=t.credentials[r].label)&&void 0!==c?c:r),(0,E.h)("input",(0,P.default)({name:r,id:`input-${r}-for-${t.id}-provider`,type:null!==(u=t.credentials[r].type)&&void 0!==u?u:"text",placeholder:null!==(O=t.credentials[r].placeholder)&&void 0!==O?O:""},t.credentials[r])))}),(0,E.h)("button",{type:"submit"},"Sign in with ",t.name)),("email"===t.type||"credentials"===t.type)&&r+1<R.length&&(0,E.h)("hr",null))})))}},30264:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=SignoutPage;var u=c(22838);function SignoutPage(t){let{url:r,csrfToken:c,theme:E}=t;return(0,u.h)("div",{className:"signout"},E.brandColor&&(0,u.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${E.brandColor}
        }
      `}}),E.buttonText&&(0,u.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${E.buttonText}
        }
      `}}),(0,u.h)("div",{className:"card"},E.logo&&(0,u.h)("img",{src:E.logo,alt:"Logo",className:"logo"}),(0,u.h)("h1",null,"Signout"),(0,u.h)("p",null,"Are you sure you want to sign out?"),(0,u.h)("form",{action:`${r}/signout`,method:"POST"},(0,u.h)("input",{type:"hidden",name:"csrfToken",value:c}),(0,u.h)("button",{id:"submitButton",type:"submit"},"Sign out"))))}},60923:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=VerifyRequestPage;var u=c(22838);function VerifyRequestPage(t){let{url:r,theme:c}=t;return(0,u.h)("div",{className:"verify-request"},c.brandColor&&(0,u.h)("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${c.brandColor}
        }
      `}}),(0,u.h)("div",{className:"card"},c.logo&&(0,u.h)("img",{src:c.logo,alt:"Logo",className:"logo"}),(0,u.h)("h1",null,"Check your email"),(0,u.h)("p",null,"A sign in link has been sent to your email address."),(0,u.h)("p",null,(0,u.h)("a",{className:"site",href:r.origin},r.host))))}},38840:(t,r,c)=>{"use strict";var u=c(2049);Object.defineProperty(r,"__esModule",{value:!0}),r.default=callback;var E=u(c(15721)),P=u(c(62742)),O=c(49105),J=u(c(3727));async function callback(t){var r,c,u,W,K,R;let{options:U,query:D,body:B,method:F,headers:q,sessionStore:G}=t,{provider:V,adapter:X,url:Y,callbackUrl:Z,pages:Q,jwt:ee,events:et,callbacks:er,session:{strategy:en,maxAge:ei},logger:eo}=U,ea=[],es="jwt"===en;if("oauth"===V.type)try{let{profile:u,account:O,OAuthProfile:J,cookies:W}=await (0,E.default)({query:D,body:B,method:F,options:U,cookies:t.cookies});W.length&&ea.push(...W);try{if(eo.debug("OAUTH_CALLBACK_RESPONSE",{profile:u,account:O,OAuthProfile:J}),!u||!O||!J)return{redirect:`${Y}/signin`,cookies:ea};let t=u;if(X){let{getUserByAccount:r}=X,c=await r({providerAccountId:O.providerAccountId,provider:V.id});c&&(t=c)}try{let r=await er.signIn({user:t,account:O,profile:J});if(!r)return{redirect:`${Y}/error?error=AccessDenied`,cookies:ea};if("string"==typeof r)return{redirect:r,cookies:ea}}catch(t){return{redirect:`${Y}/error?error=${encodeURIComponent(t.message)}`,cookies:ea}}let{user:E,session:W,isNewUser:K}=await (0,P.default)({sessionToken:G.value,profile:u,account:O,options:U});if(es){let t={name:E.name,email:E.email,picture:E.image,sub:null===(c=E.id)||void 0===c?void 0:c.toString()},r=await er.jwt({token:t,user:E,account:O,profile:J,isNewUser:K,trigger:K?"signUp":"signIn"}),u=await ee.encode({...ee,token:r}),P=new Date;P.setTime(P.getTime()+1e3*ei);let W=G.chunk(u,{expires:P});ea.push(...W)}else ea.push({name:U.cookies.sessionToken.name,value:W.sessionToken,options:{...U.cookies.sessionToken.options,expires:W.expires}});if(await (null===(r=et.signIn)||void 0===r?void 0:r.call(et,{user:E,account:O,profile:u,isNewUser:K})),K&&Q.newUser)return{redirect:`${Q.newUser}${Q.newUser.includes("?")?"&":"?"}callbackUrl=${encodeURIComponent(Z)}`,cookies:ea};return{redirect:Z,cookies:ea}}catch(t){if("AccountNotLinkedError"===t.name)return{redirect:`${Y}/error?error=OAuthAccountNotLinked`,cookies:ea};if("CreateUserError"===t.name)return{redirect:`${Y}/error?error=OAuthCreateAccount`,cookies:ea};return eo.error("OAUTH_CALLBACK_HANDLER_ERROR",t),{redirect:`${Y}/error?error=Callback`,cookies:ea}}}catch(t){if("OAuthCallbackError"===t.name)return eo.error("OAUTH_CALLBACK_ERROR",{error:t,providerId:V.id}),{redirect:`${Y}/error?error=OAuthCallback`,cookies:ea};return eo.error("OAUTH_CALLBACK_ERROR",t),{redirect:`${Y}/error?error=Callback`,cookies:ea}}else if("email"===V.type)try{let t=null==D?void 0:D.token,r=null==D?void 0:D.email;if(!t)return{redirect:`${Y}/error?error=configuration`,cookies:ea};let c=await X.useVerificationToken({identifier:r,token:(0,O.hashToken)(t,U)}),E=!c||c.expires.valueOf()<Date.now()||r&&c.identifier!==r;if(E)return{redirect:`${Y}/error?error=Verification`,cookies:ea};let K=await (0,J.default)({email:c.identifier,adapter:X}),R={providerAccountId:K.email,type:"email",provider:V.id};try{let t=await er.signIn({user:K,account:R});if(!t)return{redirect:`${Y}/error?error=AccessDenied`,cookies:ea};if("string"==typeof t)return{redirect:t,cookies:ea}}catch(t){return{redirect:`${Y}/error?error=${encodeURIComponent(t.message)}`,cookies:ea}}let{user:B,session:F,isNewUser:q}=await (0,P.default)({sessionToken:G.value,profile:K,account:R,options:U});if(es){let t={name:B.name,email:B.email,picture:B.image,sub:null===(W=B.id)||void 0===W?void 0:W.toString()},r=await er.jwt({token:t,user:B,account:R,isNewUser:q,trigger:q?"signUp":"signIn"}),c=await ee.encode({...ee,token:r}),u=new Date;u.setTime(u.getTime()+1e3*ei);let E=G.chunk(c,{expires:u});ea.push(...E)}else ea.push({name:U.cookies.sessionToken.name,value:F.sessionToken,options:{...U.cookies.sessionToken.options,expires:F.expires}});if(await (null===(u=et.signIn)||void 0===u?void 0:u.call(et,{user:B,account:R,isNewUser:q})),q&&Q.newUser)return{redirect:`${Q.newUser}${Q.newUser.includes("?")?"&":"?"}callbackUrl=${encodeURIComponent(Z)}`,cookies:ea};return{redirect:Z,cookies:ea}}catch(t){if("CreateUserError"===t.name)return{redirect:`${Y}/error?error=EmailCreateAccount`,cookies:ea};return eo.error("CALLBACK_EMAIL_ERROR",t),{redirect:`${Y}/error?error=Callback`,cookies:ea}}else if("credentials"===V.type&&"POST"===F){let t;try{if(!(t=await V.authorize(B,{query:D,body:B,headers:q,method:F})))return{status:401,redirect:`${Y}/error?${new URLSearchParams({error:"CredentialsSignin",provider:V.id})}`,cookies:ea}}catch(t){return{status:401,redirect:`${Y}/error?error=${encodeURIComponent(t.message)}`,cookies:ea}}let r={providerAccountId:t.id,type:"credentials",provider:V.id};try{let c=await er.signIn({user:t,account:r,credentials:B});if(!c)return{status:403,redirect:`${Y}/error?error=AccessDenied`,cookies:ea};if("string"==typeof c)return{redirect:c,cookies:ea}}catch(t){return{redirect:`${Y}/error?error=${encodeURIComponent(t.message)}`,cookies:ea}}let c={name:t.name,email:t.email,picture:t.image,sub:null===(K=t.id)||void 0===K?void 0:K.toString()},u=await er.jwt({token:c,user:t,account:r,isNewUser:!1,trigger:"signIn"}),E=await ee.encode({...ee,token:u}),P=new Date;P.setTime(P.getTime()+1e3*ei);let O=G.chunk(E,{expires:P});return ea.push(...O),await (null===(R=et.signIn)||void 0===R?void 0:R.call(et,{user:t,account:r})),{redirect:Z,cookies:ea}}return{status:500,body:`Error: Callback for provider type ${V.type} not supported`,cookies:ea}}},93693:(t,r,c)=>{"use strict";var u=c(2049);Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"callback",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(r,"providers",{enumerable:!0,get:function(){return W.default}}),Object.defineProperty(r,"session",{enumerable:!0,get:function(){return J.default}}),Object.defineProperty(r,"signin",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(r,"signout",{enumerable:!0,get:function(){return O.default}});var E=u(c(38840)),P=u(c(68966)),O=u(c(15681)),J=u(c(14393)),W=u(c(4137))},4137:(t,r)=>{"use strict";function providers(t){return{headers:[{key:"Content-Type",value:"application/json"}],body:t.reduce((t,{id:r,name:c,type:u,signinUrl:E,callbackUrl:P})=>(t[r]={id:r,name:c,type:u,signinUrl:E,callbackUrl:P},t),{})}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=providers},14393:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=session;var u=c(49105);async function session(t){var r,c,E,P,O,J;let{options:W,sessionStore:K,newSession:R,isUpdate:U}=t,{adapter:D,jwt:B,events:F,callbacks:q,logger:G,session:{strategy:V,maxAge:X}}=W,Y={body:{},headers:[{key:"Content-Type",value:"application/json"}],cookies:[]},Z=K.value;if(!Z)return Y;if("jwt"===V)try{let t=await B.decode({...B,token:Z});if(!t)throw Error("JWT invalid");let E=await q.jwt({token:t,...U&&{trigger:"update"},session:R}),P=(0,u.fromDate)(X),O=await q.session({session:{user:{name:null==t?void 0:t.name,email:null==t?void 0:t.email,image:null==t?void 0:t.picture},expires:P.toISOString()},token:E});Y.body=O;let J=await B.encode({...B,token:E,maxAge:W.session.maxAge}),D=K.chunk(J,{expires:P});null===(r=Y.cookies)||void 0===r||r.push(...D),await (null===(c=F.session)||void 0===c?void 0:c.call(F,{session:O,token:E}))}catch(t){G.error("JWT_SESSION_ERROR",t),null===(E=Y.cookies)||void 0===E||E.push(...K.clean())}else try{let{getSessionAndUser:t,deleteSession:r,updateSession:c}=D,E=await t(Z);if(E&&E.session.expires.valueOf()<Date.now()&&(await r(Z),E=null),E){let{user:t,session:r}=E,J=W.session.updateAge,K=r.expires.valueOf()-1e3*X+1e3*J,D=(0,u.fromDate)(X);K<=Date.now()&&await c({sessionToken:Z,expires:D});let B=await q.session({session:{user:{name:t.name,email:t.email,image:t.image},expires:r.expires.toISOString()},user:t,newSession:R,...U?{trigger:"update"}:{}});Y.body=B,null===(P=Y.cookies)||void 0===P||P.push({name:W.cookies.sessionToken.name,value:Z,options:{...W.cookies.sessionToken.options,expires:D}}),await (null===(O=F.session)||void 0===O?void 0:O.call(F,{session:B}))}else Z&&(null===(J=Y.cookies)||void 0===J||J.push(...K.clean()))}catch(t){G.error("SESSION_ERROR",t)}return Y}},68966:(t,r,c)=>{"use strict";var u=c(2049);Object.defineProperty(r,"__esModule",{value:!0}),r.default=signin;var E=u(c(35896)),P=u(c(81499)),O=u(c(3727));async function signin(t){let{options:r,query:c,body:u}=t,{url:J,callbacks:W,logger:K,provider:R}=r;if(!R.type)return{status:500,text:`Error: Type not specified for ${R.name}`};if("oauth"===R.type)try{let t=await (0,E.default)({options:r,query:c});return t}catch(t){return K.error("SIGNIN_OAUTH_ERROR",{error:t,providerId:R.id}),{redirect:`${J}/error?error=OAuthSignin`}}else if("email"===R.type){var U;let t=null==u?void 0:u.email;if(!t)return{redirect:`${J}/error?error=EmailSignin`};let c=null!==(U=R.normalizeIdentifier)&&void 0!==U?U:t=>{let[r,c]=t.toLowerCase().trim().split("@");return c=c.split(",")[0],`${r}@${c}`};try{t=c(null==u?void 0:u.email)}catch(t){return K.error("SIGNIN_EMAIL_ERROR",{error:t,providerId:R.id}),{redirect:`${J}/error?error=EmailSignin`}}let E=await (0,O.default)({email:t,adapter:r.adapter}),D={providerAccountId:t,userId:t,type:"email",provider:R.id};try{let t=await W.signIn({user:E,account:D,email:{verificationRequest:!0}});if(!t)return{redirect:`${J}/error?error=AccessDenied`};if("string"==typeof t)return{redirect:t}}catch(t){return{redirect:`${J}/error?${new URLSearchParams({error:t})}`}}try{let c=await (0,P.default)(t,r);return{redirect:c}}catch(t){return K.error("SIGNIN_EMAIL_ERROR",{error:t,providerId:R.id}),{redirect:`${J}/error?error=EmailSignin`}}}return{redirect:`${J}/signin`}}},15681:(t,r)=>{"use strict";async function signout(t){var r,c;let{options:u,sessionStore:E}=t,{adapter:P,events:O,jwt:J,callbackUrl:W,logger:K,session:R}=u,U=null==E?void 0:E.value;if(!U)return{redirect:W};if("jwt"===R.strategy)try{let t=await J.decode({...J,token:U});await (null===(r=O.signOut)||void 0===r?void 0:r.call(O,{token:t}))}catch(t){K.error("SIGNOUT_ERROR",t)}else try{let t=await P.deleteSession(U);await (null===(c=O.signOut)||void 0===c?void 0:c.call(O,{session:t}))}catch(t){K.error("SIGNOUT_ERROR",t)}let D=E.clean();return{redirect:W,cookies:D}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=signout},22315:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},67630:t=>{"use strict";t.exports=function(){return':root{--border-width:1px;--border-radius:0.5rem;--color-error:#c94b4b;--color-info:#157efb;--color-info-hover:#0f6ddb;--color-info-text:#fff}.__next-auth-theme-auto,.__next-auth-theme-light{--color-background:#ececec;--color-background-hover:hsla(0,0%,93%,.8);--color-background-card:#fff;--color-text:#000;--color-primary:#444;--color-control-border:#bbb;--color-button-active-background:#f9f9f9;--color-button-active-border:#aaa;--color-separator:#ccc}.__next-auth-theme-dark{--color-background:#161b22;--color-background-hover:rgba(22,27,34,.8);--color-background-card:#0d1117;--color-text:#fff;--color-primary:#ccc;--color-control-border:#555;--color-button-active-background:#060606;--color-button-active-border:#666;--color-separator:#444}@media (prefers-color-scheme:dark){.__next-auth-theme-auto{--color-background:#161b22;--color-background-hover:rgba(22,27,34,.8);--color-background-card:#0d1117;--color-text:#fff;--color-primary:#ccc;--color-control-border:#555;--color-button-active-background:#060606;--color-button-active-border:#666;--color-separator:#444}a.button,button{background-color:var(--provider-dark-bg,var(--color-background));color:var(--provider-dark-color,var(--color-primary))}a.button:hover,button:hover{background-color:var(--provider-dark-bg-hover,var(--color-background-hover))!important}#provider-logo{display:none!important}#provider-logo-dark{display:block!important;width:25px}}html{box-sizing:border-box}*,:after,:before{box-sizing:inherit;margin:0;padding:0}body{background-color:var(--color-background);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;margin:0;padding:0}h1{font-weight:400}h1,p{color:var(--color-text);margin-bottom:1.5rem;padding:0 1rem}form{margin:0;padding:0}label{font-weight:500;margin-bottom:.25rem;text-align:left}input[type],label{color:var(--color-text);display:block}input[type]{background:var(--color-background-card);border:var(--border-width) solid var(--color-control-border);border-radius:var(--border-radius);box-sizing:border-box;font-size:1rem;padding:.5rem 1rem;width:100%}input[type]:focus{box-shadow:none}p{font-size:1.1rem;line-height:2rem}a.button{line-height:1rem;text-decoration:none}a.button:link,a.button:visited{background-color:var(--color-background);color:var(--color-primary)}button span{flex-grow:1}a.button,button{align-items:center;background-color:var(--provider-bg);border-color:rgba(0,0,0,.1);border-radius:var(--border-radius);color:var(--provider-color,var(--color-primary));display:flex;font-size:1.1rem;font-weight:500;justify-content:center;min-height:62px;padding:.75rem 1rem;position:relative;transition:all .1s ease-in-out}a.button:hover,button:hover{background-color:var(--provider-bg-hover,var(--color-background-hover));cursor:pointer}a.button:active,button:active{cursor:pointer}a.button #provider-logo,button #provider-logo{display:block;width:25px}a.button #provider-logo-dark,button #provider-logo-dark{display:none}#submitButton{background-color:var(--brand-color,var(--color-info));color:var(--button-text-color,var(--color-info-text));width:100%}#submitButton:hover{background-color:var(--button-hover-bg,var(--color-info-hover))!important}a.site{color:var(--color-primary);font-size:1rem;line-height:2rem;text-decoration:none}a.site:hover{text-decoration:underline}.page{box-sizing:border-box;display:grid;height:100%;margin:0;padding:0;place-items:center;position:absolute;width:100%}.page>div{text-align:center}.error a.button{margin-top:.5rem;padding-left:2rem;padding-right:2rem}.error .message{margin-bottom:1.5rem}.signin input[type=text]{display:block;margin-left:auto;margin-right:auto}.signin hr{border:0;border-top:1px solid var(--color-separator);display:block;margin:2rem auto 1rem;overflow:visible}.signin hr:before{background:var(--color-background-card);color:#888;content:"or";padding:0 .4rem;position:relative;top:-.7rem}.signin .error{background:#f5f5f5;background:var(--color-error);border-radius:.3rem;font-weight:500}.signin .error p{color:var(--color-info-text);font-size:.9rem;line-height:1.2rem;padding:.5rem 1rem;text-align:left}.signin form,.signin>div{display:block}.signin form input[type],.signin>div input[type]{margin-bottom:.5rem}.signin form button,.signin>div button{width:100%}.signin .provider+.provider{margin-top:1rem}.logo{display:inline-block;margin:1.25rem 0;max-height:70px;max-width:150px}.card{background-color:var(--color-background-card);border-radius:2rem;padding:1.25rem 2rem}.card .header{color:var(--color-primary)}.section-header{color:var(--color-text)}@media screen and (min-width:450px){.card{margin:2rem 0;width:368px}}@media screen and (max-width:450px){.card{margin:1rem 0;width:343px}}'}},94020:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var u={};Object.defineProperty(r,"default",{enumerable:!0,get:function(){return P.default}});var E=c(22315);Object.keys(E).forEach(function(t){!("default"===t||"__esModule"===t||Object.prototype.hasOwnProperty.call(u,t))&&(t in r&&r[t]===E[t]||Object.defineProperty(r,t,{enumerable:!0,get:function(){return E[t]}}))});var P=_interopRequireWildcard(c(40674));function _getRequireWildcardCache(t){if("function"!=typeof WeakMap)return null;var r=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(t){return t?c:r})(t)}function _interopRequireWildcard(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var c=_getRequireWildcardCache(r);if(c&&c.has(t))return c.get(t);var u={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in t)if("default"!==P&&({}).hasOwnProperty.call(t,P)){var O=E?Object.getOwnPropertyDescriptor(t,P):null;O&&(O.get||O.set)?Object.defineProperty(u,P,O):u[P]=t[P]}return u.default=t,c&&c.set(t,u),u}Object.keys(P).forEach(function(t){!("default"===t||"__esModule"===t||Object.prototype.hasOwnProperty.call(u,t))&&(t in r&&r[t]===P[t]||Object.defineProperty(r,t,{enumerable:!0,get:function(){return P[t]}}))})},87938:(t,r,c)=>{"use strict";var u=c(2049);Object.defineProperty(r,"__esModule",{value:!0});var E={encode:!0,decode:!0,getToken:!0};r.decode=decode,r.encode=encode,r.getToken=getToken;var P=c(12536),O=u(c(85808)),J=c(62903),W=c(50358),K=c(73725);Object.keys(K).forEach(function(t){!("default"===t||"__esModule"===t||Object.prototype.hasOwnProperty.call(E,t))&&(t in r&&r[t]===K[t]||Object.defineProperty(r,t,{enumerable:!0,get:function(){return K[t]}}))});let now=()=>Date.now()/1e3|0;async function encode(t){let{token:r={},secret:c,maxAge:u=2592e3,salt:E=""}=t,O=await getDerivedEncryptionKey(c,E);return await new P.EncryptJWT(r).setProtectedHeader({alg:"dir",enc:"A256GCM"}).setIssuedAt().setExpirationTime(now()+u).setJti((0,J.v4)()).encrypt(O)}async function decode(t){let{token:r,secret:c,salt:u=""}=t;if(!r)return null;let E=await getDerivedEncryptionKey(c,u),{payload:O}=await (0,P.jwtDecrypt)(r,E,{clockTolerance:15});return O}async function getToken(t){var r,c,u,E;let{req:P,secureCookie:O=null!==(r=null===(c=process.env.NEXTAUTH_URL)||void 0===c?void 0:c.startsWith("https://"))&&void 0!==r?r:!!process.env.VERCEL,cookieName:J=O?"__Secure-next-auth.session-token":"next-auth.session-token",raw:K,decode:R=decode,logger:U=console,secret:D=null!==(u=process.env.NEXTAUTH_SECRET)&&void 0!==u?u:process.env.AUTH_SECRET}=t;if(!P)throw Error("Must pass `req` to JWT getToken()");let B=new W.SessionStore({name:J,options:{secure:O}},{cookies:P.cookies,headers:P.headers},U),F=B.value,q=P.headers instanceof Headers?P.headers.get("authorization"):null===(E=P.headers)||void 0===E?void 0:E.authorization;if(!F&&(null==q?void 0:q.split(" ")[0])==="Bearer"){let t=q.split(" ")[1];F=decodeURIComponent(t)}if(!F)return null;if(K)return F;try{return await R({token:F,secret:D})}catch(t){return null}}async function getDerivedEncryptionKey(t,r){return await (0,O.default)("sha256",t,r,`NextAuth.js Generated Encryption Key${r?` (${r})`:""}`,32)}},73725:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0})},40674:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.getServerSession=getServerSession,r.unstable_getServerSession=unstable_getServerSession;var u=c(80749),E=c(30515);async function NextAuthApiHandler(t,r,c){var P,O,J,W,K,R,U,D,B;let{nextauth:F,...q}=t.query;null!==(P=c.secret)&&void 0!==P||(c.secret=null!==(O=null!==(J=null===(W=c.jwt)||void 0===W?void 0:W.secret)&&void 0!==J?J:process.env.NEXTAUTH_SECRET)&&void 0!==O?O:process.env.AUTH_SECRET);let G=await (0,u.AuthHandler)({req:{body:t.body,query:q,cookies:t.cookies,headers:t.headers,method:t.method,action:null==F?void 0:F[0],providerId:null==F?void 0:F[1],error:null!==(K=t.query.error)&&void 0!==K?K:null==F?void 0:F[1]},options:c});if(r.status(null!==(R=G.status)&&void 0!==R?R:200),null===(U=G.cookies)||void 0===U||U.forEach(t=>(0,E.setCookie)(r,t)),null===(D=G.headers)||void 0===D||D.forEach(t=>r.setHeader(t.key,t.value)),G.redirect){if((null===(B=t.body)||void 0===B?void 0:B.json)!=="true"){r.status(302).setHeader("Location",G.redirect),r.end();return}return r.json({url:G.redirect})}return r.send(G.body)}async function NextAuthRouteHandler(t,r,P){var O,J,W,K;null!==(O=P.secret)&&void 0!==O||(P.secret=null!==(J=process.env.NEXTAUTH_SECRET)&&void 0!==J?J:process.env.AUTH_SECRET);let{headers:R,cookies:U}=c(24596),D=null===(W=await r.params)||void 0===W?void 0:W.nextauth,B=Object.fromEntries(t.nextUrl.searchParams),F=await (0,E.getBody)(t),q=await (0,u.AuthHandler)({req:{body:F,query:B,cookies:Object.fromEntries((await U()).getAll().map(t=>[t.name,t.value])),headers:Object.fromEntries(await R()),method:t.method,action:null==D?void 0:D[0],providerId:null==D?void 0:D[1],error:null!==(K=B.error)&&void 0!==K?K:null==D?void 0:D[1]},options:P}),G=(0,E.toResponse)(q),V=G.headers.get("Location");return(null==F?void 0:F.json)==="true"&&V?(G.headers.delete("Location"),G.headers.set("Content-Type","application/json"),new Response(JSON.stringify({url:V}),{status:q.status,headers:G.headers})):G}function NextAuth(...t){var r;return 1===t.length?async(r,c)=>null!=c&&c.params?await NextAuthRouteHandler(r,c,t[0]):await NextAuthApiHandler(r,c,t[0]):null!==(r=t[1])&&void 0!==r&&r.params?NextAuthRouteHandler(...t):NextAuthApiHandler(...t)}async function getServerSession(...t){var r,P,O;let J,W,K;let R=0===t.length||1===t.length;if(R){K=Object.assign({},t[0],{providers:[]});let{headers:r,cookies:u}=c(24596);J={headers:Object.fromEntries(await r()),cookies:Object.fromEntries((await u()).getAll().map(t=>[t.name,t.value]))},W={getHeader(){},setCookie(){},setHeader(){}}}else J=t[0],W=t[1],K=Object.assign({},t[2],{providers:[]});null!==(P=(r=K).secret)&&void 0!==P||(r.secret=null!==(O=process.env.NEXTAUTH_SECRET)&&void 0!==O?O:process.env.AUTH_SECRET);let U=await (0,u.AuthHandler)({options:K,req:{action:"session",method:"GET",cookies:J.cookies,headers:J.headers}}),{body:D,cookies:B,status:F=200}=U;if(null==B||B.forEach(t=>(0,E.setCookie)(W,t)),D&&"string"!=typeof D&&Object.keys(D).length){if(200===F)return R&&delete D.expires,D;throw Error(D.message)}return null}async function unstable_getServerSession(...t){return await getServerSession(...t)}r.default=NextAuth},30515:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getBody=getBody,r.setCookie=setCookie,r.toResponse=toResponse;var u=c(40754);function setCookie(t,r){var c;let E=null!==(c=t.getHeader("Set-Cookie"))&&void 0!==c?c:[];Array.isArray(E)||(E=[E]);let{name:P,value:O,options:J}=r,W=(0,u.serialize)(P,O,J);E.push(W),t.setHeader("Set-Cookie",E)}async function getBody(t){if(!("body"in t)||!t.body||"POST"!==t.method)return;let r=t.headers.get("content-type");if(null!=r&&r.includes("application/json"))return await t.json();if(null!=r&&r.includes("application/x-www-form-urlencoded")){let r=new URLSearchParams(await t.text());return Object.fromEntries(r)}}function toResponse(t){var r,c,E;let P=new Headers(null===(r=t.headers)||void 0===r?void 0:r.reduce((t,{key:r,value:c})=>(t[r]=c,t),{}));null===(c=t.cookies)||void 0===c||c.forEach(t=>{let{name:r,value:c,options:E}=t,O=(0,u.serialize)(r,c,E);P.has("Set-Cookie")?P.append("Set-Cookie",O):P.set("Set-Cookie",O)});let O=t.body;"application/json"===P.get("content-type")?O=JSON.stringify(t.body):"application/x-www-form-urlencoded"===P.get("content-type")&&(O=new URLSearchParams(t.body).toString());let J=t.redirect?302:null!==(E=t.status)&&void 0!==E?E:200,W=new Response(O,{headers:P,status:J});return t.redirect&&W.headers.set("Location",t.redirect),W}},40754:(t,r)=>{"use strict";/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */r.parse=parse,r.serialize=serialize;var c=Object.prototype.toString,u=Object.prototype.hasOwnProperty,E=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,P=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,O=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,J=/^[\u0020-\u003A\u003D-\u007E]*$/;function parse(t,r){if("string"!=typeof t)throw TypeError("argument str must be a string");var c={},E=t.length;if(E<2)return c;var P=r&&r.decode||decode,O=0,J=0,W=0;do{if(-1===(J=t.indexOf("=",O)))break;if(-1===(W=t.indexOf(";",O)))W=E;else if(J>W){O=t.lastIndexOf(";",J-1)+1;continue}var K=startIndex(t,O,J),R=endIndex(t,J,K),U=t.slice(K,R);if(!u.call(c,U)){var D=startIndex(t,J+1,W),B=endIndex(t,W,D);34===t.charCodeAt(D)&&34===t.charCodeAt(B-1)&&(D++,B--);var F=t.slice(D,B);c[U]=tryDecode(F,P)}O=W+1}while(O<E);return c}function startIndex(t,r,c){do{var u=t.charCodeAt(r);if(32!==u&&9!==u)return r}while(++r<c);return c}function endIndex(t,r,c){for(;r>c;){var u=t.charCodeAt(--r);if(32!==u&&9!==u)return r+1}return c}function serialize(t,r,c){var u=c&&c.encode||encodeURIComponent;if("function"!=typeof u)throw TypeError("option encode is invalid");if(!E.test(t))throw TypeError("argument name is invalid");var W=u(r);if(!P.test(W))throw TypeError("argument val is invalid");var K=t+"="+W;if(!c)return K;if(null!=c.maxAge){var R=Math.floor(c.maxAge);if(!isFinite(R))throw TypeError("option maxAge is invalid");K+="; Max-Age="+R}if(c.domain){if(!O.test(c.domain))throw TypeError("option domain is invalid");K+="; Domain="+c.domain}if(c.path){if(!J.test(c.path))throw TypeError("option path is invalid");K+="; Path="+c.path}if(c.expires){var U=c.expires;if(!isDate(U)||isNaN(U.valueOf()))throw TypeError("option expires is invalid");K+="; Expires="+U.toUTCString()}if(c.httpOnly&&(K+="; HttpOnly"),c.secure&&(K+="; Secure"),c.partitioned&&(K+="; Partitioned"),c.priority)switch("string"==typeof c.priority?c.priority.toLowerCase():c.priority){case"low":K+="; Priority=Low";break;case"medium":K+="; Priority=Medium";break;case"high":K+="; Priority=High";break;default:throw TypeError("option priority is invalid")}if(c.sameSite)switch("string"==typeof c.sameSite?c.sameSite.toLowerCase():c.sameSite){case!0:case"strict":K+="; SameSite=Strict";break;case"lax":K+="; SameSite=Lax";break;case"none":K+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return K}function decode(t){return -1!==t.indexOf("%")?decodeURIComponent(t):t}function isDate(t){return"[object Date]"===c.call(t)}function tryDecode(t,r){try{return r(t)}catch(r){return t}}},12536:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.cryptoRuntime=r.base64url=r.generateSecret=r.generateKeyPair=r.errors=r.decodeJwt=r.decodeProtectedHeader=r.importJWK=r.importX509=r.importPKCS8=r.importSPKI=r.exportJWK=r.exportSPKI=r.exportPKCS8=r.UnsecuredJWT=r.createRemoteJWKSet=r.createLocalJWKSet=r.EmbeddedJWK=r.calculateJwkThumbprintUri=r.calculateJwkThumbprint=r.EncryptJWT=r.SignJWT=r.GeneralSign=r.FlattenedSign=r.CompactSign=r.FlattenedEncrypt=r.CompactEncrypt=r.jwtDecrypt=r.jwtVerify=r.generalVerify=r.flattenedVerify=r.compactVerify=r.GeneralEncrypt=r.generalDecrypt=r.flattenedDecrypt=r.compactDecrypt=void 0;var u=c(32337);Object.defineProperty(r,"compactDecrypt",{enumerable:!0,get:function(){return u.compactDecrypt}});var E=c(51687);Object.defineProperty(r,"flattenedDecrypt",{enumerable:!0,get:function(){return E.flattenedDecrypt}});var P=c(18738);Object.defineProperty(r,"generalDecrypt",{enumerable:!0,get:function(){return P.generalDecrypt}});var O=c(24790);Object.defineProperty(r,"GeneralEncrypt",{enumerable:!0,get:function(){return O.GeneralEncrypt}});var J=c(12133);Object.defineProperty(r,"compactVerify",{enumerable:!0,get:function(){return J.compactVerify}});var W=c(36557);Object.defineProperty(r,"flattenedVerify",{enumerable:!0,get:function(){return W.flattenedVerify}});var K=c(98990);Object.defineProperty(r,"generalVerify",{enumerable:!0,get:function(){return K.generalVerify}});var R=c(37063);Object.defineProperty(r,"jwtVerify",{enumerable:!0,get:function(){return R.jwtVerify}});var U=c(73297);Object.defineProperty(r,"jwtDecrypt",{enumerable:!0,get:function(){return U.jwtDecrypt}});var D=c(48118);Object.defineProperty(r,"CompactEncrypt",{enumerable:!0,get:function(){return D.CompactEncrypt}});var B=c(92757);Object.defineProperty(r,"FlattenedEncrypt",{enumerable:!0,get:function(){return B.FlattenedEncrypt}});var F=c(46177);Object.defineProperty(r,"CompactSign",{enumerable:!0,get:function(){return F.CompactSign}});var q=c(34856);Object.defineProperty(r,"FlattenedSign",{enumerable:!0,get:function(){return q.FlattenedSign}});var G=c(21863);Object.defineProperty(r,"GeneralSign",{enumerable:!0,get:function(){return G.GeneralSign}});var V=c(3637);Object.defineProperty(r,"SignJWT",{enumerable:!0,get:function(){return V.SignJWT}});var X=c(91264);Object.defineProperty(r,"EncryptJWT",{enumerable:!0,get:function(){return X.EncryptJWT}});var Y=c(532);Object.defineProperty(r,"calculateJwkThumbprint",{enumerable:!0,get:function(){return Y.calculateJwkThumbprint}}),Object.defineProperty(r,"calculateJwkThumbprintUri",{enumerable:!0,get:function(){return Y.calculateJwkThumbprintUri}});var Z=c(46066);Object.defineProperty(r,"EmbeddedJWK",{enumerable:!0,get:function(){return Z.EmbeddedJWK}});var Q=c(90203);Object.defineProperty(r,"createLocalJWKSet",{enumerable:!0,get:function(){return Q.createLocalJWKSet}});var ee=c(67671);Object.defineProperty(r,"createRemoteJWKSet",{enumerable:!0,get:function(){return ee.createRemoteJWKSet}});var et=c(88888);Object.defineProperty(r,"UnsecuredJWT",{enumerable:!0,get:function(){return et.UnsecuredJWT}});var er=c(87162);Object.defineProperty(r,"exportPKCS8",{enumerable:!0,get:function(){return er.exportPKCS8}}),Object.defineProperty(r,"exportSPKI",{enumerable:!0,get:function(){return er.exportSPKI}}),Object.defineProperty(r,"exportJWK",{enumerable:!0,get:function(){return er.exportJWK}});var en=c(22176);Object.defineProperty(r,"importSPKI",{enumerable:!0,get:function(){return en.importSPKI}}),Object.defineProperty(r,"importPKCS8",{enumerable:!0,get:function(){return en.importPKCS8}}),Object.defineProperty(r,"importX509",{enumerable:!0,get:function(){return en.importX509}}),Object.defineProperty(r,"importJWK",{enumerable:!0,get:function(){return en.importJWK}});var ei=c(75395);Object.defineProperty(r,"decodeProtectedHeader",{enumerable:!0,get:function(){return ei.decodeProtectedHeader}});var eo=c(42358);Object.defineProperty(r,"decodeJwt",{enumerable:!0,get:function(){return eo.decodeJwt}}),r.errors=c(97e3);var ea=c(41856);Object.defineProperty(r,"generateKeyPair",{enumerable:!0,get:function(){return ea.generateKeyPair}});var es=c(53471);Object.defineProperty(r,"generateSecret",{enumerable:!0,get:function(){return es.generateSecret}}),r.base64url=c(49684);var ec=c(76495);Object.defineProperty(r,"cryptoRuntime",{enumerable:!0,get:function(){return ec.default}})},32337:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.compactDecrypt=void 0;let u=c(51687),E=c(97e3),P=c(57378);async function compactDecrypt(t,r,c){if(t instanceof Uint8Array&&(t=P.decoder.decode(t)),"string"!=typeof t)throw new E.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:O,1:J,2:W,3:K,4:R,length:U}=t.split(".");if(5!==U)throw new E.JWEInvalid("Invalid Compact JWE");let D=await (0,u.flattenedDecrypt)({ciphertext:K,iv:W||void 0,protected:O||void 0,tag:R||void 0,encrypted_key:J||void 0},r,c),B={plaintext:D.plaintext,protectedHeader:D.protectedHeader};return"function"==typeof r?{...B,key:D.key}:B}r.compactDecrypt=compactDecrypt},48118:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CompactEncrypt=void 0;let u=c(92757);let CompactEncrypt=class CompactEncrypt{constructor(t){this._flattened=new u.FlattenedEncrypt(t)}setContentEncryptionKey(t){return this._flattened.setContentEncryptionKey(t),this}setInitializationVector(t){return this._flattened.setInitializationVector(t),this}setProtectedHeader(t){return this._flattened.setProtectedHeader(t),this}setKeyManagementParameters(t){return this._flattened.setKeyManagementParameters(t),this}async encrypt(t,r){let c=await this._flattened.encrypt(t,r);return[c.protected,c.encrypted_key,c.iv,c.ciphertext,c.tag].join(".")}};r.CompactEncrypt=CompactEncrypt},51687:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.flattenedDecrypt=void 0;let u=c(55285),E=c(54637),P=c(97869),O=c(97e3),J=c(36905),W=c(66725),K=c(88484),R=c(57378),U=c(20284),D=c(75817),B=c(67747);async function flattenedDecrypt(t,r,c){var F;let q,G,V,X,Y,Z,Q;if(!(0,W.default)(t))throw new O.JWEInvalid("Flattened JWE must be an object");if(void 0===t.protected&&void 0===t.header&&void 0===t.unprotected)throw new O.JWEInvalid("JOSE Header missing");if("string"!=typeof t.iv)throw new O.JWEInvalid("JWE Initialization Vector missing or incorrect type");if("string"!=typeof t.ciphertext)throw new O.JWEInvalid("JWE Ciphertext missing or incorrect type");if("string"!=typeof t.tag)throw new O.JWEInvalid("JWE Authentication Tag missing or incorrect type");if(void 0!==t.protected&&"string"!=typeof t.protected)throw new O.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==t.encrypted_key&&"string"!=typeof t.encrypted_key)throw new O.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==t.aad&&"string"!=typeof t.aad)throw new O.JWEInvalid("JWE AAD incorrect type");if(void 0!==t.header&&!(0,W.default)(t.header))throw new O.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==t.unprotected&&!(0,W.default)(t.unprotected))throw new O.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(t.protected)try{let r=(0,u.decode)(t.protected);q=JSON.parse(R.decoder.decode(r))}catch{throw new O.JWEInvalid("JWE Protected Header is invalid")}if(!(0,J.default)(q,t.header,t.unprotected))throw new O.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let ee={...q,...t.header,...t.unprotected};if((0,D.default)(O.JWEInvalid,new Map,null==c?void 0:c.crit,q,ee),void 0!==ee.zip){if(!q||!q.zip)throw new O.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==ee.zip)throw new O.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:et,enc:er}=ee;if("string"!=typeof et||!et)throw new O.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof er||!er)throw new O.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let en=c&&(0,B.default)("keyManagementAlgorithms",c.keyManagementAlgorithms),ei=c&&(0,B.default)("contentEncryptionAlgorithms",c.contentEncryptionAlgorithms);if(en&&!en.has(et))throw new O.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(ei&&!ei.has(er))throw new O.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==t.encrypted_key)try{G=(0,u.decode)(t.encrypted_key)}catch{throw new O.JWEInvalid("Failed to base64url decode the encrypted_key")}let eo=!1;"function"==typeof r&&(r=await r(q,t),eo=!0);try{V=await (0,K.default)(et,r,G,ee,c)}catch(t){if(t instanceof TypeError||t instanceof O.JWEInvalid||t instanceof O.JOSENotSupported)throw t;V=(0,U.default)(er)}try{X=(0,u.decode)(t.iv)}catch{throw new O.JWEInvalid("Failed to base64url decode the iv")}try{Y=(0,u.decode)(t.tag)}catch{throw new O.JWEInvalid("Failed to base64url decode the tag")}let ea=R.encoder.encode(null!==(F=t.protected)&&void 0!==F?F:"");Z=void 0!==t.aad?(0,R.concat)(ea,R.encoder.encode("."),R.encoder.encode(t.aad)):ea;try{Q=(0,u.decode)(t.ciphertext)}catch{throw new O.JWEInvalid("Failed to base64url decode the ciphertext")}let es=await (0,E.default)(er,V,Q,X,Y,Z);"DEF"===ee.zip&&(es=await ((null==c?void 0:c.inflateRaw)||P.inflate)(es));let ec={plaintext:es};if(void 0!==t.protected&&(ec.protectedHeader=q),void 0!==t.aad)try{ec.additionalAuthenticatedData=(0,u.decode)(t.aad)}catch{throw new O.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==t.unprotected&&(ec.sharedUnprotectedHeader=t.unprotected),void 0!==t.header&&(ec.unprotectedHeader=t.header),eo)?{...ec,key:r}:ec}r.flattenedDecrypt=flattenedDecrypt},92757:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FlattenedEncrypt=r.unprotected=void 0;let u=c(55285),E=c(4868),P=c(97869),O=c(82759),J=c(92235),W=c(97e3),K=c(36905),R=c(57378),U=c(75817);r.unprotected=Symbol();let FlattenedEncrypt=class FlattenedEncrypt{constructor(t){if(!(t instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=t}setKeyManagementParameters(t){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=t,this}setProtectedHeader(t){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setSharedUnprotectedHeader(t){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=t,this}setUnprotectedHeader(t){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}setAdditionalAuthenticatedData(t){return this._aad=t,this}setContentEncryptionKey(t){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=t,this}setInitializationVector(t){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=t,this}async encrypt(t,c){let D,B,F,q,G,V,X;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new W.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!(0,K.default)(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new W.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let Y={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if((0,U.default)(W.JWEInvalid,new Map,null==c?void 0:c.crit,this._protectedHeader,Y),void 0!==Y.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new W.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==Y.zip)throw new W.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:Z,enc:Q}=Y;if("string"!=typeof Z||!Z)throw new W.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof Q||!Q)throw new W.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===Z){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===Z&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let u;({cek:B,encryptedKey:D,parameters:u}=await (0,J.default)(Z,Q,t,this._cek,this._keyManagementParameters)),u&&(c&&r.unprotected in c?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...u}:this.setUnprotectedHeader(u):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...u}:this.setProtectedHeader(u))}if(this._iv||(this._iv=(0,O.default)(Q)),q=this._protectedHeader?R.encoder.encode((0,u.encode)(JSON.stringify(this._protectedHeader))):R.encoder.encode(""),this._aad?(G=(0,u.encode)(this._aad),F=(0,R.concat)(q,R.encoder.encode("."),R.encoder.encode(G))):F=q,"DEF"===Y.zip){let t=await ((null==c?void 0:c.deflateRaw)||P.deflate)(this._plaintext);({ciphertext:V,tag:X}=await (0,E.default)(Q,t,B,this._iv,F))}else({ciphertext:V,tag:X}=await (0,E.default)(Q,this._plaintext,B,this._iv,F));let ee={ciphertext:(0,u.encode)(V),iv:(0,u.encode)(this._iv),tag:(0,u.encode)(X)};return D&&(ee.encrypted_key=(0,u.encode)(D)),G&&(ee.aad=G),this._protectedHeader&&(ee.protected=R.decoder.decode(q)),this._sharedUnprotectedHeader&&(ee.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(ee.header=this._unprotectedHeader),ee}};r.FlattenedEncrypt=FlattenedEncrypt},18738:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generalDecrypt=void 0;let u=c(51687),E=c(97e3),P=c(66725);async function generalDecrypt(t,r,c){if(!(0,P.default)(t))throw new E.JWEInvalid("General JWE must be an object");if(!Array.isArray(t.recipients)||!t.recipients.every(P.default))throw new E.JWEInvalid("JWE Recipients missing or incorrect type");if(!t.recipients.length)throw new E.JWEInvalid("JWE Recipients has no members");for(let E of t.recipients)try{return await (0,u.flattenedDecrypt)({aad:t.aad,ciphertext:t.ciphertext,encrypted_key:E.encrypted_key,header:E.header,iv:t.iv,protected:t.protected,tag:t.tag,unprotected:t.unprotected},r,c)}catch{}throw new E.JWEDecryptionFailed}r.generalDecrypt=generalDecrypt},24790:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GeneralEncrypt=void 0;let u=c(92757),E=c(97e3),P=c(20284),O=c(36905),J=c(92235),W=c(55285),K=c(75817);let IndividualRecipient=class IndividualRecipient{constructor(t,r,c){this.parent=t,this.key=r,this.options=c}setUnprotectedHeader(t){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=t,this}addRecipient(...t){return this.parent.addRecipient(...t)}encrypt(...t){return this.parent.encrypt(...t)}done(){return this.parent}};let GeneralEncrypt=class GeneralEncrypt{constructor(t){this._recipients=[],this._plaintext=t}addRecipient(t,r){let c=new IndividualRecipient(this,t,{crit:null==r?void 0:r.crit});return this._recipients.push(c),c}setProtectedHeader(t){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setSharedUnprotectedHeader(t){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}setAdditionalAuthenticatedData(t){return this._aad=t,this}async encrypt(t){var r,c,R;let U;if(!this._recipients.length)throw new E.JWEInvalid("at least one recipient must be added");if(t={deflateRaw:null==t?void 0:t.deflateRaw},1===this._recipients.length){let[r]=this._recipients,c=await new u.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(r.unprotectedHeader).encrypt(r.key,{...r.options,...t}),E={ciphertext:c.ciphertext,iv:c.iv,recipients:[{}],tag:c.tag};return c.aad&&(E.aad=c.aad),c.protected&&(E.protected=c.protected),c.unprotected&&(E.unprotected=c.unprotected),c.encrypted_key&&(E.recipients[0].encrypted_key=c.encrypted_key),c.header&&(E.recipients[0].header=c.header),E}for(let t=0;t<this._recipients.length;t++){let r=this._recipients[t];if(!(0,O.default)(this._protectedHeader,this._unprotectedHeader,r.unprotectedHeader))throw new E.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let c={...this._protectedHeader,...this._unprotectedHeader,...r.unprotectedHeader},{alg:u}=c;if("string"!=typeof u||!u)throw new E.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===u||"ECDH-ES"===u)throw new E.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof c.enc||!c.enc)throw new E.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(U){if(U!==c.enc)throw new E.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else U=c.enc;if((0,K.default)(E.JWEInvalid,new Map,r.options.crit,this._protectedHeader,c),void 0!==c.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new E.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let D=(0,P.default)(U),B={ciphertext:"",iv:"",recipients:[],tag:""};for(let E=0;E<this._recipients.length;E++){let P=this._recipients[E],O={};B.recipients.push(O);let K={...this._protectedHeader,...this._unprotectedHeader,...P.unprotectedHeader},F=K.alg.startsWith("PBES2")?2048+E:void 0;if(0===E){let r=await new u.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(D).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(P.unprotectedHeader).setKeyManagementParameters({p2c:F}).encrypt(P.key,{...P.options,...t,[u.unprotected]:!0});B.ciphertext=r.ciphertext,B.iv=r.iv,B.tag=r.tag,r.aad&&(B.aad=r.aad),r.protected&&(B.protected=r.protected),r.unprotected&&(B.unprotected=r.unprotected),O.encrypted_key=r.encrypted_key,r.header&&(O.header=r.header);continue}let{encryptedKey:q,parameters:G}=await (0,J.default)((null===(r=P.unprotectedHeader)||void 0===r?void 0:r.alg)||(null===(c=this._protectedHeader)||void 0===c?void 0:c.alg)||(null===(R=this._unprotectedHeader)||void 0===R?void 0:R.alg),U,P.key,D,{p2c:F});O.encrypted_key=(0,W.encode)(q),(P.unprotectedHeader||G)&&(O.header={...P.unprotectedHeader,...G})}return B}};r.GeneralEncrypt=GeneralEncrypt},46066:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EmbeddedJWK=void 0;let u=c(22176),E=c(66725),P=c(97e3);async function EmbeddedJWK(t,r){let c={...t,...null==r?void 0:r.header};if(!(0,E.default)(c.jwk))throw new P.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let O=await (0,u.importJWK)({...c.jwk,ext:!0},c.alg,!0);if(O instanceof Uint8Array||"public"!==O.type)throw new P.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return O}r.EmbeddedJWK=EmbeddedJWK},532:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.calculateJwkThumbprintUri=r.calculateJwkThumbprint=void 0;let u=c(98838),E=c(55285),P=c(97e3),O=c(57378),J=c(66725),check=(t,r)=>{if("string"!=typeof t||!t)throw new P.JWKInvalid(`${r} missing or invalid`)};async function calculateJwkThumbprint(t,r){let c;if(!(0,J.default)(t))throw TypeError("JWK must be an object");if(null!=r||(r="sha256"),"sha256"!==r&&"sha384"!==r&&"sha512"!==r)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(t.kty){case"EC":check(t.crv,'"crv" (Curve) Parameter'),check(t.x,'"x" (X Coordinate) Parameter'),check(t.y,'"y" (Y Coordinate) Parameter'),c={crv:t.crv,kty:t.kty,x:t.x,y:t.y};break;case"OKP":check(t.crv,'"crv" (Subtype of Key Pair) Parameter'),check(t.x,'"x" (Public Key) Parameter'),c={crv:t.crv,kty:t.kty,x:t.x};break;case"RSA":check(t.e,'"e" (Exponent) Parameter'),check(t.n,'"n" (Modulus) Parameter'),c={e:t.e,kty:t.kty,n:t.n};break;case"oct":check(t.k,'"k" (Key Value) Parameter'),c={k:t.k,kty:t.kty};break;default:throw new P.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let W=O.encoder.encode(JSON.stringify(c));return(0,E.encode)(await (0,u.default)(r,W))}async function calculateJwkThumbprintUri(t,r){null!=r||(r="sha256");let c=await calculateJwkThumbprint(t,r);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${r.slice(-3)}:${c}`}r.calculateJwkThumbprint=calculateJwkThumbprint,r.calculateJwkThumbprintUri=calculateJwkThumbprintUri},90203:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createLocalJWKSet=r.LocalJWKSet=r.isJWKSLike=void 0;let u=c(22176),E=c(97e3),P=c(66725);function getKtyFromAlg(t){switch("string"==typeof t&&t.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new E.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}function isJWKSLike(t){return t&&"object"==typeof t&&Array.isArray(t.keys)&&t.keys.every(isJWKLike)}function isJWKLike(t){return(0,P.default)(t)}function clone(t){return"function"==typeof structuredClone?structuredClone(t):JSON.parse(JSON.stringify(t))}r.isJWKSLike=isJWKSLike;let LocalJWKSet=class LocalJWKSet{constructor(t){if(this._cached=new WeakMap,!isJWKSLike(t))throw new E.JWKSInvalid("JSON Web Key Set malformed");this._jwks=clone(t)}async getKey(t,r){let{alg:c,kid:u}={...t,...null==r?void 0:r.header},P=getKtyFromAlg(c),O=this._jwks.keys.filter(t=>{let r=P===t.kty;if(r&&"string"==typeof u&&(r=u===t.kid),r&&"string"==typeof t.alg&&(r=c===t.alg),r&&"string"==typeof t.use&&(r="sig"===t.use),r&&Array.isArray(t.key_ops)&&(r=t.key_ops.includes("verify")),r&&"EdDSA"===c&&(r="Ed25519"===t.crv||"Ed448"===t.crv),r)switch(c){case"ES256":r="P-256"===t.crv;break;case"ES256K":r="secp256k1"===t.crv;break;case"ES384":r="P-384"===t.crv;break;case"ES512":r="P-521"===t.crv}return r}),{0:J,length:W}=O;if(0===W)throw new E.JWKSNoMatchingKey;if(1!==W){let t=new E.JWKSMultipleMatchingKeys,{_cached:r}=this;throw t[Symbol.asyncIterator]=async function*(){for(let t of O)try{yield await importWithAlgCache(r,t,c)}catch{continue}},t}return importWithAlgCache(this._cached,J,c)}};async function importWithAlgCache(t,r,c){let P=t.get(r)||t.set(r,{}).get(r);if(void 0===P[c]){let t=await (0,u.importJWK)({...r,ext:!0},c);if(t instanceof Uint8Array||"public"!==t.type)throw new E.JWKSInvalid("JSON Web Key Set members must be public keys");P[c]=t}return P[c]}function createLocalJWKSet(t){let r=new LocalJWKSet(t);return async function(t,c){return r.getKey(t,c)}}r.LocalJWKSet=LocalJWKSet,r.createLocalJWKSet=createLocalJWKSet},67671:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createRemoteJWKSet=void 0;let u=c(22750),E=c(97e3),P=c(90203);function isCloudflareWorkers(){return"undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime}let RemoteJWKSet=class RemoteJWKSet extends P.LocalJWKSet{constructor(t,r){if(super({keys:[]}),this._jwks=void 0,!(t instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(t.href),this._options={agent:null==r?void 0:r.agent,headers:null==r?void 0:r.headers},this._timeoutDuration="number"==typeof(null==r?void 0:r.timeoutDuration)?null==r?void 0:r.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==r?void 0:r.cooldownDuration)?null==r?void 0:r.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==r?void 0:r.cacheMaxAge)?null==r?void 0:r.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(t,r){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(t,r)}catch(c){if(c instanceof E.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),super.getKey(t,r);throw c}}async reload(){this._pendingFetch&&isCloudflareWorkers()&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=(0,u.default)(this._url,this._timeoutDuration,this._options).then(t=>{if(!(0,P.isJWKSLike)(t))throw new E.JWKSInvalid("JSON Web Key Set malformed");this._jwks={keys:t.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(t=>{throw this._pendingFetch=void 0,t})),await this._pendingFetch}};function createRemoteJWKSet(t,r){let c=new RemoteJWKSet(t,r);return async function(t,r){return c.getKey(t,r)}}r.createRemoteJWKSet=createRemoteJWKSet},46177:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CompactSign=void 0;let u=c(34856);let CompactSign=class CompactSign{constructor(t){this._flattened=new u.FlattenedSign(t)}setProtectedHeader(t){return this._flattened.setProtectedHeader(t),this}async sign(t,r){let c=await this._flattened.sign(t,r);if(void 0===c.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${c.protected}.${c.payload}.${c.signature}`}};r.CompactSign=CompactSign},12133:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.compactVerify=void 0;let u=c(36557),E=c(97e3),P=c(57378);async function compactVerify(t,r,c){if(t instanceof Uint8Array&&(t=P.decoder.decode(t)),"string"!=typeof t)throw new E.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:O,1:J,2:W,length:K}=t.split(".");if(3!==K)throw new E.JWSInvalid("Invalid Compact JWS");let R=await (0,u.flattenedVerify)({payload:J,protected:O,signature:W},r,c),U={payload:R.payload,protectedHeader:R.protectedHeader};return"function"==typeof r?{...U,key:R.key}:U}r.compactVerify=compactVerify},34856:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FlattenedSign=void 0;let u=c(55285),E=c(34840),P=c(36905),O=c(97e3),J=c(57378),W=c(46099),K=c(75817);let FlattenedSign=class FlattenedSign{constructor(t){if(!(t instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=t}setProtectedHeader(t){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setUnprotectedHeader(t){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}async sign(t,r){let c;if(!this._protectedHeader&&!this._unprotectedHeader)throw new O.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,P.default)(this._protectedHeader,this._unprotectedHeader))throw new O.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let R={...this._protectedHeader,...this._unprotectedHeader},U=(0,K.default)(O.JWSInvalid,new Map([["b64",!0]]),null==r?void 0:r.crit,this._protectedHeader,R),D=!0;if(U.has("b64")&&"boolean"!=typeof(D=this._protectedHeader.b64))throw new O.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:B}=R;if("string"!=typeof B||!B)throw new O.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,W.default)(B,t,"sign");let F=this._payload;D&&(F=J.encoder.encode((0,u.encode)(F))),c=this._protectedHeader?J.encoder.encode((0,u.encode)(JSON.stringify(this._protectedHeader))):J.encoder.encode("");let q=(0,J.concat)(c,J.encoder.encode("."),F),G=await (0,E.default)(B,t,q),V={signature:(0,u.encode)(G),payload:""};return D&&(V.payload=J.decoder.decode(F)),this._unprotectedHeader&&(V.header=this._unprotectedHeader),this._protectedHeader&&(V.protected=J.decoder.decode(c)),V}};r.FlattenedSign=FlattenedSign},36557:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.flattenedVerify=void 0;let u=c(55285),E=c(98291),P=c(97e3),O=c(57378),J=c(36905),W=c(66725),K=c(46099),R=c(75817),U=c(67747);async function flattenedVerify(t,r,c){var D;let B,F;if(!(0,W.default)(t))throw new P.JWSInvalid("Flattened JWS must be an object");if(void 0===t.protected&&void 0===t.header)throw new P.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==t.protected&&"string"!=typeof t.protected)throw new P.JWSInvalid("JWS Protected Header incorrect type");if(void 0===t.payload)throw new P.JWSInvalid("JWS Payload missing");if("string"!=typeof t.signature)throw new P.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==t.header&&!(0,W.default)(t.header))throw new P.JWSInvalid("JWS Unprotected Header incorrect type");let q={};if(t.protected)try{let r=(0,u.decode)(t.protected);q=JSON.parse(O.decoder.decode(r))}catch{throw new P.JWSInvalid("JWS Protected Header is invalid")}if(!(0,J.default)(q,t.header))throw new P.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let G={...q,...t.header},V=(0,R.default)(P.JWSInvalid,new Map([["b64",!0]]),null==c?void 0:c.crit,q,G),X=!0;if(V.has("b64")&&"boolean"!=typeof(X=q.b64))throw new P.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:Y}=G;if("string"!=typeof Y||!Y)throw new P.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let Z=c&&(0,U.default)("algorithms",c.algorithms);if(Z&&!Z.has(Y))throw new P.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(X){if("string"!=typeof t.payload)throw new P.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof t.payload&&!(t.payload instanceof Uint8Array))throw new P.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let Q=!1;"function"==typeof r&&(r=await r(q,t),Q=!0),(0,K.default)(Y,r,"verify");let ee=(0,O.concat)(O.encoder.encode(null!==(D=t.protected)&&void 0!==D?D:""),O.encoder.encode("."),"string"==typeof t.payload?O.encoder.encode(t.payload):t.payload);try{B=(0,u.decode)(t.signature)}catch{throw new P.JWSInvalid("Failed to base64url decode the signature")}let et=await (0,E.default)(Y,r,B,ee);if(!et)throw new P.JWSSignatureVerificationFailed;if(X)try{F=(0,u.decode)(t.payload)}catch{throw new P.JWSInvalid("Failed to base64url decode the payload")}else F="string"==typeof t.payload?O.encoder.encode(t.payload):t.payload;let er={payload:F};return(void 0!==t.protected&&(er.protectedHeader=q),void 0!==t.header&&(er.unprotectedHeader=t.header),Q)?{...er,key:r}:er}r.flattenedVerify=flattenedVerify},21863:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GeneralSign=void 0;let u=c(34856),E=c(97e3);let IndividualSignature=class IndividualSignature{constructor(t,r,c){this.parent=t,this.key=r,this.options=c}setProtectedHeader(t){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=t,this}setUnprotectedHeader(t){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=t,this}addSignature(...t){return this.parent.addSignature(...t)}sign(...t){return this.parent.sign(...t)}done(){return this.parent}};let GeneralSign=class GeneralSign{constructor(t){this._signatures=[],this._payload=t}addSignature(t,r){let c=new IndividualSignature(this,t,r);return this._signatures.push(c),c}async sign(){if(!this._signatures.length)throw new E.JWSInvalid("at least one signature must be added");let t={signatures:[],payload:""};for(let r=0;r<this._signatures.length;r++){let c=this._signatures[r],P=new u.FlattenedSign(this._payload);P.setProtectedHeader(c.protectedHeader),P.setUnprotectedHeader(c.unprotectedHeader);let{payload:O,...J}=await P.sign(c.key,c.options);if(0===r)t.payload=O;else if(t.payload!==O)throw new E.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");t.signatures.push(J)}return t}};r.GeneralSign=GeneralSign},98990:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generalVerify=void 0;let u=c(36557),E=c(97e3),P=c(66725);async function generalVerify(t,r,c){if(!(0,P.default)(t))throw new E.JWSInvalid("General JWS must be an object");if(!Array.isArray(t.signatures)||!t.signatures.every(P.default))throw new E.JWSInvalid("JWS Signatures missing or incorrect type");for(let E of t.signatures)try{return await (0,u.flattenedVerify)({header:E.header,payload:t.payload,protected:E.protected,signature:E.signature},r,c)}catch{}throw new E.JWSSignatureVerificationFailed}r.generalVerify=generalVerify},73297:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.jwtDecrypt=void 0;let u=c(32337),E=c(46495),P=c(97e3);async function jwtDecrypt(t,r,c){let O=await (0,u.compactDecrypt)(t,r,c),J=(0,E.default)(O.protectedHeader,O.plaintext,c),{protectedHeader:W}=O;if(void 0!==W.iss&&W.iss!==J.iss)throw new P.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==W.sub&&W.sub!==J.sub)throw new P.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==W.aud&&JSON.stringify(W.aud)!==JSON.stringify(J.aud))throw new P.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',"aud","mismatch");let K={payload:J,protectedHeader:W};return"function"==typeof r?{...K,key:O.key}:K}r.jwtDecrypt=jwtDecrypt},91264:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EncryptJWT=void 0;let u=c(48118),E=c(57378),P=c(73288);let EncryptJWT=class EncryptJWT extends P.ProduceJWT{setProtectedHeader(t){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setKeyManagementParameters(t){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=t,this}setContentEncryptionKey(t){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=t,this}setInitializationVector(t){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=t,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(t,r){let c=new u.CompactEncrypt(E.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),c.setProtectedHeader(this._protectedHeader),this._iv&&c.setInitializationVector(this._iv),this._cek&&c.setContentEncryptionKey(this._cek),this._keyManagementParameters&&c.setKeyManagementParameters(this._keyManagementParameters),c.encrypt(t,r)}};r.EncryptJWT=EncryptJWT},73288:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ProduceJWT=void 0;let u=c(20283),E=c(66725),P=c(96751);let ProduceJWT=class ProduceJWT{constructor(t){if(!(0,E.default)(t))throw TypeError("JWT Claims Set MUST be an object");this._payload=t}setIssuer(t){return this._payload={...this._payload,iss:t},this}setSubject(t){return this._payload={...this._payload,sub:t},this}setAudience(t){return this._payload={...this._payload,aud:t},this}setJti(t){return this._payload={...this._payload,jti:t},this}setNotBefore(t){return"number"==typeof t?this._payload={...this._payload,nbf:t}:this._payload={...this._payload,nbf:(0,u.default)(new Date)+(0,P.default)(t)},this}setExpirationTime(t){return"number"==typeof t?this._payload={...this._payload,exp:t}:this._payload={...this._payload,exp:(0,u.default)(new Date)+(0,P.default)(t)},this}setIssuedAt(t){return void 0===t?this._payload={...this._payload,iat:(0,u.default)(new Date)}:this._payload={...this._payload,iat:t},this}};r.ProduceJWT=ProduceJWT},3637:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SignJWT=void 0;let u=c(46177),E=c(97e3),P=c(57378),O=c(73288);let SignJWT=class SignJWT extends O.ProduceJWT{setProtectedHeader(t){return this._protectedHeader=t,this}async sign(t,r){var c;let O=new u.CompactSign(P.encoder.encode(JSON.stringify(this._payload)));if(O.setProtectedHeader(this._protectedHeader),Array.isArray(null===(c=this._protectedHeader)||void 0===c?void 0:c.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new E.JWTInvalid("JWTs MUST NOT use unencoded payload");return O.sign(t,r)}};r.SignJWT=SignJWT},88888:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.UnsecuredJWT=void 0;let u=c(55285),E=c(57378),P=c(97e3),O=c(46495),J=c(73288);let UnsecuredJWT=class UnsecuredJWT extends J.ProduceJWT{encode(){let t=u.encode(JSON.stringify({alg:"none"})),r=u.encode(JSON.stringify(this._payload));return`${t}.${r}.`}static decode(t,r){let c;if("string"!=typeof t)throw new P.JWTInvalid("Unsecured JWT must be a string");let{0:J,1:W,2:K,length:R}=t.split(".");if(3!==R||""!==K)throw new P.JWTInvalid("Invalid Unsecured JWT");try{if(c=JSON.parse(E.decoder.decode(u.decode(J))),"none"!==c.alg)throw Error()}catch{throw new P.JWTInvalid("Invalid Unsecured JWT")}let U=(0,O.default)(c,u.decode(W),r);return{payload:U,header:c}}};r.UnsecuredJWT=UnsecuredJWT},37063:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.jwtVerify=void 0;let u=c(12133),E=c(46495),P=c(97e3);async function jwtVerify(t,r,c){var O;let J=await (0,u.compactVerify)(t,r,c);if((null===(O=J.protectedHeader.crit)||void 0===O?void 0:O.includes("b64"))&&!1===J.protectedHeader.b64)throw new P.JWTInvalid("JWTs MUST NOT use unencoded payload");let W=(0,E.default)(J.protectedHeader,J.payload,c),K={payload:W,protectedHeader:J.protectedHeader};return"function"==typeof r?{...K,key:J.key}:K}r.jwtVerify=jwtVerify},87162:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.exportJWK=r.exportPKCS8=r.exportSPKI=void 0;let u=c(89760),E=c(89760),P=c(19355);async function exportSPKI(t){return(0,u.toSPKI)(t)}async function exportPKCS8(t){return(0,E.toPKCS8)(t)}async function exportJWK(t){return(0,P.default)(t)}r.exportSPKI=exportSPKI,r.exportPKCS8=exportPKCS8,r.exportJWK=exportJWK},41856:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateKeyPair=void 0;let u=c(28418);async function generateKeyPair(t,r){return(0,u.generateKeyPair)(t,r)}r.generateKeyPair=generateKeyPair},53471:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateSecret=void 0;let u=c(28418);async function generateSecret(t,r){return(0,u.generateSecret)(t,r)}r.generateSecret=generateSecret},22176:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.importJWK=r.importPKCS8=r.importX509=r.importSPKI=void 0;let u=c(55285),E=c(89760),P=c(31776),O=c(97e3),J=c(66725);async function importSPKI(t,r,c){if("string"!=typeof t||0!==t.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,E.fromSPKI)(t,r,c)}async function importX509(t,r,c){if("string"!=typeof t||0!==t.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,E.fromX509)(t,r,c)}async function importPKCS8(t,r,c){if("string"!=typeof t||0!==t.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,E.fromPKCS8)(t,r,c)}async function importJWK(t,r,c){var E;if(!(0,J.default)(t))throw TypeError("JWK must be an object");switch(r||(r=t.alg),t.kty){case"oct":if("string"!=typeof t.k||!t.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=c||(c=!0!==t.ext),c)return(0,P.default)({...t,alg:r,ext:null!==(E=t.ext)&&void 0!==E&&E});return(0,u.decode)(t.k);case"RSA":if(void 0!==t.oth)throw new O.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return(0,P.default)({...t,alg:r});default:throw new O.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}r.importSPKI=importSPKI,r.importX509=importX509,r.importPKCS8=importPKCS8,r.importJWK=importJWK},72173:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.unwrap=r.wrap=void 0;let u=c(4868),E=c(54637),P=c(82759),O=c(55285);async function wrap(t,r,c,E){let J=t.slice(0,7);E||(E=(0,P.default)(J));let{ciphertext:W,tag:K}=await (0,u.default)(J,c,r,E,new Uint8Array(0));return{encryptedKey:W,iv:(0,O.encode)(E),tag:(0,O.encode)(K)}}async function unwrap(t,r,c,u,P){let O=t.slice(0,7);return(0,E.default)(O,r,c,u,P,new Uint8Array(0))}r.wrap=wrap,r.unwrap=unwrap},57378:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.concatKdf=r.lengthAndInput=r.uint32be=r.uint64be=r.p2s=r.concat=r.decoder=r.encoder=void 0;let u=c(98838);function concat(...t){let r=t.reduce((t,{length:r})=>t+r,0),c=new Uint8Array(r),u=0;return t.forEach(t=>{c.set(t,u),u+=t.length}),c}function p2s(t,c){return concat(r.encoder.encode(t),new Uint8Array([0]),c)}function writeUInt32BE(t,r,c){if(r<0||r>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967296-1}. Received ${r}`);t.set([r>>>24,r>>>16,r>>>8,255&r],c)}function uint64be(t){let r=new Uint8Array(8);return writeUInt32BE(r,Math.floor(t/4294967296),0),writeUInt32BE(r,t%4294967296,4),r}function uint32be(t){let r=new Uint8Array(4);return writeUInt32BE(r,t),r}function lengthAndInput(t){return concat(uint32be(t.length),t)}async function concatKdf(t,r,c){let E=Math.ceil((r>>3)/32),P=new Uint8Array(32*E);for(let r=0;r<E;r++){let E=new Uint8Array(4+t.length+c.length);E.set(uint32be(r+1)),E.set(t,4),E.set(c,4+t.length),P.set(await (0,u.default)("sha256",E),32*r)}return P.slice(0,r>>3)}r.encoder=new TextEncoder,r.decoder=new TextDecoder,r.concat=concat,r.p2s=p2s,r.uint64be=uint64be,r.uint32be=uint32be,r.lengthAndInput=lengthAndInput,r.concatKdf=concatKdf},20284:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.bitLength=void 0;let u=c(97e3),E=c(7439);function bitLength(t){switch(t){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new u.JOSENotSupported(`Unsupported JWE Algorithm: ${t}`)}}r.bitLength=bitLength,r.default=t=>(0,E.default)(new Uint8Array(bitLength(t)>>3))},16461:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(97e3),E=c(82759);r.default=(t,r)=>{if(r.length<<3!==(0,E.bitLength)(t))throw new u.JWEInvalid("Invalid Initialization Vector length")}},46099:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(18936),E=c(63514),symmetricTypeCheck=(t,r)=>{if(!(r instanceof Uint8Array)){if(!(0,E.default)(r))throw TypeError((0,u.withAlg)(t,r,...E.types,"Uint8Array"));if("secret"!==r.type)throw TypeError(`${E.types.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},asymmetricTypeCheck=(t,r,c)=>{if(!(0,E.default)(r))throw TypeError((0,u.withAlg)(t,r,...E.types));if("secret"===r.type)throw TypeError(`${E.types.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===c&&"public"===r.type)throw TypeError(`${E.types.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===c&&"public"===r.type)throw TypeError(`${E.types.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(r.algorithm&&"verify"===c&&"private"===r.type)throw TypeError(`${E.types.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(r.algorithm&&"encrypt"===c&&"private"===r.type)throw TypeError(`${E.types.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)};r.default=(t,r,c)=>{let u=t.startsWith("HS")||"dir"===t||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t);u?symmetricTypeCheck(t,r):asymmetricTypeCheck(t,r,c)}},96716:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(97e3);function checkP2s(t){if(!(t instanceof Uint8Array)||t.length<8)throw new u.JWEInvalid("PBES2 Salt Input must be 8 or more octets")}r.default=checkP2s},60030:(t,r)=>{"use strict";function unusable(t,r="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${r} must be ${t}`)}function isAlgorithm(t,r){return t.name===r}function getHashLength(t){return parseInt(t.name.slice(4),10)}function getNamedCurve(t){switch(t){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}function checkUsage(t,r){if(r.length&&!r.some(r=>t.usages.includes(r))){let t="CryptoKey does not support this operation, its usages must include ";if(r.length>2){let c=r.pop();t+=`one of ${r.join(", ")}, or ${c}.`}else 2===r.length?t+=`one of ${r[0]} or ${r[1]}.`:t+=`${r[0]}.`;throw TypeError(t)}}function checkSigCryptoKey(t,r,...c){switch(r){case"HS256":case"HS384":case"HS512":{if(!isAlgorithm(t.algorithm,"HMAC"))throw unusable("HMAC");let c=parseInt(r.slice(2),10),u=getHashLength(t.algorithm.hash);if(u!==c)throw unusable(`SHA-${c}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!isAlgorithm(t.algorithm,"RSASSA-PKCS1-v1_5"))throw unusable("RSASSA-PKCS1-v1_5");let c=parseInt(r.slice(2),10),u=getHashLength(t.algorithm.hash);if(u!==c)throw unusable(`SHA-${c}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!isAlgorithm(t.algorithm,"RSA-PSS"))throw unusable("RSA-PSS");let c=parseInt(r.slice(2),10),u=getHashLength(t.algorithm.hash);if(u!==c)throw unusable(`SHA-${c}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==t.algorithm.name&&"Ed448"!==t.algorithm.name)throw unusable("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!isAlgorithm(t.algorithm,"ECDSA"))throw unusable("ECDSA");let c=getNamedCurve(r),u=t.algorithm.namedCurve;if(u!==c)throw unusable(c,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}checkUsage(t,c)}function checkEncCryptoKey(t,r,...c){switch(r){case"A128GCM":case"A192GCM":case"A256GCM":{if(!isAlgorithm(t.algorithm,"AES-GCM"))throw unusable("AES-GCM");let c=parseInt(r.slice(1,4),10),u=t.algorithm.length;if(u!==c)throw unusable(c,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!isAlgorithm(t.algorithm,"AES-KW"))throw unusable("AES-KW");let c=parseInt(r.slice(1,4),10),u=t.algorithm.length;if(u!==c)throw unusable(c,"algorithm.length");break}case"ECDH":switch(t.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw unusable("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!isAlgorithm(t.algorithm,"PBKDF2"))throw unusable("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!isAlgorithm(t.algorithm,"RSA-OAEP"))throw unusable("RSA-OAEP");let c=parseInt(r.slice(9),10)||1,u=getHashLength(t.algorithm.hash);if(u!==c)throw unusable(`SHA-${c}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}checkUsage(t,c)}Object.defineProperty(r,"__esModule",{value:!0}),r.checkEncCryptoKey=r.checkSigCryptoKey=void 0,r.checkSigCryptoKey=checkSigCryptoKey,r.checkEncCryptoKey=checkEncCryptoKey},88484:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(59900),E=c(21230),P=c(11966),O=c(41059),J=c(55285),W=c(97e3),K=c(20284),R=c(22176),U=c(46099),D=c(66725),B=c(72173);async function decryptKeyManagement(t,r,c,F,q){switch((0,U.default)(t,r,"decrypt"),t){case"dir":if(void 0!==c)throw new W.JWEInvalid("Encountered unexpected JWE Encrypted Key");return r;case"ECDH-ES":if(void 0!==c)throw new W.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let P,O;if(!(0,D.default)(F.epk))throw new W.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!E.ecdhAllowed(r))throw new W.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let U=await (0,R.importJWK)(F.epk,t);if(void 0!==F.apu){if("string"!=typeof F.apu)throw new W.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{P=(0,J.decode)(F.apu)}catch{throw new W.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==F.apv){if("string"!=typeof F.apv)throw new W.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{O=(0,J.decode)(F.apv)}catch{throw new W.JWEInvalid("Failed to base64url decode the apv")}}let B=await E.deriveKey(U,r,"ECDH-ES"===t?F.enc:t,"ECDH-ES"===t?(0,K.bitLength)(F.enc):parseInt(t.slice(-5,-2),10),P,O);if("ECDH-ES"===t)return B;if(void 0===c)throw new W.JWEInvalid("JWE Encrypted Key missing");return(0,u.unwrap)(t.slice(-6),B,c)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===c)throw new W.JWEInvalid("JWE Encrypted Key missing");return(0,O.decrypt)(t,r,c);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let u;if(void 0===c)throw new W.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof F.p2c)throw new W.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let E=(null==q?void 0:q.maxPBES2Count)||1e4;if(F.p2c>E)throw new W.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof F.p2s)throw new W.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{u=(0,J.decode)(F.p2s)}catch{throw new W.JWEInvalid("Failed to base64url decode the p2s")}return(0,P.decrypt)(t,r,c,F.p2c,u)}case"A128KW":case"A192KW":case"A256KW":if(void 0===c)throw new W.JWEInvalid("JWE Encrypted Key missing");return(0,u.unwrap)(t,r,c);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let u,E;if(void 0===c)throw new W.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof F.iv)throw new W.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof F.tag)throw new W.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{u=(0,J.decode)(F.iv)}catch{throw new W.JWEInvalid("Failed to base64url decode the iv")}try{E=(0,J.decode)(F.tag)}catch{throw new W.JWEInvalid("Failed to base64url decode the tag")}return(0,B.unwrap)(t,r,c,u,E)}default:throw new W.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}r.default=decryptKeyManagement},92235:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(59900),E=c(21230),P=c(11966),O=c(41059),J=c(55285),W=c(20284),K=c(97e3),R=c(87162),U=c(46099),D=c(72173);async function encryptKeyManagement(t,r,c,B,F={}){let q,G,V;switch((0,U.default)(t,c,"encrypt"),t){case"dir":V=c;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!E.ecdhAllowed(c))throw new K.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:P,apv:O}=F,{epk:U}=F;U||(U=(await E.generateEpk(c)).privateKey);let{x:D,y:X,crv:Y,kty:Z}=await (0,R.exportJWK)(U),Q=await E.deriveKey(c,U,"ECDH-ES"===t?r:t,"ECDH-ES"===t?(0,W.bitLength)(r):parseInt(t.slice(-5,-2),10),P,O);if(G={epk:{x:D,crv:Y,kty:Z}},"EC"===Z&&(G.epk.y=X),P&&(G.apu=(0,J.encode)(P)),O&&(G.apv=(0,J.encode)(O)),"ECDH-ES"===t){V=Q;break}V=B||(0,W.default)(r);let ee=t.slice(-6);q=await (0,u.wrap)(ee,Q,V);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":V=B||(0,W.default)(r),q=await (0,O.encrypt)(t,c,V);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{V=B||(0,W.default)(r);let{p2c:u,p2s:E}=F;({encryptedKey:q,...G}=await (0,P.encrypt)(t,c,V,u,E));break}case"A128KW":case"A192KW":case"A256KW":V=B||(0,W.default)(r),q=await (0,u.wrap)(t,c,V);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{V=B||(0,W.default)(r);let{iv:u}=F;({encryptedKey:q,...G}=await (0,D.wrap)(t,c,V,u));break}default:throw new K.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:V,encryptedKey:q,parameters:G}}r.default=encryptKeyManagement},20283:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=t=>Math.floor(t.getTime()/1e3)},18936:(t,r)=>{"use strict";function message(t,r,...c){if(c.length>2){let r=c.pop();t+=`one of type ${c.join(", ")}, or ${r}.`}else 2===c.length?t+=`one of type ${c[0]} or ${c[1]}.`:t+=`of type ${c[0]}.`;return null==r?t+=` Received ${r}`:"function"==typeof r&&r.name?t+=` Received function ${r.name}`:"object"==typeof r&&null!=r&&r.constructor&&r.constructor.name&&(t+=` Received an instance of ${r.constructor.name}`),t}function withAlg(t,r,...c){return message(`Key for the ${t} algorithm must be `,r,...c)}Object.defineProperty(r,"__esModule",{value:!0}),r.withAlg=void 0,r.default=(t,...r)=>message("Key must be ",t,...r),r.withAlg=withAlg},36905:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=(...t)=>{let r;let c=t.filter(Boolean);if(0===c.length||1===c.length)return!0;for(let t of c){let c=Object.keys(t);if(!r||0===r.size){r=new Set(c);continue}for(let t of c){if(r.has(t))return!1;r.add(t)}}return!0}},66725:(t,r)=>{"use strict";function isObjectLike(t){return"object"==typeof t&&null!==t}function isObject(t){if(!isObjectLike(t)||"[object Object]"!==Object.prototype.toString.call(t))return!1;if(null===Object.getPrototypeOf(t))return!0;let r=t;for(;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(t)===r}Object.defineProperty(r,"__esModule",{value:!0}),r.default=isObject},82759:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.bitLength=void 0;let u=c(97e3),E=c(7439);function bitLength(t){switch(t){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new u.JOSENotSupported(`Unsupported JWE Algorithm: ${t}`)}}r.bitLength=bitLength,r.default=t=>(0,E.default)(new Uint8Array(bitLength(t)>>3))},46495:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(97e3),E=c(57378),P=c(20283),O=c(96751),J=c(66725),normalizeTyp=t=>t.toLowerCase().replace(/^application\//,""),checkAudiencePresence=(t,r)=>"string"==typeof t?r.includes(t):!!Array.isArray(t)&&r.some(Set.prototype.has.bind(new Set(t)));r.default=(t,r,c={})=>{let W,K;let{typ:R}=c;if(R&&("string"!=typeof t.typ||normalizeTyp(t.typ)!==normalizeTyp(R)))throw new u.JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");try{W=JSON.parse(E.decoder.decode(r))}catch{}if(!(0,J.default)(W))throw new u.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims:U=[],issuer:D,subject:B,audience:F,maxTokenAge:q}=c;for(let t of(void 0!==q&&U.push("iat"),void 0!==F&&U.push("aud"),void 0!==B&&U.push("sub"),void 0!==D&&U.push("iss"),new Set(U.reverse())))if(!(t in W))throw new u.JWTClaimValidationFailed(`missing required "${t}" claim`,t,"missing");if(D&&!(Array.isArray(D)?D:[D]).includes(W.iss))throw new u.JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(B&&W.sub!==B)throw new u.JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(F&&!checkAudiencePresence(W.aud,"string"==typeof F?[F]:F))throw new u.JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");switch(typeof c.clockTolerance){case"string":K=(0,O.default)(c.clockTolerance);break;case"number":K=c.clockTolerance;break;case"undefined":K=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:G}=c,V=(0,P.default)(G||new Date);if((void 0!==W.iat||q)&&"number"!=typeof W.iat)throw new u.JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(void 0!==W.nbf){if("number"!=typeof W.nbf)throw new u.JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(W.nbf>V+K)throw new u.JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==W.exp){if("number"!=typeof W.exp)throw new u.JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(W.exp<=V-K)throw new u.JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(q){let t=V-W.iat,r="number"==typeof q?q:(0,O.default)(q);if(t-K>r)throw new u.JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(t<0-K)throw new u.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return W}},96751:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let c=604800,u=31557600,E=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;r.default=t=>{let r=E.exec(t);if(!r)throw TypeError("Invalid time period format");let P=parseFloat(r[1]),O=r[2].toLowerCase();switch(O){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(P);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*P);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*P);case"day":case"days":case"d":return Math.round(86400*P);case"week":case"weeks":case"w":return Math.round(P*c);default:return Math.round(P*u)}}},67747:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=(t,r)=>{if(void 0!==r&&(!Array.isArray(r)||r.some(t=>"string"!=typeof t)))throw TypeError(`"${t}" option must be an array of strings`);if(r)return new Set(r)}},75817:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(97e3);function validateCrit(t,r,c,E,P){let O;if(void 0!==P.crit&&void 0===E.crit)throw new t('"crit" (Critical) Header Parameter MUST be integrity protected');if(!E||void 0===E.crit)return new Set;if(!Array.isArray(E.crit)||0===E.crit.length||E.crit.some(t=>"string"!=typeof t||0===t.length))throw new t('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let J of(O=void 0!==c?new Map([...Object.entries(c),...r.entries()]):r,E.crit)){if(!O.has(J))throw new u.JOSENotSupported(`Extension Header Parameter "${J}" is not recognized`);if(void 0===P[J])throw new t(`Extension Header Parameter "${J}" is missing`);if(O.get(J)&&void 0===E[J])throw new t(`Extension Header Parameter "${J}" MUST be integrity protected`)}return new Set(E.crit)}r.default=validateCrit},59900:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.unwrap=r.wrap=void 0;let u=c(14300),E=c(6113),P=c(97e3),O=c(57378),J=c(23462),W=c(60030),K=c(55552),R=c(18936),U=c(25665),D=c(63514);function checkKeySize(t,r){if(t.symmetricKeySize<<3!==parseInt(r.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${r}`)}function ensureKeyObject(t,r,c){if((0,K.default)(t))return t;if(t instanceof Uint8Array)return(0,E.createSecretKey)(t);if((0,J.isCryptoKey)(t))return(0,W.checkEncCryptoKey)(t,r,c),E.KeyObject.from(t);throw TypeError((0,R.default)(t,...D.types,"Uint8Array"))}r.wrap=(t,r,c)=>{let J=parseInt(t.slice(1,4),10),W=`aes${J}-wrap`;if(!(0,U.default)(W))throw new P.JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`);let K=ensureKeyObject(r,t,"wrapKey");checkKeySize(K,t);let R=(0,E.createCipheriv)(W,K,u.Buffer.alloc(8,166));return(0,O.concat)(R.update(c),R.final())},r.unwrap=(t,r,c)=>{let J=parseInt(t.slice(1,4),10),W=`aes${J}-wrap`;if(!(0,U.default)(W))throw new P.JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`);let K=ensureKeyObject(r,t,"unwrapKey");checkKeySize(K,t);let R=(0,E.createDecipheriv)(W,K,u.Buffer.alloc(8,166));return(0,O.concat)(R.update(c),R.final())}},89760:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromX509=r.fromSPKI=r.fromPKCS8=r.toPKCS8=r.toSPKI=void 0;let u=c(6113),E=c(14300),P=c(23462),O=c(55552),J=c(18936),W=c(63514),genericExport=(t,r,c)=>{let E;if((0,P.isCryptoKey)(c)){if(!c.extractable)throw TypeError("CryptoKey is not extractable");E=u.KeyObject.from(c)}else if((0,O.default)(c))E=c;else throw TypeError((0,J.default)(c,...W.types));if(E.type!==t)throw TypeError(`key is not a ${t} key`);return E.export({format:"pem",type:r})};r.toSPKI=t=>genericExport("public","spki",t),r.toPKCS8=t=>genericExport("private","pkcs8",t),r.fromPKCS8=t=>(0,u.createPrivateKey)({key:E.Buffer.from(t.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""),"base64"),type:"pkcs8",format:"der"}),r.fromSPKI=t=>(0,u.createPublicKey)({key:E.Buffer.from(t.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""),"base64"),type:"spki",format:"der"}),r.fromX509=t=>(0,u.createPublicKey)({key:t,type:"spki",format:"pem"})},23670:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let Asn1SequenceDecoder=class Asn1SequenceDecoder{constructor(t){if(48!==t[0])throw TypeError();this.buffer=t,this.offset=1;let r=this.decodeLength();if(r!==t.length-this.offset)throw TypeError()}decodeLength(){let t=this.buffer[this.offset++];if(128&t){let r=-129&t;t=0;for(let c=0;c<r;c++)t=t<<8|this.buffer[this.offset+c];this.offset+=r}return t}unsignedInteger(){if(2!==this.buffer[this.offset++])throw TypeError();let t=this.decodeLength();0===this.buffer[this.offset]&&(this.offset++,t--);let r=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,r}end(){if(this.offset!==this.buffer.length)throw TypeError()}};r.default=Asn1SequenceDecoder},97578:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(14300),E=c(97e3),P=u.Buffer.from([0]),O=u.Buffer.from([2]),J=u.Buffer.from([3]),W=u.Buffer.from([48]),K=u.Buffer.from([4]),encodeLength=t=>{if(t<128)return u.Buffer.from([t]);let r=u.Buffer.alloc(5);r.writeUInt32BE(t,1);let c=1;for(;0===r[c];)c++;return r[c-1]=128|5-c,r.slice(c-1)},R=new Map([["P-256",u.Buffer.from("06 08 2A 86 48 CE 3D 03 01 07".replace(/ /g,""),"hex")],["secp256k1",u.Buffer.from("06 05 2B 81 04 00 0A".replace(/ /g,""),"hex")],["P-384",u.Buffer.from("06 05 2B 81 04 00 22".replace(/ /g,""),"hex")],["P-521",u.Buffer.from("06 05 2B 81 04 00 23".replace(/ /g,""),"hex")],["ecPublicKey",u.Buffer.from("06 07 2A 86 48 CE 3D 02 01".replace(/ /g,""),"hex")],["X25519",u.Buffer.from("06 03 2B 65 6E".replace(/ /g,""),"hex")],["X448",u.Buffer.from("06 03 2B 65 6F".replace(/ /g,""),"hex")],["Ed25519",u.Buffer.from("06 03 2B 65 70".replace(/ /g,""),"hex")],["Ed448",u.Buffer.from("06 03 2B 65 71".replace(/ /g,""),"hex")]]);let DumbAsn1Encoder=class DumbAsn1Encoder{constructor(){this.length=0,this.elements=[]}oidFor(t){let r=R.get(t);if(!r)throw new E.JOSENotSupported("Invalid or unsupported OID");this.elements.push(r),this.length+=r.length}zero(){this.elements.push(O,u.Buffer.from([1]),P),this.length+=3}one(){this.elements.push(O,u.Buffer.from([1]),u.Buffer.from([1])),this.length+=3}unsignedInteger(t){if(128&t[0]){let r=encodeLength(t.length+1);this.elements.push(O,r,P,t),this.length+=2+r.length+t.length}else{let r=0;for(;0===t[r]&&(128&t[r+1])==0;)r++;let c=encodeLength(t.length-r);this.elements.push(O,encodeLength(t.length-r),t.slice(r)),this.length+=1+c.length+t.length-r}}octStr(t){let r=encodeLength(t.length);this.elements.push(K,encodeLength(t.length),t),this.length+=1+r.length+t.length}bitStr(t){let r=encodeLength(t.length+1);this.elements.push(J,encodeLength(t.length+1),P,t),this.length+=1+r.length+t.length+1}add(t){this.elements.push(t),this.length+=t.length}end(t=W){let r=encodeLength(this.length);return u.Buffer.concat([t,r,...this.elements],1+r.length+this.length)}};r.default=DumbAsn1Encoder},55285:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decode=r.encode=r.encodeBase64=r.decodeBase64=void 0;let u=c(14300),E=c(57378);function normalize(t){let r=t;return r instanceof Uint8Array&&(r=E.decoder.decode(r)),r}u.Buffer.isEncoding("base64url")?r.encode=t=>u.Buffer.from(t).toString("base64url"):r.encode=t=>u.Buffer.from(t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),r.decodeBase64=t=>u.Buffer.from(t,"base64"),r.encodeBase64=t=>u.Buffer.from(t).toString("base64"),r.decode=t=>u.Buffer.from(normalize(t),"base64")},58451:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(57378);function cbcTag(t,r,c,P,O,J){let W=(0,E.concat)(t,r,c,(0,E.uint64be)(t.length<<3)),K=(0,u.createHmac)(`sha${P}`,O);return K.update(W),K.digest().slice(0,J>>3)}r.default=cbcTag},95830:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(97e3),E=c(55552);r.default=(t,r)=>{let c;switch(t){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(t.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(t.slice(1,4),10);break;default:throw new u.JOSENotSupported(`Content Encryption Algorithm ${t} is not supported either by JOSE or your javascript runtime`)}if(r instanceof Uint8Array){let t=r.byteLength<<3;if(t!==c)throw new u.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${t} bits`);return}if((0,E.default)(r)&&"secret"===r.type){let t=r.symmetricKeySize<<3;if(t!==c)throw new u.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${t} bits`);return}throw TypeError("Invalid Content Encryption Key type")}},21056:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setModulusLength=r.weakMap=void 0,r.weakMap=new WeakMap;let getLength=(t,r)=>{let c=t.readUInt8(1);if((128&c)==0)return 0===r?c:getLength(t.subarray(2+c),r-1);let u=127&c;c=0;for(let r=0;r<u;r++){c<<=8;let u=t.readUInt8(2+r);c|=u}return 0===r?c:getLength(t.subarray(2+c),r-1)},getLengthOfSeqIndex=(t,r)=>{let c=t.readUInt8(1);return(128&c)==0?getLength(t.subarray(2),r):getLength(t.subarray(2+(127&c)),r)},getModulusLength=t=>{var c,u;if(r.weakMap.has(t))return r.weakMap.get(t);let E=null!==(u=null===(c=t.asymmetricKeyDetails)||void 0===c?void 0:c.modulusLength)&&void 0!==u?u:getLengthOfSeqIndex(t.export({format:"der",type:"pkcs1"}),"private"===t.type?1:0)-1<<3;return r.weakMap.set(t,E),E};r.setModulusLength=(t,c)=>{r.weakMap.set(t,c)},r.default=(t,r)=>{if(2048>getModulusLength(t))throw TypeError(`${r} requires key modulusLength to be 2048 bits or larger`)}},25665:(t,r,c)=>{"use strict";let u;Object.defineProperty(r,"__esModule",{value:!0});let E=c(6113);r.default=t=>(u||(u=new Set((0,E.getCiphers)())),u.has(t))},54637:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(16461),P=c(95830),O=c(57378),J=c(97e3),W=c(45921),K=c(58451),R=c(23462),U=c(60030),D=c(55552),B=c(18936),F=c(25665),q=c(63514);function cbcDecrypt(t,r,c,E,P,R){let U,B;let q=parseInt(t.slice(1,4),10);(0,D.default)(r)&&(r=r.export());let G=r.subarray(q>>3),V=r.subarray(0,q>>3),X=parseInt(t.slice(-3),10),Y=`aes-${q}-cbc`;if(!(0,F.default)(Y))throw new J.JOSENotSupported(`alg ${t} is not supported by your javascript runtime`);let Z=(0,K.default)(R,E,c,X,V,q);try{U=(0,W.default)(P,Z)}catch{}if(!U)throw new J.JWEDecryptionFailed;try{let t=(0,u.createDecipheriv)(Y,G,E);B=(0,O.concat)(t.update(c),t.final())}catch{}if(!B)throw new J.JWEDecryptionFailed;return B}function gcmDecrypt(t,r,c,E,P,O){let W=parseInt(t.slice(1,4),10),K=`aes-${W}-gcm`;if(!(0,F.default)(K))throw new J.JOSENotSupported(`alg ${t} is not supported by your javascript runtime`);try{let t=(0,u.createDecipheriv)(K,r,E,{authTagLength:16});t.setAuthTag(P),O.byteLength&&t.setAAD(O,{plaintextLength:c.length});let J=t.update(c);return t.final(),J}catch{throw new J.JWEDecryptionFailed}}r.default=(t,r,c,O,W,K)=>{let F;if((0,R.isCryptoKey)(r))(0,U.checkEncCryptoKey)(r,t,"decrypt"),F=u.KeyObject.from(r);else if(r instanceof Uint8Array||(0,D.default)(r))F=r;else throw TypeError((0,B.default)(r,...q.types,"Uint8Array"));switch((0,P.default)(t,F),(0,E.default)(t,O),t){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return cbcDecrypt(t,F,c,O,W,K);case"A128GCM":case"A192GCM":case"A256GCM":return gcmDecrypt(t,F,c,O,W,K);default:throw new J.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},98838:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113);r.default=(t,r)=>(0,u.createHash)(t).update(r).digest()},56767:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(97e3);function dsaDigest(t){switch(t){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"EdDSA":return;default:throw new u.JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}r.default=dsaDigest},21230:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ecdhAllowed=r.generateEpk=r.deriveKey=void 0;let u=c(6113),E=c(73837),P=c(85441),O=c(57378),J=c(97e3),W=c(23462),K=c(60030),R=c(55552),U=c(18936),D=c(63514),B=(0,E.promisify)(u.generateKeyPair);async function deriveKey(t,r,c,E,P=new Uint8Array(0),J=new Uint8Array(0)){let B,F;if((0,W.isCryptoKey)(t))(0,K.checkEncCryptoKey)(t,"ECDH"),B=u.KeyObject.from(t);else if((0,R.default)(t))B=t;else throw TypeError((0,U.default)(t,...D.types));if((0,W.isCryptoKey)(r))(0,K.checkEncCryptoKey)(r,"ECDH","deriveBits"),F=u.KeyObject.from(r);else if((0,R.default)(r))F=r;else throw TypeError((0,U.default)(r,...D.types));let q=(0,O.concat)((0,O.lengthAndInput)(O.encoder.encode(c)),(0,O.lengthAndInput)(P),(0,O.lengthAndInput)(J),(0,O.uint32be)(E)),G=(0,u.diffieHellman)({privateKey:F,publicKey:B});return(0,O.concatKdf)(G,E,q)}async function generateEpk(t){let r;if((0,W.isCryptoKey)(t))r=u.KeyObject.from(t);else if((0,R.default)(t))r=t;else throw TypeError((0,U.default)(t,...D.types));switch(r.asymmetricKeyType){case"x25519":return B("x25519");case"x448":return B("x448");case"ec":{let t=(0,P.default)(r);return B("ec",{namedCurve:t})}default:throw new J.JOSENotSupported("Invalid or unsupported EPK")}}r.deriveKey=deriveKey,r.generateEpk=generateEpk,r.ecdhAllowed=t=>["P-256","P-384","P-521","X25519","X448"].includes((0,P.default)(t))},4868:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(16461),P=c(95830),O=c(57378),J=c(58451),W=c(23462),K=c(60030),R=c(55552),U=c(18936),D=c(97e3),B=c(25665),F=c(63514);function cbcEncrypt(t,r,c,E,P){let W=parseInt(t.slice(1,4),10);(0,R.default)(c)&&(c=c.export());let K=c.subarray(W>>3),U=c.subarray(0,W>>3),F=`aes-${W}-cbc`;if(!(0,B.default)(F))throw new D.JOSENotSupported(`alg ${t} is not supported by your javascript runtime`);let q=(0,u.createCipheriv)(F,K,E),G=(0,O.concat)(q.update(r),q.final()),V=parseInt(t.slice(-3),10),X=(0,J.default)(P,E,G,V,U,W);return{ciphertext:G,tag:X}}function gcmEncrypt(t,r,c,E,P){let O=parseInt(t.slice(1,4),10),J=`aes-${O}-gcm`;if(!(0,B.default)(J))throw new D.JOSENotSupported(`alg ${t} is not supported by your javascript runtime`);let W=(0,u.createCipheriv)(J,c,E,{authTagLength:16});P.byteLength&&W.setAAD(P,{plaintextLength:r.length});let K=W.update(r);W.final();let R=W.getAuthTag();return{ciphertext:K,tag:R}}r.default=(t,r,c,O,J)=>{let B;if((0,W.isCryptoKey)(c))(0,K.checkEncCryptoKey)(c,t,"encrypt"),B=u.KeyObject.from(c);else if(c instanceof Uint8Array||(0,R.default)(c))B=c;else throw TypeError((0,U.default)(c,...F.types,"Uint8Array"));switch((0,P.default)(t,B),(0,E.default)(t,O),t){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return cbcEncrypt(t,r,B,O,J);case"A128GCM":case"A192GCM":case"A256GCM":return gcmEncrypt(t,r,B,O,J);default:throw new D.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},22750:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(13685),E=c(95687),P=c(82361),O=c(97e3),J=c(57378),fetchJwks=async(t,r,c)=>{let W;switch(t.protocol){case"https:":W=E.get;break;case"http:":W=u.get;break;default:throw TypeError("Unsupported URL protocol.")}let{agent:K,headers:R}=c,U=W(t.href,{agent:K,timeout:r,headers:R}),[D]=await Promise.race([(0,P.once)(U,"response"),(0,P.once)(U,"timeout")]);if(!D)throw U.destroy(),new O.JWKSTimeout;if(200!==D.statusCode)throw new O.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");let B=[];for await(let t of D)B.push(t);try{return JSON.parse(J.decoder.decode((0,J.concat)(...B)))}catch{throw new O.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}};r.default=fetchJwks},80072:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.jwkImport=r.jwkExport=r.rsaPssParams=r.oneShotCallback=void 0;let[c,u]=process.versions.node.split(".").map(t=>parseInt(t,10));r.oneShotCallback=c>=16||15===c&&u>=13,r.rsaPssParams=!("electron"in process.versions)&&(c>=17||16===c&&u>=9),r.jwkExport=c>=16||15===c&&u>=9,r.jwkImport=c>=16||15===c&&u>=12},28418:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateKeyPair=r.generateSecret=void 0;let u=c(6113),E=c(73837),P=c(7439),O=c(21056),J=c(97e3),W=(0,E.promisify)(u.generateKeyPair);async function generateSecret(t,r){let c;switch(t){case"HS256":case"HS384":case"HS512":case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(t.slice(-3),10);break;case"A128KW":case"A192KW":case"A256KW":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(t.slice(1,4),10);break;default:throw new J.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return(0,u.createSecretKey)((0,P.default)(new Uint8Array(c>>3)))}async function generateKeyPair(t,r){var c,u;switch(t){case"RS256":case"RS384":case"RS512":case"PS256":case"PS384":case"PS512":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":case"RSA1_5":{let t=null!==(c=null==r?void 0:r.modulusLength)&&void 0!==c?c:2048;if("number"!=typeof t||t<2048)throw new J.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");let u=await W("rsa",{modulusLength:t,publicExponent:65537});return(0,O.setModulusLength)(u.privateKey,t),(0,O.setModulusLength)(u.publicKey,t),u}case"ES256":return W("ec",{namedCurve:"P-256"});case"ES256K":return W("ec",{namedCurve:"secp256k1"});case"ES384":return W("ec",{namedCurve:"P-384"});case"ES512":return W("ec",{namedCurve:"P-521"});case"EdDSA":switch(null==r?void 0:r.crv){case void 0:case"Ed25519":return W("ed25519");case"Ed448":return W("ed448");default:throw new J.JOSENotSupported("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":let E=null!==(u=null==r?void 0:r.crv)&&void 0!==u?u:"P-256";switch(E){case void 0:case"P-256":case"P-384":case"P-521":return W("ec",{namedCurve:E});case"X25519":return W("x25519");case"X448":return W("x448");default:throw new J.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}default:throw new J.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}}r.generateSecret=generateSecret,r.generateKeyPair=generateKeyPair},85441:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setCurve=r.weakMap=void 0;let u=c(14300),E=c(6113),P=c(97e3),O=c(23462),J=c(55552),W=c(18936),K=c(63514),R=u.Buffer.from([42,134,72,206,61,3,1,7]),U=u.Buffer.from([43,129,4,0,34]),D=u.Buffer.from([43,129,4,0,35]),B=u.Buffer.from([43,129,4,0,10]);r.weakMap=new WeakMap;let namedCurveToJOSE=t=>{switch(t){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new P.JOSENotSupported("Unsupported key curve for this operation")}},getNamedCurve=(t,c)=>{var u;let F;if((0,O.isCryptoKey)(t))F=E.KeyObject.from(t);else if((0,J.default)(t))F=t;else throw TypeError((0,W.default)(t,...K.types));if("secret"===F.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(F.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${F.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${F.asymmetricKeyType.slice(1)}`;case"ec":{if(r.weakMap.has(F))return r.weakMap.get(F);let t=null===(u=F.asymmetricKeyDetails)||void 0===u?void 0:u.namedCurve;if(t||"private"!==F.type){if(!t){let r=F.export({format:"der",type:"spki"}),c=r[1]<128?14:15,u=r[c],E=r.slice(c+1,c+1+u);if(E.equals(R))t="prime256v1";else if(E.equals(U))t="secp384r1";else if(E.equals(D))t="secp521r1";else if(E.equals(B))t="secp256k1";else throw new P.JOSENotSupported("Unsupported key curve for this operation")}}else t=getNamedCurve((0,E.createPublicKey)(F),!0);if(c)return t;let O=namedCurveToJOSE(t);return r.weakMap.set(F,O),O}default:throw TypeError("Invalid asymmetric key type for this operation")}};function setCurve(t,c){r.weakMap.set(t,c)}r.setCurve=setCurve,r.default=getNamedCurve},21641:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(23462),P=c(60030),O=c(18936),J=c(63514);function getSignVerifyKey(t,r,c){if(r instanceof Uint8Array){if(!t.startsWith("HS"))throw TypeError((0,O.default)(r,...J.types));return(0,u.createSecretKey)(r)}if(r instanceof u.KeyObject)return r;if((0,E.isCryptoKey)(r))return(0,P.checkSigCryptoKey)(r,t,c),u.KeyObject.from(r);throw TypeError((0,O.default)(r,...J.types,"Uint8Array"))}r.default=getSignVerifyKey},66143:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(97e3);function hmacDigest(t){switch(t){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new u.JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}r.default=hmacDigest},63514:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.types=void 0;let u=c(23462),E=c(55552);r.default=t=>(0,E.default)(t)||(0,u.isCryptoKey)(t);let P=["KeyObject"];r.types=P,(globalThis.CryptoKey||(null===u.default||void 0===u.default?void 0:u.default.CryptoKey))&&P.push("CryptoKey")},55552:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(73837);r.default=E.types.isKeyObject?t=>E.types.isKeyObject(t):t=>null!=t&&t instanceof u.KeyObject},31776:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(14300),E=c(6113),P=c(55285),O=c(97e3),J=c(85441),W=c(21056),K=c(97578),R=c(80072);r.default=t=>{if(R.jwkImport&&"oct"!==t.kty)return t.d?(0,E.createPrivateKey)({format:"jwk",key:t}):(0,E.createPublicKey)({format:"jwk",key:t});switch(t.kty){case"oct":return(0,E.createSecretKey)((0,P.decode)(t.k));case"RSA":{let r=new K.default,c=void 0!==t.d,P=u.Buffer.from(t.n,"base64"),O=u.Buffer.from(t.e,"base64");c?(r.zero(),r.unsignedInteger(P),r.unsignedInteger(O),r.unsignedInteger(u.Buffer.from(t.d,"base64")),r.unsignedInteger(u.Buffer.from(t.p,"base64")),r.unsignedInteger(u.Buffer.from(t.q,"base64")),r.unsignedInteger(u.Buffer.from(t.dp,"base64")),r.unsignedInteger(u.Buffer.from(t.dq,"base64")),r.unsignedInteger(u.Buffer.from(t.qi,"base64"))):(r.unsignedInteger(P),r.unsignedInteger(O));let J=r.end(),R={key:J,format:"der",type:"pkcs1"},U=c?(0,E.createPrivateKey)(R):(0,E.createPublicKey)(R);return(0,W.setModulusLength)(U,P.length<<3),U}case"EC":{let r=new K.default,c=void 0!==t.d,P=u.Buffer.concat([u.Buffer.alloc(1,4),u.Buffer.from(t.x,"base64"),u.Buffer.from(t.y,"base64")]);if(c){r.zero();let c=new K.default;c.oidFor("ecPublicKey"),c.oidFor(t.crv),r.add(c.end());let O=new K.default;O.one(),O.octStr(u.Buffer.from(t.d,"base64"));let W=new K.default;W.bitStr(P);let R=W.end(u.Buffer.from([161]));O.add(R);let U=O.end(),D=new K.default;D.add(U);let B=D.end(u.Buffer.from([4]));r.add(B);let F=r.end(),q=(0,E.createPrivateKey)({key:F,format:"der",type:"pkcs8"});return(0,J.setCurve)(q,t.crv),q}let O=new K.default;O.oidFor("ecPublicKey"),O.oidFor(t.crv),r.add(O.end()),r.bitStr(P);let W=r.end(),R=(0,E.createPublicKey)({key:W,format:"der",type:"spki"});return(0,J.setCurve)(R,t.crv),R}case"OKP":{let r=new K.default,c=void 0!==t.d;if(c){r.zero();let c=new K.default;c.oidFor(t.crv),r.add(c.end());let P=new K.default;P.octStr(u.Buffer.from(t.d,"base64"));let O=P.end(u.Buffer.from([4]));r.add(O);let J=r.end();return(0,E.createPrivateKey)({key:J,format:"der",type:"pkcs8"})}let P=new K.default;P.oidFor(t.crv),r.add(P.end()),r.bitStr(u.Buffer.from(t.x,"base64"));let O=r.end();return(0,E.createPublicKey)({key:O,format:"der",type:"spki"})}default:throw new O.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}}},19355:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(55285),P=c(23670),O=c(97e3),J=c(85441),W=c(23462),K=c(55552),R=c(18936),U=c(63514),D=c(80072),keyToJWK=t=>{let r;if((0,W.isCryptoKey)(t)){if(!t.extractable)throw TypeError("CryptoKey is not extractable");r=u.KeyObject.from(t)}else if((0,K.default)(t))r=t;else if(t instanceof Uint8Array)return{kty:"oct",k:(0,E.encode)(t)};else throw TypeError((0,R.default)(t,...U.types,"Uint8Array"));if(D.jwkExport){if("secret"!==r.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(r.asymmetricKeyType))throw new O.JOSENotSupported("Unsupported key asymmetricKeyType");return r.export({format:"jwk"})}switch(r.type){case"secret":return{kty:"oct",k:(0,E.encode)(r.export())};case"private":case"public":switch(r.asymmetricKeyType){case"rsa":{let t;let c=r.export({format:"der",type:"pkcs1"}),u=new P.default(c);"private"===r.type&&u.unsignedInteger();let O=(0,E.encode)(u.unsignedInteger()),J=(0,E.encode)(u.unsignedInteger());return"private"===r.type&&(t={d:(0,E.encode)(u.unsignedInteger()),p:(0,E.encode)(u.unsignedInteger()),q:(0,E.encode)(u.unsignedInteger()),dp:(0,E.encode)(u.unsignedInteger()),dq:(0,E.encode)(u.unsignedInteger()),qi:(0,E.encode)(u.unsignedInteger())}),u.end(),{kty:"RSA",n:O,e:J,...t}}case"ec":{let t,c,P;let W=(0,J.default)(r);switch(W){case"secp256k1":t=64,c=33,P=-1;break;case"P-256":t=64,c=36,P=-1;break;case"P-384":t=96,c=35,P=-3;break;case"P-521":t=132,c=35,P=-3;break;default:throw new O.JOSENotSupported("Unsupported curve")}if("public"===r.type){let c=r.export({type:"spki",format:"der"});return{kty:"EC",crv:W,x:(0,E.encode)(c.subarray(-t,-t/2)),y:(0,E.encode)(c.subarray(-t/2))}}let K=r.export({type:"pkcs8",format:"der"});return K.length<100&&(c+=P),{...keyToJWK((0,u.createPublicKey)(r)),d:(0,E.encode)(K.subarray(c,c+t/2))}}case"ed25519":case"x25519":{let t=(0,J.default)(r);if("public"===r.type){let c=r.export({type:"spki",format:"der"});return{kty:"OKP",crv:t,x:(0,E.encode)(c.subarray(-32))}}let c=r.export({type:"pkcs8",format:"der"});return{...keyToJWK((0,u.createPublicKey)(r)),d:(0,E.encode)(c.subarray(-32))}}case"ed448":case"x448":{let t=(0,J.default)(r);if("public"===r.type){let c=r.export({type:"spki",format:"der"});return{kty:"OKP",crv:t,x:(0,E.encode)(c.subarray("Ed448"===t?-57:-56))}}let c=r.export({type:"pkcs8",format:"der"});return{...keyToJWK((0,u.createPublicKey)(r)),d:(0,E.encode)(c.subarray("Ed448"===t?-57:-56))}}default:throw new O.JOSENotSupported("Unsupported key asymmetricKeyType")}default:throw new O.JOSENotSupported("Unsupported key type")}};r.default=keyToJWK},54173:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(85441),P=c(97e3),O=c(21056),J=c(80072),W={padding:u.constants.RSA_PKCS1_PSS_PADDING,saltLength:u.constants.RSA_PSS_SALTLEN_DIGEST},K=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);function keyForCrypto(t,r){switch(t){case"EdDSA":if(!["ed25519","ed448"].includes(r.asymmetricKeyType))throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");return r;case"RS256":case"RS384":case"RS512":if("rsa"!==r.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,O.default)(r,t),r;case J.rsaPssParams&&"PS256":case J.rsaPssParams&&"PS384":case J.rsaPssParams&&"PS512":if("rsa-pss"===r.asymmetricKeyType){let{hashAlgorithm:c,mgf1HashAlgorithm:u,saltLength:E}=r.asymmetricKeyDetails,P=parseInt(t.slice(-3),10);if(void 0!==c&&(c!==`sha${P}`||u!==c))throw TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${t}`);if(void 0!==E&&E>P>>3)throw TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${t}`)}else if("rsa"!==r.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");return(0,O.default)(r,t),{key:r,...W};case!J.rsaPssParams&&"PS256":case!J.rsaPssParams&&"PS384":case!J.rsaPssParams&&"PS512":if("rsa"!==r.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,O.default)(r,t),{key:r,...W};case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==r.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let c=(0,E.default)(r),u=K.get(t);if(c!==u)throw TypeError(`Invalid key curve for the algorithm, its curve must be ${u}, got ${c}`);return{dsaEncoding:"ieee-p1363",key:r}}default:throw new P.JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}r.default=keyForCrypto},11966:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decrypt=r.encrypt=void 0;let u=c(73837),E=c(6113),P=c(7439),O=c(57378),J=c(55285),W=c(59900),K=c(96716),R=c(23462),U=c(60030),D=c(55552),B=c(18936),F=c(63514),q=(0,u.promisify)(E.pbkdf2);function getPassword(t,r){if((0,D.default)(t))return t.export();if(t instanceof Uint8Array)return t;if((0,R.isCryptoKey)(t))return(0,U.checkEncCryptoKey)(t,r,"deriveBits","deriveKey"),E.KeyObject.from(t).export();throw TypeError((0,B.default)(t,...F.types,"Uint8Array"))}let encrypt=async(t,r,c,u=2048,E=(0,P.default)(new Uint8Array(16)))=>{(0,K.default)(E);let R=(0,O.p2s)(t,E),U=parseInt(t.slice(13,16),10)>>3,D=getPassword(r,t),B=await q(D,R,u,U,`sha${t.slice(8,11)}`),F=await (0,W.wrap)(t.slice(-6),B,c);return{encryptedKey:F,p2c:u,p2s:(0,J.encode)(E)}};r.encrypt=encrypt;let decrypt=async(t,r,c,u,E)=>{(0,K.default)(E);let P=(0,O.p2s)(t,E),J=parseInt(t.slice(13,16),10)>>3,R=getPassword(r,t),U=await q(R,P,u,J,`sha${t.slice(8,11)}`);return(0,W.unwrap)(t.slice(-6),U,c)};r.decrypt=decrypt},7439:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=c(6113);Object.defineProperty(r,"default",{enumerable:!0,get:function(){return u.randomFillSync}})},41059:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decrypt=r.encrypt=void 0;let u=c(6113),E=c(21056),P=c(23462),O=c(60030),J=c(55552),W=c(18936),K=c(63514),checkKey=(t,r)=>{if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");(0,E.default)(t,r)},resolvePadding=t=>{switch(t){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return u.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return u.constants.RSA_PKCS1_PADDING;default:return}},resolveOaepHash=t=>{switch(t){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function ensureKeyObject(t,r,...c){if((0,J.default)(t))return t;if((0,P.isCryptoKey)(t))return(0,O.checkEncCryptoKey)(t,r,...c),u.KeyObject.from(t);throw TypeError((0,W.default)(t,...K.types))}r.encrypt=(t,r,c)=>{let E=resolvePadding(t),P=resolveOaepHash(t),O=ensureKeyObject(r,t,"wrapKey","encrypt");return checkKey(O,t),(0,u.publicEncrypt)({key:O,oaepHash:P,padding:E},c)},r.decrypt=(t,r,c)=>{let E=resolvePadding(t),P=resolveOaepHash(t),O=ensureKeyObject(r,t,"unwrapKey","decrypt");return checkKey(O,t),(0,u.privateDecrypt)({key:O,oaepHash:P,padding:E},c)}},81314:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="node:crypto"},34840:(t,r,c)=>{"use strict";let u;Object.defineProperty(r,"__esModule",{value:!0});let E=c(6113),P=c(73837),O=c(56767),J=c(66143),W=c(54173),K=c(21641);u=E.sign.length>3?(0,P.promisify)(E.sign):E.sign;let sign=async(t,r,c)=>{let P=(0,K.default)(t,r,"sign");if(t.startsWith("HS")){let r=E.createHmac((0,J.default)(t),P);return r.update(c),r.digest()}return u((0,O.default)(t),c,(0,W.default)(t,P))};r.default=sign},45921:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=u.timingSafeEqual;r.default=E},98291:(t,r,c)=>{"use strict";let u;Object.defineProperty(r,"__esModule",{value:!0});let E=c(6113),P=c(73837),O=c(56767),J=c(54173),W=c(34840),K=c(21641),R=c(80072);u=E.verify.length>4&&R.oneShotCallback?(0,P.promisify)(E.verify):E.verify;let verify=async(t,r,c,P)=>{let R=(0,K.default)(t,r,"verify");if(t.startsWith("HS")){let r=await (0,W.default)(t,R,P);try{return E.timingSafeEqual(c,r)}catch{return!1}}let U=(0,O.default)(t),D=(0,J.default)(t,R);try{return await u(U,P,D,c)}catch{return!1}};r.default=verify},23462:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isCryptoKey=void 0;let u=c(6113),E=c(73837),P=u.webcrypto;r.default=P,r.isCryptoKey=E.types.isCryptoKey?t=>E.types.isCryptoKey(t):t=>!1},97869:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deflate=r.inflate=void 0;let u=c(73837),E=c(59796),P=c(97e3),O=(0,u.promisify)(E.inflateRaw),J=(0,u.promisify)(E.deflateRaw);r.inflate=t=>O(t,{maxOutputLength:25e4}).catch(()=>{throw new P.JWEDecompressionFailed}),r.deflate=t=>J(t)},49684:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decode=r.encode=void 0;let u=c(55285);r.encode=u.encode,r.decode=u.decode},42358:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decodeJwt=void 0;let u=c(49684),E=c(57378),P=c(66725),O=c(97e3);function decodeJwt(t){let r,c;if("string"!=typeof t)throw new O.JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:J,length:W}=t.split(".");if(5===W)throw new O.JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(3!==W)throw new O.JWTInvalid("Invalid JWT");if(!J)throw new O.JWTInvalid("JWTs must contain a payload");try{r=(0,u.decode)(J)}catch{throw new O.JWTInvalid("Failed to base64url decode the payload")}try{c=JSON.parse(E.decoder.decode(r))}catch{throw new O.JWTInvalid("Failed to parse the decoded payload as JSON")}if(!(0,P.default)(c))throw new O.JWTInvalid("Invalid JWT Claims Set");return c}r.decodeJwt=decodeJwt},75395:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decodeProtectedHeader=void 0;let u=c(49684),E=c(57378),P=c(66725);function decodeProtectedHeader(t){let r;if("string"==typeof t){let c=t.split(".");(3===c.length||5===c.length)&&([r]=c)}else if("object"==typeof t&&t){if("protected"in t)r=t.protected;else throw TypeError("Token does not contain a Protected Header")}try{if("string"!=typeof r||!r)throw Error();let t=JSON.parse(E.decoder.decode((0,u.decode)(r)));if(!(0,P.default)(t))throw Error();return t}catch{throw TypeError("Invalid Token or Protected Header formatting")}}r.decodeProtectedHeader=decodeProtectedHeader},97e3:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.JWSSignatureVerificationFailed=r.JWKSTimeout=r.JWKSMultipleMatchingKeys=r.JWKSNoMatchingKey=r.JWKSInvalid=r.JWKInvalid=r.JWTInvalid=r.JWSInvalid=r.JWEInvalid=r.JWEDecompressionFailed=r.JWEDecryptionFailed=r.JOSENotSupported=r.JOSEAlgNotAllowed=r.JWTExpired=r.JWTClaimValidationFailed=r.JOSEError=void 0;let JOSEError=class JOSEError extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(t){var r;super(t),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null===(r=Error.captureStackTrace)||void 0===r||r.call(Error,this,this.constructor)}};r.JOSEError=JOSEError;let JWTClaimValidationFailed=class JWTClaimValidationFailed extends JOSEError{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(t,r="unspecified",c="unspecified"){super(t),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=r,this.reason=c}};r.JWTClaimValidationFailed=JWTClaimValidationFailed;let JWTExpired=class JWTExpired extends JOSEError{static get code(){return"ERR_JWT_EXPIRED"}constructor(t,r="unspecified",c="unspecified"){super(t),this.code="ERR_JWT_EXPIRED",this.claim=r,this.reason=c}};r.JWTExpired=JWTExpired;let JOSEAlgNotAllowed=class JOSEAlgNotAllowed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}};r.JOSEAlgNotAllowed=JOSEAlgNotAllowed;let JOSENotSupported=class JOSENotSupported extends JOSEError{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}};r.JOSENotSupported=JOSENotSupported;let JWEDecryptionFailed=class JWEDecryptionFailed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}};r.JWEDecryptionFailed=JWEDecryptionFailed;let JWEDecompressionFailed=class JWEDecompressionFailed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWE_DECOMPRESSION_FAILED",this.message="decompression operation failed"}static get code(){return"ERR_JWE_DECOMPRESSION_FAILED"}};r.JWEDecompressionFailed=JWEDecompressionFailed;let JWEInvalid=class JWEInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}};r.JWEInvalid=JWEInvalid;let JWSInvalid=class JWSInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}};r.JWSInvalid=JWSInvalid;let JWTInvalid=class JWTInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}};r.JWTInvalid=JWTInvalid;let JWKInvalid=class JWKInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}};r.JWKInvalid=JWKInvalid;let JWKSInvalid=class JWKSInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}};r.JWKSInvalid=JWKSInvalid;let JWKSNoMatchingKey=class JWKSNoMatchingKey extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}};r.JWKSNoMatchingKey=JWKSNoMatchingKey;let JWKSMultipleMatchingKeys=class JWKSMultipleMatchingKeys extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}};r.JWKSMultipleMatchingKeys=JWKSMultipleMatchingKeys,Symbol.asyncIterator;let JWKSTimeout=class JWKSTimeout extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}};r.JWKSTimeout=JWKSTimeout;let JWSSignatureVerificationFailed=class JWSSignatureVerificationFailed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}};r.JWSSignatureVerificationFailed=JWSSignatureVerificationFailed},76495:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(81314);r.default=u.default},39448:(t,r)=>{"use strict";function Credentials(t){return{id:"credentials",name:"Credentials",type:"credentials",credentials:{},authorize:()=>null,options:t}}r.Z=Credentials},49375:(t,r)=>{"use strict";function Google(t){return{id:"google",name:"Google",type:"oauth",wellKnown:"https://accounts.google.com/.well-known/openid-configuration",authorization:{params:{scope:"openid email profile"}},idToken:!0,checks:["pkce","state"],profile:t=>({id:t.sub,name:t.name,email:t.email,image:t.picture}),style:{logo:"/google.svg",bg:"#fff",text:"#000"},options:t}}r.Z=Google},72538:(t,r)=>{"use strict";function detectOrigin(t,r){var c;return(null!==(c=process.env.VERCEL)&&void 0!==c?c:process.env.AUTH_TRUST_HOST)?`${"http"===r?"http":"https"}://${t}`:process.env.NEXTAUTH_URL}Object.defineProperty(r,"__esModule",{value:!0}),r.detectOrigin=detectOrigin},20546:(t,r,c)=>{"use strict";var u=c(2049);Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.proxyLogger=proxyLogger,r.setLogger=setLogger,u(c(21264)),u(c(92174)),u(c(48824));var E=c(32133);function formatError(t){if(t instanceof Error&&!(t instanceof E.UnknownError))return{message:t.message,stack:t.stack,name:t.name};if(hasErrorProperty(t)){var r;t.error=formatError(t.error),t.message=null!==(r=t.message)&&void 0!==r?r:t.error.message}return t}function hasErrorProperty(t){return!!(null!=t&&t.error)}var P={error:function(t,r){r=formatError(r),console.error("[next-auth][error][".concat(t,"]"),"\nhttps://next-auth.js.org/errors#".concat(t.toLowerCase()),r.message,r)},warn:function(t){console.warn("[next-auth][warn][".concat(t,"]"),"\nhttps://next-auth.js.org/warnings#".concat(t.toLowerCase()))},debug:function(t,r){console.log("[next-auth][debug][".concat(t,"]"),r)}};function setLogger(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;r||(P.debug=function(){}),t.error&&(P.error=t.error),t.warn&&(P.warn=t.warn),t.debug&&(P.debug=t.debug)}function proxyLogger(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P;arguments.length>1&&arguments[1];try{return t}catch(t){return P}}r.default=P},96300:(t,r)=>{"use strict";function isObject(t){return t&&"object"==typeof t&&!Array.isArray(t)}function merge(t,...r){if(!r.length)return t;let c=r.shift();if(isObject(t)&&isObject(c))for(let r in c)isObject(c[r])?(t[r]||Object.assign(t,{[r]:{}}),merge(t[r],c[r])):Object.assign(t,{[r]:c[r]});return merge(t,...r)}Object.defineProperty(r,"__esModule",{value:!0}),r.merge=merge},44254:(t,r)=>{"use strict";function parseUrl(t){var r;let c=new URL("http://localhost:3000/api/auth");t&&!t.startsWith("http")&&(t=`https://${t}`);let u=new URL(null!==(r=t)&&void 0!==r?r:c),E=("/"===u.pathname?c.pathname:u.pathname).replace(/\/$/,""),P=`${u.origin}${E}`;return{origin:u.origin,host:u.host,path:E,base:P,toString:()=>P}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=parseUrl},1099:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"DraftMode",{enumerable:!0,get:function(){return DraftMode}});let u=c(3657);let DraftMode=class DraftMode{get isEnabled(){return this._provider.isEnabled}enable(){if(!(0,u.staticGenerationBailout)("draftMode().enable()"))return this._provider.enable()}disable(){if(!(0,u.staticGenerationBailout)("draftMode().disable()"))return this._provider.disable()}constructor(t){this._provider=t}};("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},92491:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var c in r)Object.defineProperty(t,c,{enumerable:!0,get:r[c]})}(r,{headers:function(){return headers},cookies:function(){return cookies},draftMode:function(){return draftMode}});let u=c(96888),E=c(21306),P=c(76449),O=c(91877),J=c(25528),W=c(3657),K=c(1099);function headers(){if((0,W.staticGenerationBailout)("headers",{link:"https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering"}))return E.HeadersAdapter.seal(new Headers({}));let t=O.requestAsyncStorage.getStore();if(!t)throw Error("Invariant: headers() expects to have requestAsyncStorage, none available.");return t.headers}function cookies(){if((0,W.staticGenerationBailout)("cookies",{link:"https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering"}))return u.RequestCookiesAdapter.seal(new P.RequestCookies(new Headers({})));let t=O.requestAsyncStorage.getStore();if(!t)throw Error("Invariant: cookies() expects to have requestAsyncStorage, none available.");let r=J.actionAsyncStorage.getStore();return r&&(r.isAction||r.isAppRoute)?t.mutableCookies:t.cookies}function draftMode(){let t=O.requestAsyncStorage.getStore();if(!t)throw Error("Invariant: draftMode() expects to have requestAsyncStorage, none available.");return new K.DraftMode(t.draftMode)}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},30989:t=>{"use strict";var r=Object.defineProperty,c=Object.getOwnPropertyDescriptor,u=Object.getOwnPropertyNames,E=Object.prototype.hasOwnProperty,P={};function stringifyCookie(t){var r;let c=["path"in t&&t.path&&`Path=${t.path}`,"expires"in t&&(t.expires||0===t.expires)&&`Expires=${("number"==typeof t.expires?new Date(t.expires):t.expires).toUTCString()}`,"maxAge"in t&&"number"==typeof t.maxAge&&`Max-Age=${t.maxAge}`,"domain"in t&&t.domain&&`Domain=${t.domain}`,"secure"in t&&t.secure&&"Secure","httpOnly"in t&&t.httpOnly&&"HttpOnly","sameSite"in t&&t.sameSite&&`SameSite=${t.sameSite}`,"priority"in t&&t.priority&&`Priority=${t.priority}`].filter(Boolean);return`${t.name}=${encodeURIComponent(null!=(r=t.value)?r:"")}; ${c.join("; ")}`}function parseCookie(t){let r=new Map;for(let c of t.split(/; */)){if(!c)continue;let t=c.indexOf("=");if(-1===t){r.set(c,"true");continue}let[u,E]=[c.slice(0,t),c.slice(t+1)];try{r.set(u,decodeURIComponent(null!=E?E:"true"))}catch{}}return r}function parseSetCookie(t){if(!t)return;let[[r,c],...u]=parseCookie(t),{domain:E,expires:P,httponly:O,maxage:J,path:W,samesite:K,secure:R,priority:U}=Object.fromEntries(u.map(([t,r])=>[t.toLowerCase(),r])),D={name:r,value:decodeURIComponent(c),domain:E,...P&&{expires:new Date(P)},...O&&{httpOnly:!0},..."string"==typeof J&&{maxAge:Number(J)},path:W,...K&&{sameSite:parseSameSite(K)},...R&&{secure:!0},...U&&{priority:parsePriority(U)}};return compact(D)}function compact(t){let r={};for(let c in t)t[c]&&(r[c]=t[c]);return r}((t,c)=>{for(var u in c)r(t,u,{get:c[u],enumerable:!0})})(P,{RequestCookies:()=>W,ResponseCookies:()=>K,parseCookie:()=>parseCookie,parseSetCookie:()=>parseSetCookie,stringifyCookie:()=>stringifyCookie}),t.exports=((t,P,O,J)=>{if(P&&"object"==typeof P||"function"==typeof P)for(let O of u(P))E.call(t,O)||void 0===O||r(t,O,{get:()=>P[O],enumerable:!(J=c(P,O))||J.enumerable});return t})(r({},"__esModule",{value:!0}),P);var O=["strict","lax","none"];function parseSameSite(t){return t=t.toLowerCase(),O.includes(t)?t:void 0}var J=["low","medium","high"];function parsePriority(t){return t=t.toLowerCase(),J.includes(t)?t:void 0}function splitCookiesString(t){if(!t)return[];var r,c,u,E,P,O=[],J=0;function skipWhitespace(){for(;J<t.length&&/\s/.test(t.charAt(J));)J+=1;return J<t.length}function notSpecialChar(){return"="!==(c=t.charAt(J))&&";"!==c&&","!==c}for(;J<t.length;){for(r=J,P=!1;skipWhitespace();)if(","===(c=t.charAt(J))){for(u=J,J+=1,skipWhitespace(),E=J;J<t.length&&notSpecialChar();)J+=1;J<t.length&&"="===t.charAt(J)?(P=!0,J=E,O.push(t.substring(r,u)),r=J):J=u+1}else J+=1;(!P||J>=t.length)&&O.push(t.substring(r,t.length))}return O}var W=class{constructor(t){this._parsed=new Map,this._headers=t;let r=t.get("cookie");if(r){let t=parseCookie(r);for(let[r,c]of t)this._parsed.set(r,{name:r,value:c})}}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...t){let r="string"==typeof t[0]?t[0]:t[0].name;return this._parsed.get(r)}getAll(...t){var r;let c=Array.from(this._parsed);if(!t.length)return c.map(([t,r])=>r);let u="string"==typeof t[0]?t[0]:null==(r=t[0])?void 0:r.name;return c.filter(([t])=>t===u).map(([t,r])=>r)}has(t){return this._parsed.has(t)}set(...t){let[r,c]=1===t.length?[t[0].name,t[0].value]:t,u=this._parsed;return u.set(r,{name:r,value:c}),this._headers.set("cookie",Array.from(u).map(([t,r])=>stringifyCookie(r)).join("; ")),this}delete(t){let r=this._parsed,c=Array.isArray(t)?t.map(t=>r.delete(t)):r.delete(t);return this._headers.set("cookie",Array.from(r).map(([t,r])=>stringifyCookie(r)).join("; ")),c}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(t=>`${t.name}=${encodeURIComponent(t.value)}`).join("; ")}},K=class{constructor(t){var r,c,u;this._parsed=new Map,this._headers=t;let E=null!=(u=null!=(c=null==(r=t.getSetCookie)?void 0:r.call(t))?c:t.get("set-cookie"))?u:[],P=Array.isArray(E)?E:splitCookiesString(E);for(let t of P){let r=parseSetCookie(t);r&&this._parsed.set(r.name,r)}}get(...t){let r="string"==typeof t[0]?t[0]:t[0].name;return this._parsed.get(r)}getAll(...t){var r;let c=Array.from(this._parsed.values());if(!t.length)return c;let u="string"==typeof t[0]?t[0]:null==(r=t[0])?void 0:r.name;return c.filter(t=>t.name===u)}has(t){return this._parsed.has(t)}set(...t){let[r,c,u]=1===t.length?[t[0].name,t[0].value,t[0]]:t,E=this._parsed;return E.set(r,normalizeCookie({name:r,value:c,...u})),replace(E,this._headers),this}delete(...t){let[r,c,u]="string"==typeof t[0]?[t[0]]:[t[0].name,t[0].path,t[0].domain];return this.set({name:r,path:c,domain:u,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(stringifyCookie).join("; ")}};function replace(t,r){for(let[,c]of(r.delete("set-cookie"),t)){let t=stringifyCookie(c);r.append("set-cookie",t)}}function normalizeCookie(t={name:"",value:""}){return"number"==typeof t.expires&&(t.expires=new Date(t.expires)),t.maxAge&&(t.expires=new Date(Date.now()+1e3*t.maxAge)),(null===t.path||void 0===t.path)&&(t.path="/"),t}},10884:(t,r,c)=>{"use strict";t.exports=c(30517)},21306:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var c in r)Object.defineProperty(t,c,{enumerable:!0,get:r[c]})}(r,{ReadonlyHeadersError:function(){return ReadonlyHeadersError},HeadersAdapter:function(){return HeadersAdapter}});let u=c(49165);let ReadonlyHeadersError=class ReadonlyHeadersError extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new ReadonlyHeadersError}};let HeadersAdapter=class HeadersAdapter extends Headers{constructor(t){super(),this.headers=new Proxy(t,{get(r,c,E){if("symbol"==typeof c)return u.ReflectAdapter.get(r,c,E);let P=c.toLowerCase(),O=Object.keys(t).find(t=>t.toLowerCase()===P);if(void 0!==O)return u.ReflectAdapter.get(r,O,E)},set(r,c,E,P){if("symbol"==typeof c)return u.ReflectAdapter.set(r,c,E,P);let O=c.toLowerCase(),J=Object.keys(t).find(t=>t.toLowerCase()===O);return u.ReflectAdapter.set(r,J??c,E,P)},has(r,c){if("symbol"==typeof c)return u.ReflectAdapter.has(r,c);let E=c.toLowerCase(),P=Object.keys(t).find(t=>t.toLowerCase()===E);return void 0!==P&&u.ReflectAdapter.has(r,P)},deleteProperty(r,c){if("symbol"==typeof c)return u.ReflectAdapter.deleteProperty(r,c);let E=c.toLowerCase(),P=Object.keys(t).find(t=>t.toLowerCase()===E);return void 0===P||u.ReflectAdapter.deleteProperty(r,P)}})}static seal(t){return new Proxy(t,{get(t,r,c){switch(r){case"append":case"delete":case"set":return ReadonlyHeadersError.callable;default:return u.ReflectAdapter.get(t,r,c)}}})}merge(t){return Array.isArray(t)?t.join(", "):t}static from(t){return t instanceof Headers?t:new HeadersAdapter(t)}append(t,r){let c=this.headers[t];"string"==typeof c?this.headers[t]=[c,r]:Array.isArray(c)?c.push(r):this.headers[t]=r}delete(t){delete this.headers[t]}get(t){let r=this.headers[t];return void 0!==r?this.merge(r):null}has(t){return void 0!==this.headers[t]}set(t,r){this.headers[t]=r}forEach(t,r){for(let[c,u]of this.entries())t.call(r,u,c,this)}*entries(){for(let t of Object.keys(this.headers)){let r=t.toLowerCase(),c=this.get(r);yield[r,c]}}*keys(){for(let t of Object.keys(this.headers)){let r=t.toLowerCase();yield r}}*values(){for(let t of Object.keys(this.headers)){let r=this.get(t);yield r}}[Symbol.iterator](){return this.entries()}}},49165:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ReflectAdapter",{enumerable:!0,get:function(){return ReflectAdapter}});let ReflectAdapter=class ReflectAdapter{static get(t,r,c){let u=Reflect.get(t,r,c);return"function"==typeof u?u.bind(t):u}static set(t,r,c,u){return Reflect.set(t,r,c,u)}static has(t,r){return Reflect.has(t,r)}static deleteProperty(t,r){return Reflect.deleteProperty(t,r)}}},96888:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var c in r)Object.defineProperty(t,c,{enumerable:!0,get:r[c]})}(r,{ReadonlyRequestCookiesError:function(){return ReadonlyRequestCookiesError},RequestCookiesAdapter:function(){return RequestCookiesAdapter},getModifiedCookieValues:function(){return getModifiedCookieValues},appendMutableCookies:function(){return appendMutableCookies},MutableRequestCookiesAdapter:function(){return MutableRequestCookiesAdapter}});let u=c(76449),E=c(49165);let ReadonlyRequestCookiesError=class ReadonlyRequestCookiesError extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options")}static callable(){throw new ReadonlyRequestCookiesError}};let RequestCookiesAdapter=class RequestCookiesAdapter{static seal(t){return new Proxy(t,{get(t,r,c){switch(r){case"clear":case"delete":case"set":return ReadonlyRequestCookiesError.callable;default:return E.ReflectAdapter.get(t,r,c)}}})}};let P=Symbol.for("next.mutated.cookies");function getModifiedCookieValues(t){let r=t[P];return r&&Array.isArray(r)&&0!==r.length?r:[]}function appendMutableCookies(t,r){let c=getModifiedCookieValues(r);if(0===c.length)return!1;let E=new u.ResponseCookies(t),P=E.getAll();for(let t of c)E.set(t);for(let t of P)E.set(t);return!0}let MutableRequestCookiesAdapter=class MutableRequestCookiesAdapter{static wrap(t,r){let c=new u.ResponseCookies(new Headers);for(let r of t.getAll())c.set(r);let O=[],J=new Set,updateResponseCookies=()=>{var t;let E=null==fetch.__nextGetStaticStore?void 0:null==(t=fetch.__nextGetStaticStore.call(fetch))?void 0:t.getStore();E&&(E.pathWasRevalidated=!0);let P=c.getAll();if(O=P.filter(t=>J.has(t.name)),r){let t=[];for(let r of O){let c=new u.ResponseCookies(new Headers);c.set(r),t.push(c.toString())}r(t)}};return new Proxy(c,{get(t,r,c){switch(r){case P:return O;case"delete":return function(...r){J.add("string"==typeof r[0]?r[0]:r[0].name);try{t.delete(...r)}finally{updateResponseCookies()}};case"set":return function(...r){J.add("string"==typeof r[0]?r[0]:r[0].name);try{return t.set(...r)}finally{updateResponseCookies()}};default:return E.ReflectAdapter.get(t,r,c)}}})}}},76449:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(t,r){for(var c in r)Object.defineProperty(t,c,{enumerable:!0,get:r[c]})}(r,{RequestCookies:function(){return u.RequestCookies},ResponseCookies:function(){return u.ResponseCookies}});let u=c(30989)},24596:(t,r,c)=>{"use strict";t.exports=c(92491)},72369:(t,r,c)=>{r.OAuth=c(91158).OAuth,r.OAuthEcho=c(91158).OAuthEcho,r.OAuth2=c(21679).OAuth2},70495:t=>{"use strict";t.exports.isAnEarlyCloseHost=function(t){return t&&t.match(".*google(apis)?.com$")}},91158:(t,r,c)=>{var u=c(6113),E=c(33835),P=c(13685),O=c(95687),J=c(57310),W=c(63477),K=c(70495);r.OAuth=function(t,r,c,u,E,P,O,J,W){if(this._isEcho=!1,this._requestUrl=t,this._accessUrl=r,this._consumerKey=c,this._consumerSecret=this._encodeData(u),"RSA-SHA1"==O&&(this._privateKey=u),this._version=E,void 0===P?this._authorize_callback="oob":this._authorize_callback=P,"PLAINTEXT"!=O&&"HMAC-SHA1"!=O&&"RSA-SHA1"!=O)throw Error("Un-supported signature method: "+O);this._signatureMethod=O,this._nonceSize=J||32,this._headers=W||{Accept:"*/*",Connection:"close","User-Agent":"Node authentication"},this._clientOptions=this._defaultClientOptions={requestTokenHttpMethod:"POST",accessTokenHttpMethod:"POST",followRedirects:!0},this._oauthParameterSeperator=","},r.OAuthEcho=function(t,r,c,u,E,P,O,J){if(this._isEcho=!0,this._realm=t,this._verifyCredentials=r,this._consumerKey=c,this._consumerSecret=this._encodeData(u),"RSA-SHA1"==P&&(this._privateKey=u),this._version=E,"PLAINTEXT"!=P&&"HMAC-SHA1"!=P&&"RSA-SHA1"!=P)throw Error("Un-supported signature method: "+P);this._signatureMethod=P,this._nonceSize=O||32,this._headers=J||{Accept:"*/*",Connection:"close","User-Agent":"Node authentication"},this._oauthParameterSeperator=","},r.OAuthEcho.prototype=r.OAuth.prototype,r.OAuth.prototype._getTimestamp=function(){return Math.floor(new Date().getTime()/1e3)},r.OAuth.prototype._encodeData=function(t){return null==t||""==t?"":encodeURIComponent(t).replace(/\!/g,"%21").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")},r.OAuth.prototype._decodeData=function(t){return null!=t&&(t=t.replace(/\+/g," ")),decodeURIComponent(t)},r.OAuth.prototype._getSignature=function(t,r,c,u){var E=this._createSignatureBase(t,r,c);return this._createSignature(E,u)},r.OAuth.prototype._normalizeUrl=function(t){var r=J.parse(t,!0),c="";return r.port&&("http:"==r.protocol&&"80"!=r.port||"https:"==r.protocol&&"443"!=r.port)&&(c=":"+r.port),r.pathname&&""!=r.pathname||(r.pathname="/"),r.protocol+"//"+r.hostname+c+r.pathname},r.OAuth.prototype._isParameterNameAnOAuthParameter=function(t){var r=t.match("^oauth_");return!!r&&"oauth_"===r[0]},r.OAuth.prototype._buildAuthorizationHeaders=function(t){var r="OAuth ";this._isEcho&&(r+='realm="'+this._realm+'",');for(var c=0;c<t.length;c++)this._isParameterNameAnOAuthParameter(t[c][0])&&(r+=""+this._encodeData(t[c][0])+'="'+this._encodeData(t[c][1])+'"'+this._oauthParameterSeperator);return r.substring(0,r.length-this._oauthParameterSeperator.length)},r.OAuth.prototype._makeArrayOfArgumentsHash=function(t){var r=[];for(var c in t)if(t.hasOwnProperty(c)){var u=t[c];if(Array.isArray(u))for(var E=0;E<u.length;E++)r[r.length]=[c,u[E]];else r[r.length]=[c,u]}return r},r.OAuth.prototype._sortRequestParams=function(t){return t.sort(function(t,r){return t[0]==r[0]?t[1]<r[1]?-1:1:t[0]<r[0]?-1:1}),t},r.OAuth.prototype._normaliseRequestParams=function(t){for(var r=this._makeArrayOfArgumentsHash(t),c=0;c<r.length;c++)r[c][0]=this._encodeData(r[c][0]),r[c][1]=this._encodeData(r[c][1]);r=this._sortRequestParams(r);for(var t="",c=0;c<r.length;c++)t+=r[c][0]+"="+r[c][1],c<r.length-1&&(t+="&");return t},r.OAuth.prototype._createSignatureBase=function(t,r,c){return r=this._encodeData(this._normalizeUrl(r)),c=this._encodeData(c),t.toUpperCase()+"&"+r+"&"+c},r.OAuth.prototype._createSignature=function(t,r){if(void 0===r)var r="";else r=this._encodeData(r);var c=this._consumerSecret+"&"+r,P="";return"PLAINTEXT"==this._signatureMethod?P=c:"RSA-SHA1"==this._signatureMethod?(c=this._privateKey||"",P=u.createSign("RSA-SHA1").update(t).sign(c,"base64")):P=u.Hmac?u.createHmac("sha1",c).update(t).digest("base64"):E.HMACSHA1(c,t),P},r.OAuth.prototype.NONCE_CHARS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9"],r.OAuth.prototype._getNonce=function(t){for(var r,c=[],u=this.NONCE_CHARS,E=u.length,P=0;P<t;P++)r=Math.floor(Math.random()*E),c[P]=u[r];return c.join("")},r.OAuth.prototype._createClient=function(t,r,c,u,E,J){return(J?O:P).request({host:r,port:t,path:u,method:c,headers:E})},r.OAuth.prototype._prepareParameters=function(t,r,c,u,E){var P={oauth_timestamp:this._getTimestamp(),oauth_nonce:this._getNonce(this._nonceSize),oauth_version:this._version,oauth_signature_method:this._signatureMethod,oauth_consumer_key:this._consumerKey};if(t&&(P.oauth_token=t),this._isEcho)R=this._getSignature("GET",this._verifyCredentials,this._normaliseRequestParams(P),r);else{if(E)for(var O in E)E.hasOwnProperty(O)&&(P[O]=E[O]);var K=J.parse(u,!1);if(K.query){var R,U,D=W.parse(K.query);for(var O in D){var B=D[O];if("object"==typeof B)for(U in B)P[O+"["+U+"]"]=B[U];else P[O]=B}}R=this._getSignature(c,u,this._normaliseRequestParams(P),r)}var F=this._sortRequestParams(this._makeArrayOfArgumentsHash(P));return F[F.length]=["oauth_signature",R],F},r.OAuth.prototype._performSecureRequest=function(t,r,c,u,E,P,O,R){var U,D,B=this._prepareParameters(t,r,c,u,E);O||(O="application/x-www-form-urlencoded");var F=J.parse(u,!1);"http:"!=F.protocol||F.port||(F.port=80),"https:"!=F.protocol||F.port||(F.port=443);var q={},G=this._buildAuthorizationHeaders(B);for(var V in this._isEcho?q["X-Verify-Credentials-Authorization"]=G:q.Authorization=G,q.Host=F.host,this._headers)this._headers.hasOwnProperty(V)&&(q[V]=this._headers[V]);for(var V in E)this._isParameterNameAnOAuthParameter(V)&&delete E[V];("POST"==c||"PUT"==c)&&null==P&&null!=E&&(P=W.stringify(E).replace(/\!/g,"%21").replace(/\'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")),P?Buffer.isBuffer(P)?q["Content-length"]=P.length:q["Content-length"]=Buffer.byteLength(P):q["Content-length"]=0,q["Content-Type"]=O,F.pathname&&""!=F.pathname||(F.pathname="/"),U=F.query?F.pathname+"?"+F.query:F.pathname,D="https:"==F.protocol?this._createClient(F.port,F.hostname,c,U,q,!0):this._createClient(F.port,F.hostname,c,U,q);var X=this._clientOptions;if(!R)return("POST"==c||"PUT"==c)&&null!=P&&""!=P&&D.write(P),D;var Y="",Z=this,Q=K.isAnEarlyCloseHost(F.hostname),ee=!1,passBackControl=function(u){ee||(ee=!0,u.statusCode>=200&&u.statusCode<=299?R(null,Y,u):(301==u.statusCode||302==u.statusCode)&&X.followRedirects&&u.headers&&u.headers.location?Z._performSecureRequest(t,r,c,u.headers.location,E,P,O,R):R({statusCode:u.statusCode,data:Y},Y,u))};D.on("response",function(t){t.setEncoding("utf8"),t.on("data",function(t){Y+=t}),t.on("end",function(){passBackControl(t)}),t.on("close",function(){Q&&passBackControl(t)})}),D.on("error",function(t){ee||(ee=!0,R(t))}),("POST"==c||"PUT"==c)&&null!=P&&""!=P&&D.write(P),D.end()},r.OAuth.prototype.setClientOptions=function(t){var r,c={},u=Object.prototype.hasOwnProperty;for(r in this._defaultClientOptions)u.call(t,r)?c[r]=t[r]:c[r]=this._defaultClientOptions[r];this._clientOptions=c},r.OAuth.prototype.getOAuthAccessToken=function(t,r,c,u){var E={};"function"==typeof c?u=c:E.oauth_verifier=c,this._performSecureRequest(t,r,this._clientOptions.accessTokenHttpMethod,this._accessUrl,E,null,null,function(t,r,c){if(t)u(t);else{var E=W.parse(r),P=E.oauth_token;delete E.oauth_token;var O=E.oauth_token_secret;delete E.oauth_token_secret,u(null,P,O,E)}})},r.OAuth.prototype.getProtectedResource=function(t,r,c,u,E){this._performSecureRequest(c,u,r,t,null,"",null,E)},r.OAuth.prototype.delete=function(t,r,c,u){return this._performSecureRequest(r,c,"DELETE",t,null,"",null,u)},r.OAuth.prototype.get=function(t,r,c,u){return this._performSecureRequest(r,c,"GET",t,null,"",null,u)},r.OAuth.prototype._putOrPost=function(t,r,c,u,E,P,O){var J=null;return"function"==typeof P&&(O=P,P=null),"string"==typeof E||Buffer.isBuffer(E)||(P="application/x-www-form-urlencoded",J=E,E=null),this._performSecureRequest(c,u,t,r,J,E,P,O)},r.OAuth.prototype.put=function(t,r,c,u,E,P){return this._putOrPost("PUT",t,r,c,u,E,P)},r.OAuth.prototype.post=function(t,r,c,u,E,P){return this._putOrPost("POST",t,r,c,u,E,P)},r.OAuth.prototype.getOAuthRequestToken=function(t,r){"function"==typeof t&&(r=t,t={}),this._authorize_callback&&(t.oauth_callback=this._authorize_callback),this._performSecureRequest(null,null,this._clientOptions.requestTokenHttpMethod,this._requestUrl,t,null,null,function(t,c,u){if(t)r(t);else{var E=W.parse(c),P=E.oauth_token,O=E.oauth_token_secret;delete E.oauth_token,delete E.oauth_token_secret,r(null,P,O,E)}})},r.OAuth.prototype.signUrl=function(t,r,c,u){if(void 0===u)var u="GET";for(var E=this._prepareParameters(r,c,u,t,{}),P=J.parse(t,!1),O="",W=0;W<E.length;W++)O+=E[W][0]+"="+this._encodeData(E[W][1])+"&";return O=O.substring(0,O.length-1),P.protocol+"//"+P.host+P.pathname+"?"+O},r.OAuth.prototype.authHeader=function(t,r,c,u){if(void 0===u)var u="GET";var E=this._prepareParameters(r,c,u,t,{});return this._buildAuthorizationHeaders(E)}},21679:(t,r,c)=>{var u=c(63477),E=(c(6113),c(95687)),P=c(13685),O=c(57310),J=c(70495);r.OAuth2=function(t,r,c,u,E,P){this._clientId=t,this._clientSecret=r,this._baseSite=c,this._authorizeUrl=u||"/oauth/authorize",this._accessTokenUrl=E||"/oauth/access_token",this._accessTokenName="access_token",this._authMethod="Bearer",this._customHeaders=P||{},this._useAuthorizationHeaderForGET=!1,this._agent=void 0},r.OAuth2.prototype.setAgent=function(t){this._agent=t},r.OAuth2.prototype.setAccessTokenName=function(t){this._accessTokenName=t},r.OAuth2.prototype.setAuthMethod=function(t){this._authMethod=t},r.OAuth2.prototype.useAuthorizationHeaderforGET=function(t){this._useAuthorizationHeaderForGET=t},r.OAuth2.prototype._getAccessTokenUrl=function(){return this._baseSite+this._accessTokenUrl},r.OAuth2.prototype.buildAuthHeader=function(t){return this._authMethod+" "+t},r.OAuth2.prototype._chooseHttpLibrary=function(t){var r=E;return"https:"!=t.protocol&&(r=P),r},r.OAuth2.prototype._request=function(t,r,c,E,P,J){var W=O.parse(r,!0);"https:"!=W.protocol||W.port||(W.port=443);var K=this._chooseHttpLibrary(W),R={};for(var U in this._customHeaders)R[U]=this._customHeaders[U];if(c)for(var U in c)R[U]=c[U];R.Host=W.host,R["User-Agent"]||(R["User-Agent"]="Node-oauth"),E?Buffer.isBuffer(E)?R["Content-Length"]=E.length:R["Content-Length"]=Buffer.byteLength(E):R["Content-length"]=0,!P||"Authorization"in R||(W.query||(W.query={}),W.query[this._accessTokenName]=P);var D=u.stringify(W.query);D&&(D="?"+D);var B={host:W.hostname,port:W.port,path:W.pathname+D,method:t,headers:R};this._executeRequest(K,B,E,J)},r.OAuth2.prototype._executeRequest=function(t,r,c,u){var E=J.isAnEarlyCloseHost(r.host),P=!1;function passBackControl(t,r){P||(P=!0,t.statusCode>=200&&t.statusCode<=299||301==t.statusCode||302==t.statusCode?u(null,r,t):u({statusCode:t.statusCode,data:r}))}var O="";this._agent&&(r.agent=this._agent);var W=t.request(r);W.on("response",function(t){t.on("data",function(t){O+=t}),t.on("close",function(r){E&&passBackControl(t,O)}),t.addListener("end",function(){passBackControl(t,O)})}),W.on("error",function(t){P=!0,u(t)}),("POST"==r.method||"PUT"==r.method)&&c&&W.write(c),W.end()},r.OAuth2.prototype.getAuthorizeUrl=function(t){var t=t||{};return t.client_id=this._clientId,this._baseSite+this._authorizeUrl+"?"+u.stringify(t)},r.OAuth2.prototype.getOAuthAccessToken=function(t,r,c){var r=r||{};r.client_id=this._clientId,r.client_secret=this._clientSecret;var E="refresh_token"===r.grant_type?"refresh_token":"code";r[E]=t;var P=u.stringify(r);this._request("POST",this._getAccessTokenUrl(),{"Content-Type":"application/x-www-form-urlencoded"},P,null,function(t,r,E){if(t)c(t);else{try{P=JSON.parse(r)}catch(t){P=u.parse(r)}var P,O=P.access_token,J=P.refresh_token;delete P.refresh_token,c(null,O,J,P)}})},r.OAuth2.prototype.getProtectedResource=function(t,r,c){this._request("GET",t,{},"",r,c)},r.OAuth2.prototype.get=function(t,r,c){if(this._useAuthorizationHeaderForGET){var u={Authorization:this.buildAuthHeader(r)};r=null}else u={};this._request("GET",t,u,"",r,c)}},33835:(t,r)=>{function b64_hmac_sha1(t,r){return rstr2b64(rstr_hmac_sha1(str2rstr_utf8(t),str2rstr_utf8(r)))}function rstr_hmac_sha1(t,r){var c=rstr2binb(t);c.length>16&&(c=binb_sha1(c,8*t.length));for(var u=Array(16),E=Array(16),P=0;P<16;P++)u[P]=909522486^c[P],E[P]=1549556828^c[P];var O=binb_sha1(u.concat(rstr2binb(r)),512+8*r.length);return binb2rstr(binb_sha1(E.concat(O),672))}function rstr2b64(t){for(var r="",c=t.length,u=0;u<c;u+=3)for(var E=t.charCodeAt(u)<<16|(u+1<c?t.charCodeAt(u+1)<<8:0)|(u+2<c?t.charCodeAt(u+2):0),P=0;P<4;P++)8*u+6*P>8*t.length?r+="=":r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(E>>>6*(3-P)&63);return r}function str2rstr_utf8(t){for(var r,c,u="",E=-1;++E<t.length;)r=t.charCodeAt(E),c=E+1<t.length?t.charCodeAt(E+1):0,55296<=r&&r<=56319&&56320<=c&&c<=57343&&(r=65536+((1023&r)<<10)+(1023&c),E++),r<=127?u+=String.fromCharCode(r):r<=2047?u+=String.fromCharCode(192|r>>>6&31,128|63&r):r<=65535?u+=String.fromCharCode(224|r>>>12&15,128|r>>>6&63,128|63&r):r<=2097151&&(u+=String.fromCharCode(240|r>>>18&7,128|r>>>12&63,128|r>>>6&63,128|63&r));return u}function rstr2binb(t){for(var r=Array(t.length>>2),c=0;c<r.length;c++)r[c]=0;for(var c=0;c<8*t.length;c+=8)r[c>>5]|=(255&t.charCodeAt(c/8))<<24-c%32;return r}function binb2rstr(t){for(var r="",c=0;c<32*t.length;c+=8)r+=String.fromCharCode(t[c>>5]>>>24-c%32&255);return r}function binb_sha1(t,r){t[r>>5]|=128<<24-r%32,t[(r+64>>9<<4)+15]=r;for(var c=Array(80),u=1732584193,E=-271733879,P=-1732584194,O=271733878,J=-1009589776,W=0;W<t.length;W+=16){for(var K=u,R=E,U=P,D=O,B=J,F=0;F<80;F++){F<16?c[F]=t[W+F]:c[F]=bit_rol(c[F-3]^c[F-8]^c[F-14]^c[F-16],1);var q=safe_add(safe_add(bit_rol(u,5),sha1_ft(F,E,P,O)),safe_add(safe_add(J,c[F]),sha1_kt(F)));J=O,O=P,P=bit_rol(E,30),E=u,u=q}u=safe_add(u,K),E=safe_add(E,R),P=safe_add(P,U),O=safe_add(O,D),J=safe_add(J,B)}return[u,E,P,O,J]}function sha1_ft(t,r,c,u){return t<20?r&c|~r&u:t<40?r^c^u:t<60?r&c|r&u|c&u:r^c^u}function sha1_kt(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514}function safe_add(t,r){var c=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(c>>16)<<16|65535&c}function bit_rol(t,r){return t<<r|t>>>32-r}r.HMACSHA1=function(t,r){return b64_hmac_sha1(t,r)}},50939:(t,r,c)=>{"use strict";let u;let{strict:E}=c(39491),{createHash:P}=c(6113),{format:O}=c(73837);if(Buffer.isEncoding("base64url"))u=t=>t.toString("base64url");else{let fromBase64=t=>t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");u=t=>fromBase64(t.toString("base64"))}function getHash(t,r){switch(t){case"HS256":case"RS256":case"PS256":case"ES256":case"ES256K":return P("sha256");case"HS384":case"RS384":case"PS384":case"ES384":return P("sha384");case"HS512":case"RS512":case"PS512":case"ES512":case"Ed25519":return P("sha512");case"Ed448":return P("shake256",{outputLength:114});case"EdDSA":switch(r){case"Ed25519":return P("sha512");case"Ed448":return P("shake256",{outputLength:114});default:throw TypeError("unrecognized or invalid EdDSA curve provided")}default:throw TypeError("unrecognized or invalid JWS algorithm provided")}}function generate(t,r,c){let E=getHash(r,c).update(t).digest();return u(E.slice(0,E.length/2))}function validate(t,r,c,u,P){let J,W;if("string"!=typeof t.claim||!t.claim)throw TypeError("names.claim must be a non-empty string");if("string"!=typeof t.source||!t.source)throw TypeError("names.source must be a non-empty string");E("string"==typeof r&&r,`${t.claim} must be a non-empty string`),E("string"==typeof c&&c,`${t.source} must be a non-empty string`);try{J=generate(c,u,P)}catch(r){W=O("%s could not be validated (%s)",t.claim,r.message)}W=W||O("%s mismatch, expected %s, got: %s",t.claim,J,r),E.equal(J,r,W)}t.exports={validate,generate}},76398:(t,r,c)=>{"use strict";let u;let{inspect:E}=c(73837),P=c(13685),O=c(6113),{strict:J}=c(39491),W=c(63477),K=c(57310),{URL:R,URLSearchParams:U}=c(57310),D=c(84664),B=c(50939),F=c(68060),q=c(44759),G=c(26597),V=c(81772),X=c(92102),{assertSigningAlgValuesSupport:Y,assertIssuerConfiguration:Z}=c(36245),Q=c(52542),ee=c(13641),et=c(7889),er=c(8164),{OPError:en,RPError:ei}=c(10574),eo=c(91624),{random:ea}=c(29766),es=c(3135),{CLOCK_TOLERANCE:ec}=c(60577),{keystores:el}=c(18763),ed=c(73640),eu=c(68979),{authenticatedPost:ep,resolveResponseType:eh,resolveRedirectUri:ef}=c(98522),{queryKeyStore:ey}=c(37875),eg=c(67688),[em,e_]=process.version.slice(1).split(".").map(t=>parseInt(t,10)),ev=em>=17||16===em&&e_>=9,ew=Symbol(),eb=Symbol(),eS=Symbol();function pickCb(t){return Q(t,"access_token","code","error_description","error_uri","error","expires_in","id_token","iss","response","session_state","state","token_type")}function authorizationHeaderValue(t,r="Bearer"){return`${r} ${t}`}function getSearchParams(t){let r=K.parse(t);return r.search?W.parse(r.search.substring(1)):{}}function verifyPresence(t,r,c){if(void 0===t[c])throw new ei({message:`missing required JWT property ${c}`,jwt:r})}function authorizationParams(t){let r={client_id:this.client_id,scope:"openid",response_type:eh.call(this),redirect_uri:ef.call(this),...t};return Object.entries(r).forEach(([t,c])=>{null==c?delete r[t]:"claims"===t&&"object"==typeof c?r[t]=JSON.stringify(c):"resource"===t&&Array.isArray(c)?r[t]=c:"string"!=typeof c&&(r[t]=String(c))}),r}function getKeystore(t){if(!ee(t)||!Array.isArray(t.keys)||t.keys.some(t=>!ee(t)||!("kty"in t)))throw TypeError("jwks must be a JSON Web Key Set formatted object");return ed.fromJWKS(t,{onlyPrivate:!0})}function checkBasicSupport(t,r){try{let c=t.issuer.token_endpoint_auth_methods_supported;!c.includes(r.token_endpoint_auth_method)&&c.includes("client_secret_post")&&(r.token_endpoint_auth_method="client_secret_post")}catch(t){}}function handleCommonMistakes(t,r,c){if(r.token_endpoint_auth_method||checkBasicSupport(t,c),r.redirect_uri){if(r.redirect_uris)throw TypeError("provide a redirect_uri or redirect_uris, not both");c.redirect_uris=[r.redirect_uri],delete c.redirect_uri}if(r.response_type){if(r.response_types)throw TypeError("provide a response_type or response_types, not both");c.response_types=[r.response_type],delete c.response_type}}function getDefaultsForEndpoint(t,r,c){if(!r[`${t}_endpoint`])return;let u=c.token_endpoint_auth_method,E=c.token_endpoint_auth_signing_alg,P=`${t}_endpoint_auth_method`,O=`${t}_endpoint_auth_signing_alg`;void 0===c[P]&&void 0===c[O]&&(void 0!==u&&(c[P]=u),void 0!==E&&(c[O]=E))}let BaseClient=class BaseClient{#e;#t;#r;#n;constructor(t,r,c={},u,E){if(this.#e=new Map,this.#t=t,this.#r=r,"string"!=typeof c.client_id||!c.client_id)throw TypeError("client_id is required");let P={grant_types:["authorization_code"],id_token_signed_response_alg:"RS256",authorization_signed_response_alg:"RS256",response_types:["code"],token_endpoint_auth_method:"client_secret_basic",...this.fapi1()?{grant_types:["authorization_code","implicit"],id_token_signed_response_alg:"PS256",authorization_signed_response_alg:"PS256",response_types:["code id_token"],tls_client_certificate_bound_access_tokens:!0,token_endpoint_auth_method:void 0}:void 0,...this.fapi2()?{id_token_signed_response_alg:"PS256",authorization_signed_response_alg:"PS256",token_endpoint_auth_method:void 0}:void 0,...c};if(this.fapi())switch(P.token_endpoint_auth_method){case"self_signed_tls_client_auth":case"tls_client_auth":break;case"private_key_jwt":if(!u)throw TypeError("jwks is required");break;case void 0:throw TypeError("token_endpoint_auth_method is required");default:throw TypeError("invalid or unsupported token_endpoint_auth_method")}if(this.fapi2()&&(P.tls_client_certificate_bound_access_tokens&&P.dpop_bound_access_tokens||!P.tls_client_certificate_bound_access_tokens&&!P.dpop_bound_access_tokens))throw TypeError("either tls_client_certificate_bound_access_tokens or dpop_bound_access_tokens must be set to true");if(handleCommonMistakes(this,c,P),Y("token",this.issuer,P),["introspection","revocation"].forEach(t=>{getDefaultsForEndpoint(t,this.issuer,P),Y(t,this.issuer,P)}),Object.entries(P).forEach(([t,r])=>{this.#e.set(t,r),this[t]||Object.defineProperty(this,t,{get(){return this.#e.get(t)},enumerable:!0})}),void 0!==u){let t=getKeystore.call(this,u);el.set(this,t)}null!=E&&E.additionalAuthorizedParties&&(this.#n=eu(E.additionalAuthorizedParties)),this[ec]=0}authorizationUrl(t={}){if(!ee(t))throw TypeError("params must be a plain object");Z(this.issuer,"authorization_endpoint");let r=new R(this.issuer.authorization_endpoint);for(let[c,u]of Object.entries(authorizationParams.call(this,t)))if(Array.isArray(u))for(let t of(r.searchParams.delete(c),u))r.searchParams.append(c,t);else r.searchParams.set(c,u);return r.href.replace(/\+/g,"%20")}authorizationPost(t={}){if(!ee(t))throw TypeError("params must be a plain object");let r=authorizationParams.call(this,t),c=Object.keys(r).map(t=>`<input type="hidden" name="${t}" value="${r[t]}"/>`).join("\n");return`<!DOCTYPE html>
<head>
<title>Requesting Authorization</title>
</head>
<body onload="javascript:document.forms[0].submit()">
<form method="post" action="${this.issuer.authorization_endpoint}">
  ${c}
</form>
</body>
</html>`}endSessionUrl(t={}){let r;Z(this.issuer,"end_session_endpoint");let{0:c,length:u}=this.post_logout_redirect_uris||[],{post_logout_redirect_uri:E=1===u?c:void 0}=t;if({id_token_hint:r,...t}=t,r instanceof er){if(!r.id_token)throw TypeError("id_token not present in TokenSet");r=r.id_token}let P=K.parse(this.issuer.end_session_endpoint),O=V(getSearchParams(this.issuer.end_session_endpoint),t,{post_logout_redirect_uri:E,client_id:this.client_id},{id_token_hint:r});return Object.entries(O).forEach(([t,r])=>{null==r&&delete O[t]}),P.search=null,P.query=O,K.format(P)}callbackParams(t){let r=t instanceof P.IncomingMessage||t&&t.method&&t.url,c="string"==typeof t;if(!c&&!r)throw TypeError("#callbackParams only accepts string urls, http.IncomingMessage or a lookalike");if(!r)return pickCb(getSearchParams(t));switch(t.method){case"GET":return pickCb(getSearchParams(t.url));case"POST":if(void 0===t.body)throw TypeError("incoming message body missing, include a body parser prior to this method call");switch(typeof t.body){case"object":case"string":if(Buffer.isBuffer(t.body))return pickCb(W.parse(t.body.toString("utf-8")));if("string"==typeof t.body)return pickCb(W.parse(t.body));return pickCb(t.body);default:throw TypeError("invalid IncomingMessage body object")}default:throw TypeError("invalid IncomingMessage method")}}async callback(t,r,c={},{exchangeBody:u,clientAssertionPayload:E,DPoP:P}={}){let O=pickCb(r);if(!c.jarm||"response"in r){if("response"in r){let t=await this.decryptJARM(O.response);O=await this.validateJARM(t)}}else throw new ei({message:"expected a JARM response",checks:c,params:O});if(this.default_max_age&&!c.max_age&&(c.max_age=this.default_max_age),O.state&&!c.state)throw TypeError("checks.state argument is missing");if(!O.state&&c.state)throw new ei({message:"state missing from the response",checks:c,params:O});if(c.state!==O.state)throw new ei({printf:["state mismatch, expected %s, got: %s",c.state,O.state],checks:c,params:O});if("iss"in O){if(Z(this.issuer,"issuer"),O.iss!==this.issuer.issuer)throw new ei({printf:["iss mismatch, expected %s, got: %s",this.issuer.issuer,O.iss],params:O})}else if(this.issuer.authorization_response_iss_parameter_supported&&!("id_token"in O)&&!("response"in r))throw new ei({message:"iss missing from the response",params:O});if(O.error)throw new en(O);let J={code:["code"],id_token:["id_token"],token:["access_token","token_type"]};if(c.response_type){for(let t of c.response_type.split(" "))if("none"===t){if(O.code||O.id_token||O.access_token)throw new ei({message:'unexpected params encountered for "none" response',checks:c,params:O})}else for(let r of J[t])if(!O[r])throw new ei({message:`${r} missing from response`,checks:c,params:O})}if(O.id_token){let t=new er(O);if(await this.decryptIdToken(t),await this.validateIdToken(t,c.nonce,"authorization",c.max_age,c.state),!O.code)return t}if(O.code){let r=await this.grant({...u,grant_type:"authorization_code",code:O.code,redirect_uri:t,code_verifier:c.code_verifier},{clientAssertionPayload:E,DPoP:P});return await this.decryptIdToken(r),await this.validateIdToken(r,c.nonce,"token",c.max_age),O.session_state&&(r.session_state=O.session_state),r}return new er(O)}async oauthCallback(t,r,c={},{exchangeBody:u,clientAssertionPayload:E,DPoP:P}={}){let O=pickCb(r);if(!c.jarm||"response"in r){if("response"in r){let t=await this.decryptJARM(O.response);O=await this.validateJARM(t)}}else throw new ei({message:"expected a JARM response",checks:c,params:O});if(O.state&&!c.state)throw TypeError("checks.state argument is missing");if(!O.state&&c.state)throw new ei({message:"state missing from the response",checks:c,params:O});if(c.state!==O.state)throw new ei({printf:["state mismatch, expected %s, got: %s",c.state,O.state],checks:c,params:O});if("iss"in O){if(Z(this.issuer,"issuer"),O.iss!==this.issuer.issuer)throw new ei({printf:["iss mismatch, expected %s, got: %s",this.issuer.issuer,O.iss],params:O})}else if(this.issuer.authorization_response_iss_parameter_supported&&!("id_token"in O)&&!("response"in r))throw new ei({message:"iss missing from the response",params:O});if(O.error)throw new en(O);if("string"==typeof O.id_token&&O.id_token.length)throw new ei({message:"id_token detected in the response, you must use client.callback() instead of client.oauthCallback()",params:O});delete O.id_token;let J={code:["code"],token:["access_token","token_type"]};if(c.response_type)for(let t of c.response_type.split(" ")){if("none"===t&&(O.code||O.id_token||O.access_token))throw new ei({message:'unexpected params encountered for "none" response',checks:c,params:O});if(J[t]){for(let r of J[t])if(!O[r])throw new ei({message:`${r} missing from response`,checks:c,params:O})}}if(O.code){let r=await this.grant({...u,grant_type:"authorization_code",code:O.code,redirect_uri:t,code_verifier:c.code_verifier},{clientAssertionPayload:E,DPoP:P});if("string"==typeof r.id_token&&r.id_token.length)throw new ei({message:"id_token detected in the response, you must use client.callback() instead of client.oauthCallback()",params:O});return delete r.id_token,r}return new er(O)}async decryptIdToken(t){if(!this.id_token_encrypted_response_alg)return t;let r=t;if(r instanceof er){if(!r.id_token)throw TypeError("id_token not present in TokenSet");r=r.id_token}let c=this.id_token_encrypted_response_alg,u=this.id_token_encrypted_response_enc,E=await this.decryptJWE(r,c,u);return t instanceof er?(t.id_token=E,t):E}async validateJWTUserinfo(t){let r=this.userinfo_signed_response_alg;return this.validateJWT(t,r,[])}async decryptJARM(t){if(!this.authorization_encrypted_response_alg)return t;let r=this.authorization_encrypted_response_alg,c=this.authorization_encrypted_response_enc;return this.decryptJWE(t,r,c)}async decryptJWTUserinfo(t){if(!this.userinfo_encrypted_response_alg)return t;let r=this.userinfo_encrypted_response_alg,c=this.userinfo_encrypted_response_enc;return this.decryptJWE(t,r,c)}async decryptJWE(t,r,c="A128CBC-HS256"){let u;let E=JSON.parse(G.decode(t.split(".")[0]));if(E.alg!==r)throw new ei({printf:["unexpected JWE alg received, expected %s, got: %s",r,E.alg],jwt:t});if(E.enc!==c)throw new ei({printf:["unexpected JWE enc received, expected %s, got: %s",c,E.enc],jwt:t});let getPlaintext=t=>new TextDecoder().decode(t.plaintext);if(r.match(/^(?:RSA|ECDH)/)){let r=await el.get(this),c=D.decodeProtectedHeader(t);for(let E of r.all({...c,use:"enc"}))if(u=await D.compactDecrypt(t,await E.keyObject(c.alg)).then(getPlaintext,()=>{}))break}else u=await D.compactDecrypt(t,this.secretForAlg("dir"===r?c:r)).then(getPlaintext,()=>{});if(!u)throw new ei({message:"failed to decrypt JWE",jwt:t});return u}async validateIdToken(t,r,c,u,E){let P=t,O=this.id_token_signed_response_alg,J=P instanceof er;if(J){if(!P.id_token)throw TypeError("id_token not present in TokenSet");P=P.id_token}P=String(P);let W=eo(),{protected:K,payload:R,key:U}=await this.validateJWT(P,O);if("number"==typeof u||u!==eS&&this.require_auth_time){if(!R.auth_time)throw new ei({message:"missing required JWT property auth_time",jwt:P});if("number"!=typeof R.auth_time)throw new ei({message:"JWT auth_time claim must be a JSON numeric value",jwt:P})}if("number"==typeof u&&R.auth_time+u<W-this[ec])throw new ei({printf:["too much time has elapsed since the last End-User authentication, max_age %i, auth_time: %i, now %i",u,R.auth_time,W-this[ec]],now:W,tolerance:this[ec],auth_time:R.auth_time,jwt:P});if(r!==eb&&(R.nonce||void 0!==r)&&R.nonce!==r)throw new ei({printf:["nonce mismatch, expected %s, got: %s",r,R.nonce],jwt:P});if("authorization"===c){if(!R.at_hash&&t.access_token)throw new ei({message:"missing required property at_hash",jwt:P});if(!R.c_hash&&t.code)throw new ei({message:"missing required property c_hash",jwt:P});if(this.fapi1()&&!R.s_hash&&(t.state||E))throw new ei({message:"missing required property s_hash",jwt:P});if(R.s_hash){if(!E)throw TypeError('cannot verify s_hash, "checks.state" property not provided');try{B.validate({claim:"s_hash",source:"state"},R.s_hash,E,K.alg,U.jwk&&U.jwk.crv)}catch(t){throw new ei({message:t.message,jwt:P})}}}if(this.fapi()&&R.iat<W-3600)throw new ei({printf:["JWT issued too far in the past, now %i, iat %i",W,R.iat],now:W,tolerance:this[ec],iat:R.iat,jwt:P});if(t.access_token&&void 0!==R.at_hash)try{B.validate({claim:"at_hash",source:"access_token"},R.at_hash,t.access_token,K.alg,U.jwk&&U.jwk.crv)}catch(t){throw new ei({message:t.message,jwt:P})}if(t.code&&void 0!==R.c_hash)try{B.validate({claim:"c_hash",source:"code"},R.c_hash,t.code,K.alg,U.jwk&&U.jwk.crv)}catch(t){throw new ei({message:t.message,jwt:P})}return t}async validateJWT(t,r,c=["iss","sub","aud","exp","iat"]){let u,E,P;let O="https://self-issued.me"===this.issuer.issuer,W=eo();try{({header:u,payload:E}=q(t,{complete:!0}))}catch(r){throw new ei({printf:["failed to decode JWT (%s: %s)",r.name,r.message],jwt:t})}if(u.alg!==r)throw new ei({printf:["unexpected JWT alg received, expected %s, got: %s",r,u.alg],jwt:t});if(O&&(c=[...c,"sub_jwk"]),c.forEach(verifyPresence.bind(void 0,E,t)),void 0!==E.iss){let r=this.issuer.issuer;if(this.#r&&(r=this.issuer.issuer.replace("{tenantid}",E.tid)),E.iss!==r)throw new ei({printf:["unexpected iss value, expected %s, got: %s",r,E.iss],jwt:t})}if(void 0!==E.iat&&"number"!=typeof E.iat)throw new ei({message:"JWT iat claim must be a JSON numeric value",jwt:t});if(void 0!==E.nbf){if("number"!=typeof E.nbf)throw new ei({message:"JWT nbf claim must be a JSON numeric value",jwt:t});if(E.nbf>W+this[ec])throw new ei({printf:["JWT not active yet, now %i, nbf %i",W+this[ec],E.nbf],now:W,tolerance:this[ec],nbf:E.nbf,jwt:t})}if(void 0!==E.exp){if("number"!=typeof E.exp)throw new ei({message:"JWT exp claim must be a JSON numeric value",jwt:t});if(W-this[ec]>=E.exp)throw new ei({printf:["JWT expired, now %i, exp %i",W-this[ec],E.exp],now:W,tolerance:this[ec],exp:E.exp,jwt:t})}if(void 0!==E.aud){if(Array.isArray(E.aud)){if(E.aud.length>1&&!E.azp)throw new ei({message:"missing required JWT property azp",jwt:t});if(!E.aud.includes(this.client_id))throw new ei({printf:["aud is missing the client_id, expected %s to be included in %j",this.client_id,E.aud],jwt:t})}else if(E.aud!==this.client_id)throw new ei({printf:["aud mismatch, expected %s, got: %s",this.client_id,E.aud],jwt:t})}if(void 0!==E.azp){let r=this.#n;if(!(r="string"==typeof r?[this.client_id,r]:Array.isArray(r)?[this.client_id,...r]:[this.client_id]).includes(E.azp))throw new ei({printf:["azp mismatch, got: %s",E.azp],jwt:t})}if(O){try{J(ee(E.sub_jwk));let t=await D.importJWK(E.sub_jwk,u.alg);J.equal(t.type,"public"),P=[{keyObject:()=>t}]}catch(r){throw new ei({message:"failed to use sub_jwk claim as an asymmetric JSON Web Key",jwt:t})}if(await D.calculateJwkThumbprint(E.sub_jwk)!==E.sub)throw new ei({message:"failed to match the subject with sub_jwk",jwt:t})}else u.alg.startsWith("HS")?P=[this.secretForAlg(u.alg)]:"none"!==u.alg&&(P=await ey.call(this.issuer,{...u,use:"sig"}));if(!P&&"none"===u.alg)return{protected:u,payload:E};for(let r of P){let c=await D.compactVerify(t,r instanceof Uint8Array?r:await r.keyObject(u.alg)).catch(()=>{});if(c)return{payload:E,protected:c.protectedHeader,key:r}}throw new ei({message:"failed to validate JWT signature",jwt:t})}async refresh(t,{exchangeBody:r,clientAssertionPayload:c,DPoP:u}={}){let E=t;if(E instanceof er){if(!E.refresh_token)throw TypeError("refresh_token not present in TokenSet");E=E.refresh_token}let P=await this.grant({...r,grant_type:"refresh_token",refresh_token:String(E)},{clientAssertionPayload:c,DPoP:u});if(P.id_token&&(await this.decryptIdToken(P),await this.validateIdToken(P,eb,"token",eS),t instanceof er&&t.id_token)){let r=t.claims().sub,c=P.claims().sub;if(c!==r)throw new ei({printf:["sub mismatch, expected %s, got: %s",r,c],jwt:P.id_token})}return P}async requestResource(t,r,{method:c,headers:u,body:E,DPoP:P,tokenType:O=P?"DPoP":r instanceof er?r.token_type:"Bearer"}={},J){if(r instanceof er){if(!r.access_token)throw TypeError("access_token not present in TokenSet");r=r.access_token}if(r){if("string"!=typeof r)throw TypeError("invalid access token provided")}else throw TypeError("no access token provided");let W={headers:{Authorization:authorizationHeaderValue(r,O),...u},body:E},K=!!this.tls_client_certificate_bound_access_tokens,R=await es.call(this,{...W,responseType:"buffer",method:c,url:t},{accessToken:r,mTLS:K,DPoP:P}),U=R.headers["www-authenticate"];return J!==ew&&U&&U.toLowerCase().startsWith("dpop ")&&"use_dpop_nonce"===X(U).error?this.requestResource(t,r,{method:c,headers:u,body:E,DPoP:P,tokenType:O}):R}async userinfo(t,{method:r="GET",via:c="header",tokenType:u,params:E,DPoP:P}={}){let O;Z(this.issuer,"userinfo_endpoint");let W={tokenType:u,method:String(r).toUpperCase(),DPoP:P};if("GET"!==W.method&&"POST"!==W.method)throw TypeError("#userinfo() method can only be POST or a GET");if("body"===c&&"POST"!==W.method)throw TypeError("can only send body on POST");let K=!!(this.userinfo_signed_response_alg||this.userinfo_encrypted_response_alg);K?W.headers={Accept:"application/jwt"}:W.headers={Accept:"application/json"};let D=!!this.tls_client_certificate_bound_access_tokens;D&&this.issuer.mtls_endpoint_aliases&&(O=this.issuer.mtls_endpoint_aliases.userinfo_endpoint),O=new R(O||this.issuer.userinfo_endpoint),"body"===c&&(W.headers.Authorization=void 0,W.headers["Content-Type"]="application/x-www-form-urlencoded",W.body=new U,W.body.append("access_token",t instanceof er?t.access_token:t)),E&&("GET"===W.method?Object.entries(E).forEach(([t,r])=>{O.searchParams.append(t,r)}):W.body?Object.entries(E).forEach(([t,r])=>{W.body.append(t,r)}):(W.body=new U,W.headers["Content-Type"]="application/x-www-form-urlencoded",Object.entries(E).forEach(([t,r])=>{W.body.append(t,r)}))),W.body&&(W.body=W.body.toString());let B=await this.requestResource(O,t,W),F=et(B,{bearer:!0});if(K){if(!/^application\/jwt/.test(B.headers["content-type"]))throw new ei({message:"expected application/jwt response from the userinfo_endpoint",response:B});let t=B.body.toString(),r=await this.decryptJWTUserinfo(t);if(this.userinfo_signed_response_alg)({payload:F}=await this.validateJWTUserinfo(r));else try{F=JSON.parse(r),J(ee(F))}catch(t){throw new ei({message:"failed to parse userinfo JWE payload as JSON",jwt:r})}}else try{F=JSON.parse(B.body)}catch(t){throw Object.defineProperty(t,"response",{value:B}),t}if(t instanceof er&&t.id_token){let r=t.claims().sub;if(F.sub!==r)throw new ei({printf:["userinfo sub mismatch, expected %s, got: %s",r,F.sub],body:F,jwt:t.id_token})}return F}encryptionSecret(t){let r=t<=256?"sha256":t<=384?"sha384":t<=512&&"sha512";if(!r)throw Error("unsupported symmetric encryption key derivation");return O.createHash(r).update(this.client_secret).digest().slice(0,t/8)}secretForAlg(t){if(!this.client_secret)throw TypeError("client_secret is required");return/^A(\d{3})(?:GCM)?KW$/.test(t)?this.encryptionSecret(parseInt(RegExp.$1,10)):/^A(\d{3})(?:GCM|CBC-HS(\d{3}))$/.test(t)?this.encryptionSecret(parseInt(RegExp.$2||RegExp.$1,10)):new TextEncoder().encode(this.client_secret)}async grant(t,{clientAssertionPayload:r,DPoP:c}={},u){let E;Z(this.issuer,"token_endpoint");let P=await ep.call(this,"token",{form:t,responseType:"json"},{clientAssertionPayload:r,DPoP:c});try{E=et(P)}catch(E){if(u!==ew&&E instanceof en&&"use_dpop_nonce"===E.error)return this.grant(t,{clientAssertionPayload:r,DPoP:c},ew);throw E}return new er(E)}async deviceAuthorization(t={},{exchangeBody:r,clientAssertionPayload:c,DPoP:u}={}){Z(this.issuer,"device_authorization_endpoint"),Z(this.issuer,"token_endpoint");let E=authorizationParams.call(this,{client_id:this.client_id,redirect_uri:null,response_type:null,...t}),P=await ep.call(this,"device_authorization",{responseType:"json",form:E},{clientAssertionPayload:c,endpointAuthMethod:"token"}),O=et(P);return new eg({client:this,exchangeBody:r,clientAssertionPayload:c,response:O,maxAge:t.max_age,DPoP:u})}async revoke(t,r,{revokeBody:c,clientAssertionPayload:u}={}){if(Z(this.issuer,"revocation_endpoint"),void 0!==r&&"string"!=typeof r)throw TypeError("hint must be a string");let E={...c,token:t};r&&(E.token_type_hint=r);let P=await ep.call(this,"revocation",{form:E},{clientAssertionPayload:u});et(P,{body:!1})}async introspect(t,r,{introspectBody:c,clientAssertionPayload:u}={}){if(Z(this.issuer,"introspection_endpoint"),void 0!==r&&"string"!=typeof r)throw TypeError("hint must be a string");let E={...c,token:t};r&&(E.token_type_hint=r);let P=await ep.call(this,"introspection",{form:E,responseType:"json"},{clientAssertionPayload:u}),O=et(P);return O}static async register(t,r={}){let{initialAccessToken:c,jwks:u,...E}=r;if(Z(this.issuer,"registration_endpoint"),void 0!==u&&!(t.jwks||t.jwks_uri)){let r=await getKeystore.call(this,u);t.jwks=r.toJWKS()}let P=await es.call(this,{headers:{Accept:"application/json",...c?{Authorization:authorizationHeaderValue(c)}:void 0},responseType:"json",json:t,url:this.issuer.registration_endpoint,method:"POST"}),O=et(P,{statusCode:201,bearer:!0});return new this(O,u,E)}get metadata(){return eu(Object.fromEntries(this.#e.entries()))}static async fromUri(t,r,c,u){let E=await es.call(this,{method:"GET",url:t,responseType:"json",headers:{Authorization:authorizationHeaderValue(r),Accept:"application/json"}}),P=et(E,{bearer:!0});return new this(P,c,u)}async requestObject(t={},{sign:r=this.request_object_signing_alg||"none",encrypt:{alg:c=this.request_object_encryption_alg,enc:u=this.request_object_encryption_enc||"A128CBC-HS256"}={}}={}){let E,P;if(!ee(t))throw TypeError("requestObject must be a plain object");let O=eo(),J={alg:r,typ:"oauth-authz-req+jwt"},W=JSON.stringify(V({},t,{iss:this.client_id,aud:this.issuer.issuer,client_id:this.client_id,jti:ea(),iat:O,exp:O+300,...this.fapi()?{nbf:O}:void 0}));if("none"===r)E=[G.encode(JSON.stringify(J)),G.encode(W),""].join(".");else{let t=r.startsWith("HS");if(t)P=this.secretForAlg(r);else{let t=await el.get(this);if(!t)throw TypeError(`no keystore present for client, cannot sign using alg ${r}`);if(!(P=t.get({alg:r,use:"sig"})))throw TypeError(`no key to sign with found for alg ${r}`)}E=await new D.CompactSign(new TextEncoder().encode(W)).setProtectedHeader({...J,kid:t?void 0:P.jwk.kid}).sign(t?P:await P.keyObject(r))}if(!c)return E;let K={alg:c,enc:u,cty:"oauth-authz-req+jwt"};return K.alg.match(/^(RSA|ECDH)/)?[P]=await ey.call(this.issuer,{alg:K.alg,use:"enc"},{allowMulti:!0}):P=this.secretForAlg("dir"===K.alg?K.enc:K.alg),new D.CompactEncrypt(new TextEncoder().encode(E)).setProtectedHeader({...K,kid:P instanceof Uint8Array?void 0:P.jwk.kid}).encrypt(P instanceof Uint8Array?P:await P.keyObject(K.alg))}async pushedAuthorizationRequest(t={},{clientAssertionPayload:r}={}){Z(this.issuer,"pushed_authorization_request_endpoint");let c={..."request"in t?t:authorizationParams.call(this,t),client_id:this.client_id},u=await ep.call(this,"pushed_authorization_request",{responseType:"json",form:c},{clientAssertionPayload:r,endpointAuthMethod:"token"}),E=et(u,{statusCode:201});if(!("expires_in"in E))throw new ei({message:"expected expires_in in Pushed Authorization Successful Response",response:u});if("number"!=typeof E.expires_in)throw new ei({message:"invalid expires_in value in Pushed Authorization Successful Response",response:u});if(!("request_uri"in E))throw new ei({message:"expected request_uri in Pushed Authorization Successful Response",response:u});if("string"!=typeof E.request_uri)throw new ei({message:"invalid request_uri value in Pushed Authorization Successful Response",response:u});return E}get issuer(){return this.#t}[E.custom](){return`${this.constructor.name} ${E(this.metadata,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}fapi(){return this.fapi1()||this.fapi2()}fapi1(){return"FAPI1Client"===this.constructor.name}fapi2(){return"FAPI2Client"===this.constructor.name}async validateJARM(t){let r=this.authorization_signed_response_alg,{payload:c}=await this.validateJWT(t,r,["iss","exp","aud"]);return pickCb(c)}async dpopProof(t,r,c){let E;if(!ee(t))throw TypeError("payload must be a plain object");if(F(r))E=r;else if("CryptoKey"===r[Symbol.toStringTag])E=r;else if("node:crypto"===D.cryptoRuntime)E=O.createPrivateKey(r);else throw TypeError("unrecognized crypto runtime");if("private"!==E.type)throw TypeError('"DPoP" option must be a private key');let P=u.call(this,E,r);if(!P)throw TypeError("could not determine DPoP JWS Algorithm");return new D.SignJWT({ath:c?G.encode(O.createHash("sha256").update(c).digest()):void 0,...t}).setProtectedHeader({alg:P,typ:"dpop+jwt",jwk:await getJwk(E,r)}).setIssuedAt().setJti(ea()).sign(E)}};function determineDPoPAlgorithmFromCryptoKey(t){switch(t.algorithm.name){case"Ed25519":case"Ed448":return"EdDSA";case"ECDSA":switch(t.algorithm.namedCurve){case"P-256":return"ES256";case"P-384":return"ES384";case"P-521":return"ES512"}break;case"RSASSA-PKCS1-v1_5":return`RS${t.algorithm.hash.name.slice(4)}`;case"RSA-PSS":return`PS${t.algorithm.hash.name.slice(4)}`;default:throw TypeError("unsupported DPoP private key")}}if("node:crypto"===D.cryptoRuntime){u=function(t,r){if("CryptoKey"===r[Symbol.toStringTag])return determineDPoPAlgorithmFromCryptoKey(t);switch(t.asymmetricKeyType){case"ed25519":case"ed448":return"EdDSA";case"ec":return determineEcAlgorithm(t,r);case"rsa":case ev&&"rsa-pss":return determineRsaAlgorithm(t,r,this.issuer.dpop_signing_alg_values_supported);default:throw TypeError("unsupported DPoP private key")}};let t=/^(?:RS|PS)(?:256|384|512)$/;function determineRsaAlgorithm(r,c,u){if("object"==typeof c&&"jwk"===c.format&&c.key&&c.key.alg)return c.key.alg;if(Array.isArray(u)){let c=u.filter(RegExp.prototype.test.bind(t));return"rsa-pss"===r.asymmetricKeyType&&(c=c.filter(t=>t.startsWith("PS"))),["PS256","PS384","PS512","RS256","RS384","RS384"].find(t=>c.includes(t))}return"PS256"}let r=Buffer.from([42,134,72,206,61,3,1,7]),c=Buffer.from([43,129,4,0,34]),E=Buffer.from([43,129,4,0,35]),P=Buffer.from([43,129,4,0,10]);function determineEcAlgorithm(t,u){switch("object"==typeof u&&"object"==typeof u.key&&u.key.crv){case"P-256":return"ES256";case"secp256k1":return"ES256K";case"P-384":return"ES384";case"P-512":return"ES512"}let O=t.export({format:"der",type:"pkcs8"}),J=O[1]<128?17:18,W=O[J],K=O.slice(J+1,J+1+W);if(K.equals(r))return"ES256";if(K.equals(c))return"ES384";if(K.equals(E))return"ES512";if(K.equals(P))return"ES256K";throw TypeError("unsupported DPoP private key curve")}}else u=determineDPoPAlgorithmFromCryptoKey;let eE=new WeakMap;async function getJwk(t,r){if("node:crypto"===D.cryptoRuntime&&"object"==typeof r&&"object"==typeof r.key&&"jwk"===r.format)return Q(r.key,"kty","crv","x","y","e","n");if(eE.has(r))return eE.get(r);let c=Q(await D.exportJWK(t),"kty","crv","x","y","e","n");return(F(r)||"WebCryptoAPI"===D.cryptoRuntime)&&eE.set(r,c),c}t.exports=(t,r=!1)=>class extends BaseClient{constructor(...c){super(t,r,...c)}static get issuer(){return t}},t.exports.BaseClient=BaseClient},67688:(t,r,c)=>{"use strict";let{inspect:u}=c(73837),{RPError:E,OPError:P}=c(10574),O=c(91624);let DeviceFlowHandle=class DeviceFlowHandle{#i;#o;#a;#s;#c;#l;#d;#u;#p;constructor({client:t,exchangeBody:r,clientAssertionPayload:c,response:u,maxAge:P,DPoP:J}){if(["verification_uri","user_code","device_code"].forEach(t=>{if("string"!=typeof u[t]||!u[t])throw new E(`expected ${t} string to be returned by Device Authorization Response, got %j`,u[t])}),!Number.isSafeInteger(u.expires_in))throw new E("expected expires_in number to be returned by Device Authorization Response, got %j",u.expires_in);this.#l=O()+u.expires_in,this.#o=t,this.#s=J,this.#u=P,this.#c=r,this.#a=c,this.#p=u,this.#d=1e3*u.interval||5e3}abort(){this.#i=!0}async poll({signal:t}={}){let r;if(t&&t.aborted||this.#i)throw new E("polling aborted");if(this.expired())throw new E("the device code %j has expired and the device authorization session has concluded",this.device_code);await new Promise(t=>setTimeout(t,this.#d));try{r=await this.#o.grant({...this.#c,grant_type:"urn:ietf:params:oauth:grant-type:device_code",device_code:this.device_code},{clientAssertionPayload:this.#a,DPoP:this.#s})}catch(r){switch(r instanceof P&&r.error){case"slow_down":this.#d+=5e3;case"authorization_pending":return this.poll({signal:t});default:throw r}}return"id_token"in r&&(await this.#o.decryptIdToken(r),await this.#o.validateIdToken(r,void 0,"token",this.#u)),r}get device_code(){return this.#p.device_code}get user_code(){return this.#p.user_code}get verification_uri(){return this.#p.verification_uri}get verification_uri_complete(){return this.#p.verification_uri_complete}get expires_in(){return Math.max.apply(null,[this.#l-O(),0])}expired(){return 0===this.expires_in}[u.custom](){return`${this.constructor.name} ${u(this.#p,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}};t.exports=DeviceFlowHandle},10574:(t,r,c)=>{"use strict";let{format:u}=c(73837);let OPError=class OPError extends Error{constructor({error_description:t,error:r,error_uri:c,session_state:u,state:E,scope:P},O){super(t?`${r} (${t})`:r),Object.assign(this,{error:r},t&&{error_description:t},c&&{error_uri:c},E&&{state:E},P&&{scope:P},u&&{session_state:u}),O&&Object.defineProperty(this,"response",{value:O}),this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor)}};let RPError=class RPError extends Error{constructor(...t){if("string"==typeof t[0])super(u(...t));else{let{message:r,printf:c,response:E,...P}=t[0];c?super(u(...c)):super(r),Object.assign(this,P),E&&Object.defineProperty(this,"response",{value:E})}this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor)}};t.exports={OPError,RPError}},36245:t=>{"use strict";function assertSigningAlgValuesSupport(t,r,c){if(!r[`${t}_endpoint`])return;let u=`${t}_endpoint_auth_method`,E=`${t}_endpoint_auth_signing_alg`,P=`${t}_endpoint_auth_signing_alg_values_supported`;if(c[u]&&c[u].endsWith("_jwt")&&!c[E]&&!r[P])throw TypeError(`${P} must be configured on the issuer if ${E} is not defined on a client`)}function assertIssuerConfiguration(t,r){if(!t[r])throw TypeError(`${r} must be configured on the issuer`)}t.exports={assertSigningAlgValuesSupport,assertIssuerConfiguration}},26597:t=>{"use strict";let r;if(Buffer.isEncoding("base64url"))r=(t,r="utf8")=>Buffer.from(t,r).toString("base64url");else{let fromBase64=t=>t.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");r=(t,r="utf8")=>fromBase64(Buffer.from(t,r).toString("base64"))}t.exports.decode=t=>Buffer.from(t,"base64"),t.exports.encode=r},98522:(t,r,c)=>{"use strict";let u=c(84664),{RPError:E}=c(10574),{assertIssuerConfiguration:P}=c(36245),{random:O}=c(29766),J=c(91624),W=c(3135),{keystores:K}=c(18763),R=c(18038),formUrlEncode=t=>encodeURIComponent(t).replace(/%20/g,"+");async function clientAssertion(t,r){let c=this[`${t}_endpoint_auth_signing_alg`];if(c||P(this.issuer,`${t}_endpoint_auth_signing_alg_values_supported`),"client_secret_jwt"===this[`${t}_endpoint_auth_method`]){if(!c){let r=this.issuer[`${t}_endpoint_auth_signing_alg_values_supported`];c=Array.isArray(r)&&r.find(t=>/^HS(?:256|384|512)/.test(t))}if(!c)throw new E(`failed to determine a JWS Algorithm to use for ${this[`${t}_endpoint_auth_method`]} Client Assertion`);return new u.CompactSign(Buffer.from(JSON.stringify(r))).setProtectedHeader({alg:c}).sign(this.secretForAlg(c))}let O=await K.get(this);if(!O)throw TypeError("no client jwks provided for signing a client assertion with");if(!c){let r=this.issuer[`${t}_endpoint_auth_signing_alg_values_supported`];c=Array.isArray(r)&&r.find(t=>O.get({alg:t,use:"sig"}))}if(!c)throw new E(`failed to determine a JWS Algorithm to use for ${this[`${t}_endpoint_auth_method`]} Client Assertion`);let J=O.get({alg:c,use:"sig"});if(!J)throw new E(`no key found in client jwks to sign a client assertion with using alg ${c}`);return new u.CompactSign(Buffer.from(JSON.stringify(r))).setProtectedHeader({alg:c,kid:J.jwk&&J.jwk.kid}).sign(await J.keyObject(c))}async function authFor(t,{clientAssertionPayload:r}={}){let c=this[`${t}_endpoint_auth_method`];switch(c){case"self_signed_tls_client_auth":case"tls_client_auth":case"none":return{form:{client_id:this.client_id}};case"client_secret_post":if("string"!=typeof this.client_secret)throw TypeError("client_secret_post client authentication method requires a client_secret");return{form:{client_id:this.client_id,client_secret:this.client_secret}};case"private_key_jwt":case"client_secret_jwt":{let c=J(),u=await clientAssertion.call(this,t,{iat:c,exp:c+60,jti:O(),iss:this.client_id,sub:this.client_id,aud:this.issuer.issuer,...r});return{form:{client_id:this.client_id,client_assertion:u,client_assertion_type:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer"}}}case"client_secret_basic":{if("string"!=typeof this.client_secret)throw TypeError("client_secret_basic client authentication method requires a client_secret");let t=`${formUrlEncode(this.client_id)}:${formUrlEncode(this.client_secret)}`,r=Buffer.from(t).toString("base64");return{headers:{Authorization:`Basic ${r}`}}}default:throw TypeError(`missing, or unsupported, ${t}_endpoint_auth_method`)}}function resolveResponseType(){let{length:t,0:r}=this.response_types;if(1===t)return r}function resolveRedirectUri(){let{length:t,0:r}=this.redirect_uris||[];if(1===t)return r}async function authenticatedPost(t,r,{clientAssertionPayload:c,endpointAuthMethod:u=t,DPoP:E}={}){let P;let O=await authFor.call(this,u,{clientAssertionPayload:c}),J=R(r,O),K=this[`${u}_endpoint_auth_method`].includes("tls_client_auth")||"token"===t&&this.tls_client_certificate_bound_access_tokens;if(K&&this.issuer.mtls_endpoint_aliases&&(P=this.issuer.mtls_endpoint_aliases[`${t}_endpoint`]),P=P||this.issuer[`${t}_endpoint`],"form"in J)for(let[t,r]of Object.entries(J.form))void 0===r&&delete J.form[t];return W.call(this,{...J,method:"POST",url:P,headers:{..."revocation"!==t?{Accept:"application/json"}:void 0,...J.headers}},{mTLS:K,DPoP:E})}t.exports={resolveResponseType,resolveRedirectUri,authFor,authenticatedPost}},60577:t=>{"use strict";let r=Symbol(),c=Symbol();t.exports={CLOCK_TOLERANCE:c,HTTP_OPTIONS:r}},44759:(t,r,c)=>{"use strict";let u=c(26597);t.exports=t=>{if("string"!=typeof t||!t)throw TypeError("JWT must be a string");let{0:r,1:c,2:E,length:P}=t.split(".");if(5===P)throw TypeError("encrypted JWTs cannot be decoded");if(3!==P)throw Error("JWTs must have three components");try{return{header:JSON.parse(u.decode(r)),payload:JSON.parse(u.decode(c)),signature:E}}catch(t){throw Error("JWT is malformed")}}},68979:t=>{"use strict";t.exports=globalThis.structuredClone||(t=>JSON.parse(JSON.stringify(t)))},81772:(t,r,c)=>{"use strict";let u=c(13641);function defaults(t,r,...c){for(let E of c)if(u(E))for(let[c,P]of Object.entries(E))"__proto__"!==c&&"constructor"!==c&&(void 0===r[c]&&void 0!==P&&(r[c]=P),t&&u(r[c])&&u(P)&&defaults(!0,r[c],P));return r}t.exports=defaults.bind(void 0,!1),t.exports.deep=defaults.bind(void 0,!0)},29766:(t,r,c)=>{"use strict";let{createHash:u,randomBytes:E}=c(6113),P=c(26597),random=(t=32)=>P.encode(E(t));t.exports={random,state:random,nonce:random,codeVerifier:random,codeChallenge:t=>P.encode(u("sha256").update(t).digest())}},68060:(t,r,c)=>{"use strict";let u=c(73837),E=c(6113);t.exports=u.types.isKeyObject||(t=>t&&t instanceof E.KeyObject)},13641:t=>{"use strict";t.exports=t=>!!t&&t.constructor===Object},37875:(t,r,c)=>{"use strict";let u=c(84793),E=c(70557),{RPError:P}=c(10574),{assertIssuerConfiguration:O}=c(36245),J=c(73640),{keystores:W}=c(18763),K=c(7889),R=c(3135),U=new WeakMap,D=new WeakMap,lrus=t=>(D.has(t)||D.set(t,new E({max:100})),D.get(t));async function getKeyStore(t=!1){O(this,"jwks_uri");let r=W.get(this),c=lrus(this);return t||!r?(U.has(this)||(c.reset(),U.set(this,(async()=>{let t=await R.call(this,{method:"GET",responseType:"json",url:this.jwks_uri,headers:{Accept:"application/json, application/jwk-set+json"}}).finally(()=>{U.delete(this)}),r=K(t),u=J.fromJWKS(r,{onlyPublic:!0});return c.set("throttle",!0,6e4),W.set(this,u),u})())),U.get(this)):r}async function queryKeyStore({kid:t,kty:r,alg:c,use:E},{allowMulti:O=!1}={}){let J=lrus(this),W={kid:t,kty:r,alg:c,use:E},K=u(W,{algorithm:"sha256",ignoreUnknown:!0,unorderedArrays:!0,unorderedSets:!0,respectType:!1}),R=J.get(K)||J.get("throttle"),U=await getKeyStore.call(this,!R),D=U.all(W);if(delete W.use,0===D.length)throw new P({printf:["no valid key found in issuer's jwks_uri for key parameters %j",W],jwks:U});if(!O&&D.length>1&&!t)throw new P({printf:["multiple matching keys found in issuer's jwks_uri for key parameters %j, kid must be provided in this case",W],jwks:U});return J.set(K,!0),D}t.exports.queryKeyStore=queryKeyStore,t.exports.keystore=getKeyStore},73640:(t,r,c)=>{"use strict";let u=c(84664),E=c(68979),P=c(13641),O=Symbol(),keyscore=(t,{alg:r,use:c})=>{let u=0;return r&&t.alg&&u++,c&&t.use&&u++,u};function getKtyFromAlg(t){switch("string"==typeof t&&t.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:return}}function getAlgorithms(t,r,c,E){if(r)return new Set([r]);switch(c){case"EC":{let r=[];if(("enc"===t||void 0===t)&&(r=r.concat(["ECDH-ES","ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW"])),"sig"===t||void 0===t)switch(E){case"P-256":case"P-384":r=r.concat([`ES${E.slice(-3)}`]);break;case"P-521":r=r.concat(["ES512"]);break;case"secp256k1":"node:crypto"===u.cryptoRuntime&&(r=r.concat(["ES256K"]))}return new Set(r)}case"OKP":return new Set(["ECDH-ES","ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW"]);case"RSA":{let r=[];return("enc"===t||void 0===t)&&(r=r.concat(["RSA-OAEP","RSA-OAEP-256","RSA-OAEP-384","RSA-OAEP-512"]),"node:crypto"===u.cryptoRuntime&&(r=r.concat(["RSA1_5"]))),("sig"===t||void 0===t)&&(r=r.concat(["PS256","PS384","PS512","RS256","RS384","RS512"])),new Set(r)}default:throw Error("unreachable")}}t.exports=class{#h;constructor(t,r){if(t!==O)throw Error("invalid constructor call");this.#h=r}toJWKS(){return{keys:this.map(({jwk:{d:t,p:r,q:c,dp:u,dq:E,qi:P,...O}})=>O)}}all({alg:t,kid:r,use:c}={}){if(!c||!t)throw Error();let u=getKtyFromAlg(t),E={alg:t,use:c};return this.filter(E=>{let P=!0;return void 0!==u&&E.jwk.kty!==u&&(P=!1),P&&void 0!==r&&E.jwk.kid!==r&&(P=!1),P&&void 0!==c&&void 0!==E.jwk.use&&E.jwk.use!==c&&(P=!1),P&&E.jwk.alg&&E.jwk.alg!==t?P=!1:E.algorithms.has(t)||(P=!1),P}).sort((t,r)=>keyscore(r,E)-keyscore(t,E))}get(...t){return this.all(...t)[0]}static async fromJWKS(t,{onlyPublic:r=!1,onlyPrivate:c=!1}={}){if(!P(t)||!Array.isArray(t.keys)||t.keys.some(t=>!P(t)||!("kty"in t)))throw TypeError("jwks must be a JSON Web Key Set formatted object");let J=[];for(let P of t.keys){P=E(P);let{kty:t,kid:O,crv:W}=P,{alg:K,use:R}=P;if("string"==typeof t&&t&&(void 0===R||"sig"===R||"enc"===R)&&("string"==typeof K||void 0===K)&&("string"==typeof O||void 0===O)){if("EC"===t&&"sig"===R)switch(W){case"P-256":K="ES256";break;case"P-384":K="ES384";break;case"P-521":K="ES512"}if("secp256k1"===W&&(R="sig",K="ES256K"),"OKP"===t)switch(W){case"Ed25519":case"Ed448":R="sig",K="EdDSA";break;case"X25519":case"X448":R="enc"}if(K&&!R)switch(!0){case K.startsWith("ECDH"):case K.startsWith("RSA"):R="enc"}if(c&&("oct"===P.kty||!P.d))throw Error("jwks must only contain private keys");r&&(P.d||P.k)||J.push({jwk:{...P,alg:K,use:R},async keyObject(t){if(this[t])return this[t];let r=await u.importJWK(this.jwk,t);return this[t]=r,r},get algorithms(){return Object.defineProperty(this,"algorithms",{value:getAlgorithms(this.jwk.use,this.jwk.alg,this.jwk.kty,this.jwk.crv),enumerable:!0,configurable:!1}),this.algorithms}})}}return new this(O,J)}filter(...t){return this.#h.filter(...t)}find(...t){return this.#h.find(...t)}every(...t){return this.#h.every(...t)}some(...t){return this.#h.some(...t)}map(...t){return this.#h.map(...t)}forEach(...t){return this.#h.forEach(...t)}reduce(...t){return this.#h.reduce(...t)}sort(...t){return this.#h.sort(...t)}*[Symbol.iterator](){for(let t of this.#h)yield t}}},18038:(t,r,c)=>{"use strict";let u=c(13641);function merge(t,...r){for(let c of r)if(u(c))for(let[r,E]of Object.entries(c))"__proto__"!==r&&"constructor"!==r&&(u(t[r])&&u(E)?t[r]=merge(t[r],E):void 0!==E&&(t[r]=E));return t}t.exports=merge},52542:t=>{"use strict";t.exports=function(t,...r){let c={};for(let u of r)void 0!==t[u]&&(c[u]=t[u]);return c}},7889:(t,r,c)=>{"use strict";let{STATUS_CODES:u}=c(13685),{format:E}=c(73837),{OPError:P}=c(10574),O=c(92102),throwAuthenticateErrors=t=>{let r=O(t.headers["www-authenticate"]);if(r.error)throw new P(r,t)},isStandardBodyError=t=>{let r=!1;try{let c;c="object"!=typeof t.body||Buffer.isBuffer(t.body)?JSON.parse(t.body):t.body,(r="string"==typeof c.error&&c.error.length)&&Object.defineProperty(t,"body",{value:c,configurable:!0})}catch(t){}return r};function processResponse(t,{statusCode:r=200,body:c=!0,bearer:O=!1}={}){if(t.statusCode!==r){if(O&&throwAuthenticateErrors(t),isStandardBodyError(t))throw new P(t.body,t);throw new P({error:E("expected %i %s, got: %i %s",r,u[r],t.statusCode,u[t.statusCode])},t)}if(c&&!t.body)throw new P({error:E("expected %i %s with body but no body was returned",r,u[r])},t);return t.body}t.exports=processResponse},3135:(t,r,c)=>{"use strict";let u;let E=c(39491),P=c(63477),O=c(13685),J=c(95687),{once:W}=c(82361),{URL:K}=c(57310),R=c(70557),U=c(87658),{RPError:D}=c(10574),B=c(52542),{deep:F}=c(81772),{HTTP_OPTIONS:q}=c(60577),G=/^[\x21\x23-\x5B\x5D-\x7E]+$/,V=["agent","ca","cert","crl","headers","key","lookup","passphrase","pfx","timeout"],setDefaults=(t,r)=>{u=F({},t.length?B(r,...t):r,u)};function send(t,r,c){c&&(t.removeHeader("content-type"),t.setHeader("content-type",c)),r&&(t.removeHeader("content-length"),t.setHeader("content-length",Buffer.byteLength(r)),t.write(r)),t.end()}setDefaults([],{headers:{"User-Agent":`${U.name}/${U.version} (${U.homepage})`,"Accept-Encoding":"identity"},timeout:3500});let X=new R({max:100});t.exports=async function(t,{accessToken:r,mTLS:c=!1,DPoP:R}={}){let U,Y,Z,Q,ee,et,er;try{U=new K(t.url),delete t.url,E(/^(https?:)$/.test(U.protocol))}catch(t){throw TypeError("only valid absolute URLs can be requested")}let en=this[q],ei=t,eo=`${U.origin}${U.pathname}`;if(R&&"dpopProof"in this&&(ei.headers=ei.headers||{},ei.headers.DPoP=await this.dpopProof({htu:`${U.origin}${U.pathname}`,htm:t.method||"GET",nonce:X.get(eo)},R,r)),en&&(Y=B(en.call(this,U,F({},ei,u)),...V)),ei=F({},Y,ei,u),c&&!ei.pfx&&!(ei.key&&ei.cert))throw TypeError("mutual-TLS certificate and key not set");if(ei.searchParams)for(let[t,r]of Object.entries(ei.searchParams))U.searchParams.delete(t),U.searchParams.set(t,r);for(let[t,r]of({form:Q,responseType:Z,json:ee,body:et,...ei}=ei,Object.entries(ei.headers||{})))void 0===r&&delete ei.headers[t];let ea=("https:"===U.protocol?J.request:O.request)(U.href,ei);return(async()=>{if(ee?send(ea,JSON.stringify(ee),"application/json"):Q?send(ea,P.stringify(Q),"application/x-www-form-urlencoded"):et?send(ea,et):send(ea),[er]=await Promise.race([W(ea,"response"),W(ea,"timeout")]),!er)throw ea.destroy(),new D(`outgoing request timed out after ${ei.timeout}ms`);let t=[];for await(let r of er)t.push(r);if(t.length)switch(Z){case"json":Object.defineProperty(er,"body",{get(){let r=Buffer.concat(t);try{r=JSON.parse(r)}catch(t){throw Object.defineProperty(t,"response",{value:er}),t}finally{Object.defineProperty(er,"body",{value:r,configurable:!0})}return r},configurable:!0});break;case void 0:case"buffer":Object.defineProperty(er,"body",{get(){let r=Buffer.concat(t);return Object.defineProperty(er,"body",{value:r,configurable:!0}),r},configurable:!0});break;default:throw TypeError("unsupported responseType request option")}return er})().catch(t=>{throw er&&Object.defineProperty(t,"response",{value:er}),t}).finally(()=>{let t=er&&er.headers["dpop-nonce"];t&&G.test(t)&&X.set(eo,t)})},t.exports.setDefaults=setDefaults.bind(void 0,V)},91624:t=>{"use strict";t.exports=()=>Math.floor(Date.now()/1e3)},18763:t=>{"use strict";t.exports.keystores=new WeakMap},31122:t=>{"use strict";let r=/^\d+$/;function hasScheme(t){if(t.includes("://"))return!0;let c=t.replace(/(\/|\?)/g,"#").split("#")[0];if(c.includes(":")){let t=c.indexOf(":"),u=c.slice(t+1);if(!r.test(u))return!0}return!1}function acctSchemeAssumed(t){if(!t.includes("@"))return!1;let r=t.split("@"),c=r[r.length-1];return!(c.includes(":")||c.includes("/")||c.includes("?"))}function normalize(t){if("string"!=typeof t)throw TypeError("input must be a string");return(hasScheme(t)?t:acctSchemeAssumed(t)?`acct:${t}`:`https://${t}`).split("#")[0]}t.exports=normalize},92102:t=>{"use strict";let r=/(\w+)=("[^"]*")/g;t.exports=t=>{let c={};try{for(;null!==r.exec(t);)RegExp.$1&&RegExp.$2&&(c[RegExp.$1]=RegExp.$2.slice(1,-1))}catch(t){}return c}},78165:(t,r,c)=>{"use strict";let u=c(3144),{OPError:E,RPError:P}=c(10574),O=c(21307),J=c(8164),{CLOCK_TOLERANCE:W,HTTP_OPTIONS:K}=c(60577),R=c(29766),{setDefaults:U}=c(3135);t.exports={Issuer:u,Strategy:O,TokenSet:J,errors:{OPError:E,RPError:P},custom:{setHttpOptionsDefaults:U,http_options:K,clock_tolerance:W},generators:R}},3144:(t,r,c)=>{"use strict";let{inspect:u}=c(73837),E=c(57310),{RPError:P}=c(10574),O=c(76398),J=c(31567),W=c(7889),K=c(31122),R=c(3135),U=c(68979),{keystore:D}=c(37875),B=["https://login.microsoftonline.com/common/.well-known/openid-configuration","https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration","https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuration","https://login.microsoftonline.com/consumers/v2.0/.well-known/openid-configuration"],F=Symbol(),q={claim_types_supported:["normal"],claims_parameter_supported:!1,grant_types_supported:["authorization_code","implicit"],request_parameter_supported:!1,request_uri_parameter_supported:!0,require_request_uri_registration:!1,response_modes_supported:["query","fragment"],token_endpoint_auth_methods_supported:["client_secret_basic"]};let Issuer=class Issuer{#e;constructor(t={}){let r=t[F];delete t[F],["introspection","revocation"].forEach(r=>{t[`${r}_endpoint`]&&void 0===t[`${r}_endpoint_auth_methods_supported`]&&void 0===t[`${r}_endpoint_auth_signing_alg_values_supported`]&&(t.token_endpoint_auth_methods_supported&&(t[`${r}_endpoint_auth_methods_supported`]=t.token_endpoint_auth_methods_supported),t.token_endpoint_auth_signing_alg_values_supported&&(t[`${r}_endpoint_auth_signing_alg_values_supported`]=t.token_endpoint_auth_signing_alg_values_supported))}),this.#e=new Map,Object.entries(t).forEach(([t,r])=>{this.#e.set(t,r),this[t]||Object.defineProperty(this,t,{get(){return this.#e.get(t)},enumerable:!0})}),J.set(this.issuer,this);let c=O(this,r);Object.defineProperties(this,{Client:{value:c,enumerable:!0},FAPI1Client:{value:class extends c{},enumerable:!0},FAPI2Client:{value:class extends c{},enumerable:!0}})}get metadata(){return U(Object.fromEntries(this.#e.entries()))}static async webfinger(t){let r=K(t),{host:c}=E.parse(r),u=`https://${c}/.well-known/webfinger`,O=await R.call(this,{method:"GET",url:u,responseType:"json",searchParams:{resource:r,rel:"http://openid.net/specs/connect/1.0/issuer"},headers:{Accept:"application/json"}}),U=W(O),D=Array.isArray(U.links)&&U.links.find(t=>"object"==typeof t&&"http://openid.net/specs/connect/1.0/issuer"===t.rel&&t.href);if(!D)throw new P({message:"no issuer found in webfinger response",body:U});if("string"!=typeof D.href||!D.href.startsWith("https://"))throw new P({printf:["invalid issuer location %s",D.href],body:U});let B=D.href;if(J.has(B))return J.get(B);let F=await this.discover(B);if(F.issuer!==B)throw J.del(F.issuer),new P("discovered issuer mismatch, expected %s, got: %s",B,F.issuer);return F}static async discover(t){let r=resolveWellKnownUri(t),c=await R.call(this,{method:"GET",responseType:"json",url:r,headers:{Accept:"application/json"}}),u=W(c);return new Issuer({...q,...u,[F]:!!B.find(t=>r.startsWith(t))})}async reloadJwksUri(){await D.call(this,!0)}[u.custom](){return`${this.constructor.name} ${u(this.metadata,{depth:1/0,colors:process.stdout.isTTY,compact:!1,sorted:!0})}`}};function resolveWellKnownUri(t){let r=E.parse(t);if(r.pathname.includes("/.well-known/"))return t;{let t;return t=r.pathname.endsWith("/")?`${r.pathname}.well-known/openid-configuration`:`${r.pathname}/.well-known/openid-configuration`,E.format({...r,pathname:t})}}t.exports=Issuer},31567:(t,r,c)=>{"use strict";let u=c(70557);t.exports=new u({max:100})},21307:(t,r,c)=>{"use strict";let u=c(57310),{format:E}=c(73837),P=c(68979),{RPError:O,OPError:J}=c(10574),{BaseClient:W}=c(76398),{random:K,codeChallenge:R}=c(29766),U=c(52542),{resolveResponseType:D,resolveRedirectUri:B}=c(98522);function verified(t,r,c={}){t?this.error(t):r?this.success(r,c):this.fail(c)}function OpenIDConnectStrategy({client:t,params:r={},passReqToCallback:c=!1,sessionKey:E,usePKCE:O=!0,extras:J={}}={},K){if(!(t instanceof W))throw TypeError("client must be an instance of openid-client Client");if("function"!=typeof K)throw TypeError("verify callback must be a function");if(!t.issuer||!t.issuer.issuer)throw TypeError("client must have an issuer with an identifier");if(this._client=t,this._issuer=t.issuer,this._verify=K,this._passReqToCallback=c,this._usePKCE=O,this._key=E||`oidc:${u.parse(this._issuer.issuer).hostname}`,this._params=P(r),delete this._params.state,delete this._params.nonce,this._extras=P(J),this._params.response_type||(this._params.response_type=D.call(t)),this._params.redirect_uri||(this._params.redirect_uri=B.call(t)),this._params.scope||(this._params.scope="openid"),!0===this._usePKCE){let t=!!Array.isArray(this._issuer.code_challenge_methods_supported)&&this._issuer.code_challenge_methods_supported;if(t&&t.includes("S256"))this._usePKCE="S256";else if(t&&t.includes("plain"))this._usePKCE="plain";else if(t)throw TypeError("neither code_challenge_method supported by the client is supported by the issuer");else this._usePKCE="S256"}else if("string"==typeof this._usePKCE&&!["plain","S256"].includes(this._usePKCE))throw TypeError(`${this._usePKCE} is not valid/implemented PKCE code_challenge_method`);this.name=u.parse(t.issuer.issuer).hostname}OpenIDConnectStrategy.prototype.authenticate=function(t,r){(async()=>{let c=this._client;if(!t.session)throw TypeError("authentication requires session support");let u=c.callbackParams(t),P=this._key,{0:J,length:W}=Object.keys(u);if(0===W||1===W&&"iss"===J){let u={state:K(),...this._params,...r};if(!u.nonce&&u.response_type.includes("id_token")&&(u.nonce=K()),t.session[P]=U(u,"nonce","state","max_age","response_type"),this._usePKCE&&u.response_type.includes("code")){let r=K();switch(t.session[P].code_verifier=r,this._usePKCE){case"S256":u.code_challenge=R(r),u.code_challenge_method="S256";break;case"plain":u.code_challenge=r}}this.redirect(c.authorizationUrl(u));return}let D=t.session[P];if(0===Object.keys(D||{}).length)throw Error(E('did not find expected authorization request details in session, req.session["%s"] is %j',P,D));let{state:B,nonce:F,max_age:q,code_verifier:G,response_type:V}=D;try{delete t.session[P]}catch(t){}let X={redirect_uri:this._params.redirect_uri,...r},Y=await c.callback(X.redirect_uri,u,{state:B,nonce:F,max_age:q,code_verifier:G,response_type:V},this._extras),Z=this._passReqToCallback,Q=this._verify.length>(Z?3:2)&&c.issuer.userinfo_endpoint,ee=[Y,verified.bind(this)];if(Q){if(!Y.access_token)throw new O({message:"expected access_token to be returned when asking for userinfo in verify callback",tokenset:Y});let t=await c.userinfo(Y);ee.splice(1,0,t)}Z&&ee.unshift(t),this._verify(...ee)})().catch(t=>{t instanceof J&&"server_error"!==t.error&&!t.error.startsWith("invalid")||t instanceof O?this.fail(t):this.error(t)})},t.exports=OpenIDConnectStrategy},8164:(t,r,c)=>{"use strict";let u=c(26597),E=c(91624);let TokenSet=class TokenSet{constructor(t){Object.assign(this,t);let{constructor:r,...c}=Object.getOwnPropertyDescriptors(this.constructor.prototype);Object.defineProperties(this,c)}set expires_in(t){this.expires_at=E()+Number(t)}get expires_in(){return Math.max.apply(null,[this.expires_at-E(),0])}expired(){return 0===this.expires_in}claims(){if(!this.id_token)throw TypeError("id_token not present in TokenSet");return JSON.parse(u.decode(this.id_token.split(".")[1]))}};t.exports=TokenSet},84664:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.cryptoRuntime=r.base64url=r.generateSecret=r.generateKeyPair=r.errors=r.decodeJwt=r.decodeProtectedHeader=r.importJWK=r.importX509=r.importPKCS8=r.importSPKI=r.exportJWK=r.exportSPKI=r.exportPKCS8=r.UnsecuredJWT=r.createRemoteJWKSet=r.createLocalJWKSet=r.EmbeddedJWK=r.calculateJwkThumbprintUri=r.calculateJwkThumbprint=r.EncryptJWT=r.SignJWT=r.GeneralSign=r.FlattenedSign=r.CompactSign=r.FlattenedEncrypt=r.CompactEncrypt=r.jwtDecrypt=r.jwtVerify=r.generalVerify=r.flattenedVerify=r.compactVerify=r.GeneralEncrypt=r.generalDecrypt=r.flattenedDecrypt=r.compactDecrypt=void 0;var u=c(207);Object.defineProperty(r,"compactDecrypt",{enumerable:!0,get:function(){return u.compactDecrypt}});var E=c(85684);Object.defineProperty(r,"flattenedDecrypt",{enumerable:!0,get:function(){return E.flattenedDecrypt}});var P=c(5967);Object.defineProperty(r,"generalDecrypt",{enumerable:!0,get:function(){return P.generalDecrypt}});var O=c(27139);Object.defineProperty(r,"GeneralEncrypt",{enumerable:!0,get:function(){return O.GeneralEncrypt}});var J=c(81465);Object.defineProperty(r,"compactVerify",{enumerable:!0,get:function(){return J.compactVerify}});var W=c(96174);Object.defineProperty(r,"flattenedVerify",{enumerable:!0,get:function(){return W.flattenedVerify}});var K=c(49021);Object.defineProperty(r,"generalVerify",{enumerable:!0,get:function(){return K.generalVerify}});var R=c(25325);Object.defineProperty(r,"jwtVerify",{enumerable:!0,get:function(){return R.jwtVerify}});var U=c(78471);Object.defineProperty(r,"jwtDecrypt",{enumerable:!0,get:function(){return U.jwtDecrypt}});var D=c(34442);Object.defineProperty(r,"CompactEncrypt",{enumerable:!0,get:function(){return D.CompactEncrypt}});var B=c(62157);Object.defineProperty(r,"FlattenedEncrypt",{enumerable:!0,get:function(){return B.FlattenedEncrypt}});var F=c(50714);Object.defineProperty(r,"CompactSign",{enumerable:!0,get:function(){return F.CompactSign}});var q=c(70651);Object.defineProperty(r,"FlattenedSign",{enumerable:!0,get:function(){return q.FlattenedSign}});var G=c(21985);Object.defineProperty(r,"GeneralSign",{enumerable:!0,get:function(){return G.GeneralSign}});var V=c(92030);Object.defineProperty(r,"SignJWT",{enumerable:!0,get:function(){return V.SignJWT}});var X=c(82979);Object.defineProperty(r,"EncryptJWT",{enumerable:!0,get:function(){return X.EncryptJWT}});var Y=c(93687);Object.defineProperty(r,"calculateJwkThumbprint",{enumerable:!0,get:function(){return Y.calculateJwkThumbprint}}),Object.defineProperty(r,"calculateJwkThumbprintUri",{enumerable:!0,get:function(){return Y.calculateJwkThumbprintUri}});var Z=c(139);Object.defineProperty(r,"EmbeddedJWK",{enumerable:!0,get:function(){return Z.EmbeddedJWK}});var Q=c(79736);Object.defineProperty(r,"createLocalJWKSet",{enumerable:!0,get:function(){return Q.createLocalJWKSet}});var ee=c(12376);Object.defineProperty(r,"createRemoteJWKSet",{enumerable:!0,get:function(){return ee.createRemoteJWKSet}});var et=c(13331);Object.defineProperty(r,"UnsecuredJWT",{enumerable:!0,get:function(){return et.UnsecuredJWT}});var er=c(96173);Object.defineProperty(r,"exportPKCS8",{enumerable:!0,get:function(){return er.exportPKCS8}}),Object.defineProperty(r,"exportSPKI",{enumerable:!0,get:function(){return er.exportSPKI}}),Object.defineProperty(r,"exportJWK",{enumerable:!0,get:function(){return er.exportJWK}});var en=c(65622);Object.defineProperty(r,"importSPKI",{enumerable:!0,get:function(){return en.importSPKI}}),Object.defineProperty(r,"importPKCS8",{enumerable:!0,get:function(){return en.importPKCS8}}),Object.defineProperty(r,"importX509",{enumerable:!0,get:function(){return en.importX509}}),Object.defineProperty(r,"importJWK",{enumerable:!0,get:function(){return en.importJWK}});var ei=c(51865);Object.defineProperty(r,"decodeProtectedHeader",{enumerable:!0,get:function(){return ei.decodeProtectedHeader}});var eo=c(79331);Object.defineProperty(r,"decodeJwt",{enumerable:!0,get:function(){return eo.decodeJwt}}),r.errors=c(67013);var ea=c(13204);Object.defineProperty(r,"generateKeyPair",{enumerable:!0,get:function(){return ea.generateKeyPair}});var es=c(80764);Object.defineProperty(r,"generateSecret",{enumerable:!0,get:function(){return es.generateSecret}}),r.base64url=c(48931);var ec=c(95298);Object.defineProperty(r,"cryptoRuntime",{enumerable:!0,get:function(){return ec.default}})},207:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.compactDecrypt=void 0;let u=c(85684),E=c(67013),P=c(12246);async function compactDecrypt(t,r,c){if(t instanceof Uint8Array&&(t=P.decoder.decode(t)),"string"!=typeof t)throw new E.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:O,1:J,2:W,3:K,4:R,length:U}=t.split(".");if(5!==U)throw new E.JWEInvalid("Invalid Compact JWE");let D=await (0,u.flattenedDecrypt)({ciphertext:K,iv:W||void 0,protected:O||void 0,tag:R||void 0,encrypted_key:J||void 0},r,c),B={plaintext:D.plaintext,protectedHeader:D.protectedHeader};return"function"==typeof r?{...B,key:D.key}:B}r.compactDecrypt=compactDecrypt},34442:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CompactEncrypt=void 0;let u=c(62157);let CompactEncrypt=class CompactEncrypt{constructor(t){this._flattened=new u.FlattenedEncrypt(t)}setContentEncryptionKey(t){return this._flattened.setContentEncryptionKey(t),this}setInitializationVector(t){return this._flattened.setInitializationVector(t),this}setProtectedHeader(t){return this._flattened.setProtectedHeader(t),this}setKeyManagementParameters(t){return this._flattened.setKeyManagementParameters(t),this}async encrypt(t,r){let c=await this._flattened.encrypt(t,r);return[c.protected,c.encrypted_key,c.iv,c.ciphertext,c.tag].join(".")}};r.CompactEncrypt=CompactEncrypt},85684:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.flattenedDecrypt=void 0;let u=c(52339),E=c(82026),P=c(29178),O=c(67013),J=c(36622),W=c(89567),K=c(57910),R=c(12246),U=c(48826),D=c(33481),B=c(21074);async function flattenedDecrypt(t,r,c){var F;let q,G,V,X,Y,Z,Q;if(!(0,W.default)(t))throw new O.JWEInvalid("Flattened JWE must be an object");if(void 0===t.protected&&void 0===t.header&&void 0===t.unprotected)throw new O.JWEInvalid("JOSE Header missing");if("string"!=typeof t.iv)throw new O.JWEInvalid("JWE Initialization Vector missing or incorrect type");if("string"!=typeof t.ciphertext)throw new O.JWEInvalid("JWE Ciphertext missing or incorrect type");if("string"!=typeof t.tag)throw new O.JWEInvalid("JWE Authentication Tag missing or incorrect type");if(void 0!==t.protected&&"string"!=typeof t.protected)throw new O.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==t.encrypted_key&&"string"!=typeof t.encrypted_key)throw new O.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==t.aad&&"string"!=typeof t.aad)throw new O.JWEInvalid("JWE AAD incorrect type");if(void 0!==t.header&&!(0,W.default)(t.header))throw new O.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==t.unprotected&&!(0,W.default)(t.unprotected))throw new O.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(t.protected)try{let r=(0,u.decode)(t.protected);q=JSON.parse(R.decoder.decode(r))}catch{throw new O.JWEInvalid("JWE Protected Header is invalid")}if(!(0,J.default)(q,t.header,t.unprotected))throw new O.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let ee={...q,...t.header,...t.unprotected};if((0,D.default)(O.JWEInvalid,new Map,null==c?void 0:c.crit,q,ee),void 0!==ee.zip){if(!q||!q.zip)throw new O.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==ee.zip)throw new O.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:et,enc:er}=ee;if("string"!=typeof et||!et)throw new O.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof er||!er)throw new O.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let en=c&&(0,B.default)("keyManagementAlgorithms",c.keyManagementAlgorithms),ei=c&&(0,B.default)("contentEncryptionAlgorithms",c.contentEncryptionAlgorithms);if(en&&!en.has(et))throw new O.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(ei&&!ei.has(er))throw new O.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==t.encrypted_key)try{G=(0,u.decode)(t.encrypted_key)}catch{throw new O.JWEInvalid("Failed to base64url decode the encrypted_key")}let eo=!1;"function"==typeof r&&(r=await r(q,t),eo=!0);try{V=await (0,K.default)(et,r,G,ee,c)}catch(t){if(t instanceof TypeError||t instanceof O.JWEInvalid||t instanceof O.JOSENotSupported)throw t;V=(0,U.default)(er)}try{X=(0,u.decode)(t.iv)}catch{throw new O.JWEInvalid("Failed to base64url decode the iv")}try{Y=(0,u.decode)(t.tag)}catch{throw new O.JWEInvalid("Failed to base64url decode the tag")}let ea=R.encoder.encode(null!==(F=t.protected)&&void 0!==F?F:"");Z=void 0!==t.aad?(0,R.concat)(ea,R.encoder.encode("."),R.encoder.encode(t.aad)):ea;try{Q=(0,u.decode)(t.ciphertext)}catch{throw new O.JWEInvalid("Failed to base64url decode the ciphertext")}let es=await (0,E.default)(er,V,Q,X,Y,Z);"DEF"===ee.zip&&(es=await ((null==c?void 0:c.inflateRaw)||P.inflate)(es));let ec={plaintext:es};if(void 0!==t.protected&&(ec.protectedHeader=q),void 0!==t.aad)try{ec.additionalAuthenticatedData=(0,u.decode)(t.aad)}catch{throw new O.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==t.unprotected&&(ec.sharedUnprotectedHeader=t.unprotected),void 0!==t.header&&(ec.unprotectedHeader=t.header),eo)?{...ec,key:r}:ec}r.flattenedDecrypt=flattenedDecrypt},62157:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FlattenedEncrypt=r.unprotected=void 0;let u=c(52339),E=c(22964),P=c(29178),O=c(85658),J=c(30601),W=c(67013),K=c(36622),R=c(12246),U=c(33481);r.unprotected=Symbol();let FlattenedEncrypt=class FlattenedEncrypt{constructor(t){if(!(t instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=t}setKeyManagementParameters(t){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=t,this}setProtectedHeader(t){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setSharedUnprotectedHeader(t){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=t,this}setUnprotectedHeader(t){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}setAdditionalAuthenticatedData(t){return this._aad=t,this}setContentEncryptionKey(t){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=t,this}setInitializationVector(t){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=t,this}async encrypt(t,c){let D,B,F,q,G,V,X;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new W.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!(0,K.default)(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new W.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let Y={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if((0,U.default)(W.JWEInvalid,new Map,null==c?void 0:c.crit,this._protectedHeader,Y),void 0!==Y.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new W.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==Y.zip)throw new W.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:Z,enc:Q}=Y;if("string"!=typeof Z||!Z)throw new W.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof Q||!Q)throw new W.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===Z){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===Z&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let u;({cek:B,encryptedKey:D,parameters:u}=await (0,J.default)(Z,Q,t,this._cek,this._keyManagementParameters)),u&&(c&&r.unprotected in c?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...u}:this.setUnprotectedHeader(u):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...u}:this.setProtectedHeader(u))}if(this._iv||(this._iv=(0,O.default)(Q)),q=this._protectedHeader?R.encoder.encode((0,u.encode)(JSON.stringify(this._protectedHeader))):R.encoder.encode(""),this._aad?(G=(0,u.encode)(this._aad),F=(0,R.concat)(q,R.encoder.encode("."),R.encoder.encode(G))):F=q,"DEF"===Y.zip){let t=await ((null==c?void 0:c.deflateRaw)||P.deflate)(this._plaintext);({ciphertext:V,tag:X}=await (0,E.default)(Q,t,B,this._iv,F))}else({ciphertext:V,tag:X}=await (0,E.default)(Q,this._plaintext,B,this._iv,F));let ee={ciphertext:(0,u.encode)(V),iv:(0,u.encode)(this._iv),tag:(0,u.encode)(X)};return D&&(ee.encrypted_key=(0,u.encode)(D)),G&&(ee.aad=G),this._protectedHeader&&(ee.protected=R.decoder.decode(q)),this._sharedUnprotectedHeader&&(ee.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(ee.header=this._unprotectedHeader),ee}};r.FlattenedEncrypt=FlattenedEncrypt},5967:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generalDecrypt=void 0;let u=c(85684),E=c(67013),P=c(89567);async function generalDecrypt(t,r,c){if(!(0,P.default)(t))throw new E.JWEInvalid("General JWE must be an object");if(!Array.isArray(t.recipients)||!t.recipients.every(P.default))throw new E.JWEInvalid("JWE Recipients missing or incorrect type");if(!t.recipients.length)throw new E.JWEInvalid("JWE Recipients has no members");for(let E of t.recipients)try{return await (0,u.flattenedDecrypt)({aad:t.aad,ciphertext:t.ciphertext,encrypted_key:E.encrypted_key,header:E.header,iv:t.iv,protected:t.protected,tag:t.tag,unprotected:t.unprotected},r,c)}catch{}throw new E.JWEDecryptionFailed}r.generalDecrypt=generalDecrypt},27139:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GeneralEncrypt=void 0;let u=c(62157),E=c(67013),P=c(48826),O=c(36622),J=c(30601),W=c(52339),K=c(33481);let IndividualRecipient=class IndividualRecipient{constructor(t,r,c){this.parent=t,this.key=r,this.options=c}setUnprotectedHeader(t){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=t,this}addRecipient(...t){return this.parent.addRecipient(...t)}encrypt(...t){return this.parent.encrypt(...t)}done(){return this.parent}};let GeneralEncrypt=class GeneralEncrypt{constructor(t){this._recipients=[],this._plaintext=t}addRecipient(t,r){let c=new IndividualRecipient(this,t,{crit:null==r?void 0:r.crit});return this._recipients.push(c),c}setProtectedHeader(t){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setSharedUnprotectedHeader(t){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}setAdditionalAuthenticatedData(t){return this._aad=t,this}async encrypt(t){var r,c,R;let U;if(!this._recipients.length)throw new E.JWEInvalid("at least one recipient must be added");if(t={deflateRaw:null==t?void 0:t.deflateRaw},1===this._recipients.length){let[r]=this._recipients,c=await new u.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(r.unprotectedHeader).encrypt(r.key,{...r.options,...t}),E={ciphertext:c.ciphertext,iv:c.iv,recipients:[{}],tag:c.tag};return c.aad&&(E.aad=c.aad),c.protected&&(E.protected=c.protected),c.unprotected&&(E.unprotected=c.unprotected),c.encrypted_key&&(E.recipients[0].encrypted_key=c.encrypted_key),c.header&&(E.recipients[0].header=c.header),E}for(let t=0;t<this._recipients.length;t++){let r=this._recipients[t];if(!(0,O.default)(this._protectedHeader,this._unprotectedHeader,r.unprotectedHeader))throw new E.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let c={...this._protectedHeader,...this._unprotectedHeader,...r.unprotectedHeader},{alg:u}=c;if("string"!=typeof u||!u)throw new E.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===u||"ECDH-ES"===u)throw new E.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof c.enc||!c.enc)throw new E.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(U){if(U!==c.enc)throw new E.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else U=c.enc;if((0,K.default)(E.JWEInvalid,new Map,r.options.crit,this._protectedHeader,c),void 0!==c.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new E.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let D=(0,P.default)(U),B={ciphertext:"",iv:"",recipients:[],tag:""};for(let E=0;E<this._recipients.length;E++){let P=this._recipients[E],O={};B.recipients.push(O);let K={...this._protectedHeader,...this._unprotectedHeader,...P.unprotectedHeader},F=K.alg.startsWith("PBES2")?2048+E:void 0;if(0===E){let r=await new u.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(D).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(P.unprotectedHeader).setKeyManagementParameters({p2c:F}).encrypt(P.key,{...P.options,...t,[u.unprotected]:!0});B.ciphertext=r.ciphertext,B.iv=r.iv,B.tag=r.tag,r.aad&&(B.aad=r.aad),r.protected&&(B.protected=r.protected),r.unprotected&&(B.unprotected=r.unprotected),O.encrypted_key=r.encrypted_key,r.header&&(O.header=r.header);continue}let{encryptedKey:q,parameters:G}=await (0,J.default)((null===(r=P.unprotectedHeader)||void 0===r?void 0:r.alg)||(null===(c=this._protectedHeader)||void 0===c?void 0:c.alg)||(null===(R=this._unprotectedHeader)||void 0===R?void 0:R.alg),U,P.key,D,{p2c:F});O.encrypted_key=(0,W.encode)(q),(P.unprotectedHeader||G)&&(O.header={...P.unprotectedHeader,...G})}return B}};r.GeneralEncrypt=GeneralEncrypt},139:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EmbeddedJWK=void 0;let u=c(65622),E=c(89567),P=c(67013);async function EmbeddedJWK(t,r){let c={...t,...null==r?void 0:r.header};if(!(0,E.default)(c.jwk))throw new P.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let O=await (0,u.importJWK)({...c.jwk,ext:!0},c.alg,!0);if(O instanceof Uint8Array||"public"!==O.type)throw new P.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return O}r.EmbeddedJWK=EmbeddedJWK},93687:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.calculateJwkThumbprintUri=r.calculateJwkThumbprint=void 0;let u=c(19457),E=c(52339),P=c(67013),O=c(12246),J=c(89567),check=(t,r)=>{if("string"!=typeof t||!t)throw new P.JWKInvalid(`${r} missing or invalid`)};async function calculateJwkThumbprint(t,r){let c;if(!(0,J.default)(t))throw TypeError("JWK must be an object");if(null!=r||(r="sha256"),"sha256"!==r&&"sha384"!==r&&"sha512"!==r)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(t.kty){case"EC":check(t.crv,'"crv" (Curve) Parameter'),check(t.x,'"x" (X Coordinate) Parameter'),check(t.y,'"y" (Y Coordinate) Parameter'),c={crv:t.crv,kty:t.kty,x:t.x,y:t.y};break;case"OKP":check(t.crv,'"crv" (Subtype of Key Pair) Parameter'),check(t.x,'"x" (Public Key) Parameter'),c={crv:t.crv,kty:t.kty,x:t.x};break;case"RSA":check(t.e,'"e" (Exponent) Parameter'),check(t.n,'"n" (Modulus) Parameter'),c={e:t.e,kty:t.kty,n:t.n};break;case"oct":check(t.k,'"k" (Key Value) Parameter'),c={k:t.k,kty:t.kty};break;default:throw new P.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let W=O.encoder.encode(JSON.stringify(c));return(0,E.encode)(await (0,u.default)(r,W))}async function calculateJwkThumbprintUri(t,r){null!=r||(r="sha256");let c=await calculateJwkThumbprint(t,r);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${r.slice(-3)}:${c}`}r.calculateJwkThumbprint=calculateJwkThumbprint,r.calculateJwkThumbprintUri=calculateJwkThumbprintUri},79736:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createLocalJWKSet=r.LocalJWKSet=r.isJWKSLike=void 0;let u=c(65622),E=c(67013),P=c(89567);function getKtyFromAlg(t){switch("string"==typeof t&&t.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new E.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}function isJWKSLike(t){return t&&"object"==typeof t&&Array.isArray(t.keys)&&t.keys.every(isJWKLike)}function isJWKLike(t){return(0,P.default)(t)}function clone(t){return"function"==typeof structuredClone?structuredClone(t):JSON.parse(JSON.stringify(t))}r.isJWKSLike=isJWKSLike;let LocalJWKSet=class LocalJWKSet{constructor(t){if(this._cached=new WeakMap,!isJWKSLike(t))throw new E.JWKSInvalid("JSON Web Key Set malformed");this._jwks=clone(t)}async getKey(t,r){let{alg:c,kid:u}={...t,...null==r?void 0:r.header},P=getKtyFromAlg(c),O=this._jwks.keys.filter(t=>{let r=P===t.kty;if(r&&"string"==typeof u&&(r=u===t.kid),r&&"string"==typeof t.alg&&(r=c===t.alg),r&&"string"==typeof t.use&&(r="sig"===t.use),r&&Array.isArray(t.key_ops)&&(r=t.key_ops.includes("verify")),r&&"EdDSA"===c&&(r="Ed25519"===t.crv||"Ed448"===t.crv),r)switch(c){case"ES256":r="P-256"===t.crv;break;case"ES256K":r="secp256k1"===t.crv;break;case"ES384":r="P-384"===t.crv;break;case"ES512":r="P-521"===t.crv}return r}),{0:J,length:W}=O;if(0===W)throw new E.JWKSNoMatchingKey;if(1!==W){let t=new E.JWKSMultipleMatchingKeys,{_cached:r}=this;throw t[Symbol.asyncIterator]=async function*(){for(let t of O)try{yield await importWithAlgCache(r,t,c)}catch{continue}},t}return importWithAlgCache(this._cached,J,c)}};async function importWithAlgCache(t,r,c){let P=t.get(r)||t.set(r,{}).get(r);if(void 0===P[c]){let t=await (0,u.importJWK)({...r,ext:!0},c);if(t instanceof Uint8Array||"public"!==t.type)throw new E.JWKSInvalid("JSON Web Key Set members must be public keys");P[c]=t}return P[c]}function createLocalJWKSet(t){let r=new LocalJWKSet(t);return async function(t,c){return r.getKey(t,c)}}r.LocalJWKSet=LocalJWKSet,r.createLocalJWKSet=createLocalJWKSet},12376:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.createRemoteJWKSet=void 0;let u=c(31581),E=c(67013),P=c(79736);function isCloudflareWorkers(){return"undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime}let RemoteJWKSet=class RemoteJWKSet extends P.LocalJWKSet{constructor(t,r){if(super({keys:[]}),this._jwks=void 0,!(t instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(t.href),this._options={agent:null==r?void 0:r.agent,headers:null==r?void 0:r.headers},this._timeoutDuration="number"==typeof(null==r?void 0:r.timeoutDuration)?null==r?void 0:r.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==r?void 0:r.cooldownDuration)?null==r?void 0:r.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==r?void 0:r.cacheMaxAge)?null==r?void 0:r.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(t,r){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(t,r)}catch(c){if(c instanceof E.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),super.getKey(t,r);throw c}}async reload(){this._pendingFetch&&isCloudflareWorkers()&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=(0,u.default)(this._url,this._timeoutDuration,this._options).then(t=>{if(!(0,P.isJWKSLike)(t))throw new E.JWKSInvalid("JSON Web Key Set malformed");this._jwks={keys:t.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(t=>{throw this._pendingFetch=void 0,t})),await this._pendingFetch}};function createRemoteJWKSet(t,r){let c=new RemoteJWKSet(t,r);return async function(t,r){return c.getKey(t,r)}}r.createRemoteJWKSet=createRemoteJWKSet},50714:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CompactSign=void 0;let u=c(70651);let CompactSign=class CompactSign{constructor(t){this._flattened=new u.FlattenedSign(t)}setProtectedHeader(t){return this._flattened.setProtectedHeader(t),this}async sign(t,r){let c=await this._flattened.sign(t,r);if(void 0===c.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${c.protected}.${c.payload}.${c.signature}`}};r.CompactSign=CompactSign},81465:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.compactVerify=void 0;let u=c(96174),E=c(67013),P=c(12246);async function compactVerify(t,r,c){if(t instanceof Uint8Array&&(t=P.decoder.decode(t)),"string"!=typeof t)throw new E.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:O,1:J,2:W,length:K}=t.split(".");if(3!==K)throw new E.JWSInvalid("Invalid Compact JWS");let R=await (0,u.flattenedVerify)({payload:J,protected:O,signature:W},r,c),U={payload:R.payload,protectedHeader:R.protectedHeader};return"function"==typeof r?{...U,key:R.key}:U}r.compactVerify=compactVerify},70651:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FlattenedSign=void 0;let u=c(52339),E=c(64376),P=c(36622),O=c(67013),J=c(12246),W=c(21554),K=c(33481);let FlattenedSign=class FlattenedSign{constructor(t){if(!(t instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=t}setProtectedHeader(t){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setUnprotectedHeader(t){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=t,this}async sign(t,r){let c;if(!this._protectedHeader&&!this._unprotectedHeader)throw new O.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,P.default)(this._protectedHeader,this._unprotectedHeader))throw new O.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let R={...this._protectedHeader,...this._unprotectedHeader},U=(0,K.default)(O.JWSInvalid,new Map([["b64",!0]]),null==r?void 0:r.crit,this._protectedHeader,R),D=!0;if(U.has("b64")&&"boolean"!=typeof(D=this._protectedHeader.b64))throw new O.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:B}=R;if("string"!=typeof B||!B)throw new O.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,W.default)(B,t,"sign");let F=this._payload;D&&(F=J.encoder.encode((0,u.encode)(F))),c=this._protectedHeader?J.encoder.encode((0,u.encode)(JSON.stringify(this._protectedHeader))):J.encoder.encode("");let q=(0,J.concat)(c,J.encoder.encode("."),F),G=await (0,E.default)(B,t,q),V={signature:(0,u.encode)(G),payload:""};return D&&(V.payload=J.decoder.decode(F)),this._unprotectedHeader&&(V.header=this._unprotectedHeader),this._protectedHeader&&(V.protected=J.decoder.decode(c)),V}};r.FlattenedSign=FlattenedSign},96174:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.flattenedVerify=void 0;let u=c(52339),E=c(85134),P=c(67013),O=c(12246),J=c(36622),W=c(89567),K=c(21554),R=c(33481),U=c(21074);async function flattenedVerify(t,r,c){var D;let B,F;if(!(0,W.default)(t))throw new P.JWSInvalid("Flattened JWS must be an object");if(void 0===t.protected&&void 0===t.header)throw new P.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==t.protected&&"string"!=typeof t.protected)throw new P.JWSInvalid("JWS Protected Header incorrect type");if(void 0===t.payload)throw new P.JWSInvalid("JWS Payload missing");if("string"!=typeof t.signature)throw new P.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==t.header&&!(0,W.default)(t.header))throw new P.JWSInvalid("JWS Unprotected Header incorrect type");let q={};if(t.protected)try{let r=(0,u.decode)(t.protected);q=JSON.parse(O.decoder.decode(r))}catch{throw new P.JWSInvalid("JWS Protected Header is invalid")}if(!(0,J.default)(q,t.header))throw new P.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let G={...q,...t.header},V=(0,R.default)(P.JWSInvalid,new Map([["b64",!0]]),null==c?void 0:c.crit,q,G),X=!0;if(V.has("b64")&&"boolean"!=typeof(X=q.b64))throw new P.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:Y}=G;if("string"!=typeof Y||!Y)throw new P.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let Z=c&&(0,U.default)("algorithms",c.algorithms);if(Z&&!Z.has(Y))throw new P.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(X){if("string"!=typeof t.payload)throw new P.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof t.payload&&!(t.payload instanceof Uint8Array))throw new P.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let Q=!1;"function"==typeof r&&(r=await r(q,t),Q=!0),(0,K.default)(Y,r,"verify");let ee=(0,O.concat)(O.encoder.encode(null!==(D=t.protected)&&void 0!==D?D:""),O.encoder.encode("."),"string"==typeof t.payload?O.encoder.encode(t.payload):t.payload);try{B=(0,u.decode)(t.signature)}catch{throw new P.JWSInvalid("Failed to base64url decode the signature")}let et=await (0,E.default)(Y,r,B,ee);if(!et)throw new P.JWSSignatureVerificationFailed;if(X)try{F=(0,u.decode)(t.payload)}catch{throw new P.JWSInvalid("Failed to base64url decode the payload")}else F="string"==typeof t.payload?O.encoder.encode(t.payload):t.payload;let er={payload:F};return(void 0!==t.protected&&(er.protectedHeader=q),void 0!==t.header&&(er.unprotectedHeader=t.header),Q)?{...er,key:r}:er}r.flattenedVerify=flattenedVerify},21985:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GeneralSign=void 0;let u=c(70651),E=c(67013);let IndividualSignature=class IndividualSignature{constructor(t,r,c){this.parent=t,this.key=r,this.options=c}setProtectedHeader(t){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=t,this}setUnprotectedHeader(t){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=t,this}addSignature(...t){return this.parent.addSignature(...t)}sign(...t){return this.parent.sign(...t)}done(){return this.parent}};let GeneralSign=class GeneralSign{constructor(t){this._signatures=[],this._payload=t}addSignature(t,r){let c=new IndividualSignature(this,t,r);return this._signatures.push(c),c}async sign(){if(!this._signatures.length)throw new E.JWSInvalid("at least one signature must be added");let t={signatures:[],payload:""};for(let r=0;r<this._signatures.length;r++){let c=this._signatures[r],P=new u.FlattenedSign(this._payload);P.setProtectedHeader(c.protectedHeader),P.setUnprotectedHeader(c.unprotectedHeader);let{payload:O,...J}=await P.sign(c.key,c.options);if(0===r)t.payload=O;else if(t.payload!==O)throw new E.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");t.signatures.push(J)}return t}};r.GeneralSign=GeneralSign},49021:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generalVerify=void 0;let u=c(96174),E=c(67013),P=c(89567);async function generalVerify(t,r,c){if(!(0,P.default)(t))throw new E.JWSInvalid("General JWS must be an object");if(!Array.isArray(t.signatures)||!t.signatures.every(P.default))throw new E.JWSInvalid("JWS Signatures missing or incorrect type");for(let E of t.signatures)try{return await (0,u.flattenedVerify)({header:E.header,payload:t.payload,protected:E.protected,signature:E.signature},r,c)}catch{}throw new E.JWSSignatureVerificationFailed}r.generalVerify=generalVerify},78471:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.jwtDecrypt=void 0;let u=c(207),E=c(25186),P=c(67013);async function jwtDecrypt(t,r,c){let O=await (0,u.compactDecrypt)(t,r,c),J=(0,E.default)(O.protectedHeader,O.plaintext,c),{protectedHeader:W}=O;if(void 0!==W.iss&&W.iss!==J.iss)throw new P.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==W.sub&&W.sub!==J.sub)throw new P.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==W.aud&&JSON.stringify(W.aud)!==JSON.stringify(J.aud))throw new P.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',"aud","mismatch");let K={payload:J,protectedHeader:W};return"function"==typeof r?{...K,key:O.key}:K}r.jwtDecrypt=jwtDecrypt},82979:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EncryptJWT=void 0;let u=c(34442),E=c(12246),P=c(75045);let EncryptJWT=class EncryptJWT extends P.ProduceJWT{setProtectedHeader(t){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=t,this}setKeyManagementParameters(t){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=t,this}setContentEncryptionKey(t){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=t,this}setInitializationVector(t){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=t,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(t,r){let c=new u.CompactEncrypt(E.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),c.setProtectedHeader(this._protectedHeader),this._iv&&c.setInitializationVector(this._iv),this._cek&&c.setContentEncryptionKey(this._cek),this._keyManagementParameters&&c.setKeyManagementParameters(this._keyManagementParameters),c.encrypt(t,r)}};r.EncryptJWT=EncryptJWT},75045:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ProduceJWT=void 0;let u=c(76262),E=c(89567),P=c(81227);let ProduceJWT=class ProduceJWT{constructor(t){if(!(0,E.default)(t))throw TypeError("JWT Claims Set MUST be an object");this._payload=t}setIssuer(t){return this._payload={...this._payload,iss:t},this}setSubject(t){return this._payload={...this._payload,sub:t},this}setAudience(t){return this._payload={...this._payload,aud:t},this}setJti(t){return this._payload={...this._payload,jti:t},this}setNotBefore(t){return"number"==typeof t?this._payload={...this._payload,nbf:t}:this._payload={...this._payload,nbf:(0,u.default)(new Date)+(0,P.default)(t)},this}setExpirationTime(t){return"number"==typeof t?this._payload={...this._payload,exp:t}:this._payload={...this._payload,exp:(0,u.default)(new Date)+(0,P.default)(t)},this}setIssuedAt(t){return void 0===t?this._payload={...this._payload,iat:(0,u.default)(new Date)}:this._payload={...this._payload,iat:t},this}};r.ProduceJWT=ProduceJWT},92030:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SignJWT=void 0;let u=c(50714),E=c(67013),P=c(12246),O=c(75045);let SignJWT=class SignJWT extends O.ProduceJWT{setProtectedHeader(t){return this._protectedHeader=t,this}async sign(t,r){var c;let O=new u.CompactSign(P.encoder.encode(JSON.stringify(this._payload)));if(O.setProtectedHeader(this._protectedHeader),Array.isArray(null===(c=this._protectedHeader)||void 0===c?void 0:c.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new E.JWTInvalid("JWTs MUST NOT use unencoded payload");return O.sign(t,r)}};r.SignJWT=SignJWT},13331:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.UnsecuredJWT=void 0;let u=c(52339),E=c(12246),P=c(67013),O=c(25186),J=c(75045);let UnsecuredJWT=class UnsecuredJWT extends J.ProduceJWT{encode(){let t=u.encode(JSON.stringify({alg:"none"})),r=u.encode(JSON.stringify(this._payload));return`${t}.${r}.`}static decode(t,r){let c;if("string"!=typeof t)throw new P.JWTInvalid("Unsecured JWT must be a string");let{0:J,1:W,2:K,length:R}=t.split(".");if(3!==R||""!==K)throw new P.JWTInvalid("Invalid Unsecured JWT");try{if(c=JSON.parse(E.decoder.decode(u.decode(J))),"none"!==c.alg)throw Error()}catch{throw new P.JWTInvalid("Invalid Unsecured JWT")}let U=(0,O.default)(c,u.decode(W),r);return{payload:U,header:c}}};r.UnsecuredJWT=UnsecuredJWT},25325:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.jwtVerify=void 0;let u=c(81465),E=c(25186),P=c(67013);async function jwtVerify(t,r,c){var O;let J=await (0,u.compactVerify)(t,r,c);if((null===(O=J.protectedHeader.crit)||void 0===O?void 0:O.includes("b64"))&&!1===J.protectedHeader.b64)throw new P.JWTInvalid("JWTs MUST NOT use unencoded payload");let W=(0,E.default)(J.protectedHeader,J.payload,c),K={payload:W,protectedHeader:J.protectedHeader};return"function"==typeof r?{...K,key:J.key}:K}r.jwtVerify=jwtVerify},96173:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.exportJWK=r.exportPKCS8=r.exportSPKI=void 0;let u=c(93586),E=c(93586),P=c(91795);async function exportSPKI(t){return(0,u.toSPKI)(t)}async function exportPKCS8(t){return(0,E.toPKCS8)(t)}async function exportJWK(t){return(0,P.default)(t)}r.exportSPKI=exportSPKI,r.exportPKCS8=exportPKCS8,r.exportJWK=exportJWK},13204:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateKeyPair=void 0;let u=c(20418);async function generateKeyPair(t,r){return(0,u.generateKeyPair)(t,r)}r.generateKeyPair=generateKeyPair},80764:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateSecret=void 0;let u=c(20418);async function generateSecret(t,r){return(0,u.generateSecret)(t,r)}r.generateSecret=generateSecret},65622:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.importJWK=r.importPKCS8=r.importX509=r.importSPKI=void 0;let u=c(52339),E=c(93586),P=c(43073),O=c(67013),J=c(89567);async function importSPKI(t,r,c){if("string"!=typeof t||0!==t.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,E.fromSPKI)(t,r,c)}async function importX509(t,r,c){if("string"!=typeof t||0!==t.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,E.fromX509)(t,r,c)}async function importPKCS8(t,r,c){if("string"!=typeof t||0!==t.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,E.fromPKCS8)(t,r,c)}async function importJWK(t,r,c){var E;if(!(0,J.default)(t))throw TypeError("JWK must be an object");switch(r||(r=t.alg),t.kty){case"oct":if("string"!=typeof t.k||!t.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=c||(c=!0!==t.ext),c)return(0,P.default)({...t,alg:r,ext:null!==(E=t.ext)&&void 0!==E&&E});return(0,u.decode)(t.k);case"RSA":if(void 0!==t.oth)throw new O.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return(0,P.default)({...t,alg:r});default:throw new O.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}r.importSPKI=importSPKI,r.importX509=importX509,r.importPKCS8=importPKCS8,r.importJWK=importJWK},13345:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.unwrap=r.wrap=void 0;let u=c(22964),E=c(82026),P=c(85658),O=c(52339);async function wrap(t,r,c,E){let J=t.slice(0,7);E||(E=(0,P.default)(J));let{ciphertext:W,tag:K}=await (0,u.default)(J,c,r,E,new Uint8Array(0));return{encryptedKey:W,iv:(0,O.encode)(E),tag:(0,O.encode)(K)}}async function unwrap(t,r,c,u,P){let O=t.slice(0,7);return(0,E.default)(O,r,c,u,P,new Uint8Array(0))}r.wrap=wrap,r.unwrap=unwrap},12246:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.concatKdf=r.lengthAndInput=r.uint32be=r.uint64be=r.p2s=r.concat=r.decoder=r.encoder=void 0;let u=c(19457);function concat(...t){let r=t.reduce((t,{length:r})=>t+r,0),c=new Uint8Array(r),u=0;return t.forEach(t=>{c.set(t,u),u+=t.length}),c}function p2s(t,c){return concat(r.encoder.encode(t),new Uint8Array([0]),c)}function writeUInt32BE(t,r,c){if(r<0||r>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967296-1}. Received ${r}`);t.set([r>>>24,r>>>16,r>>>8,255&r],c)}function uint64be(t){let r=new Uint8Array(8);return writeUInt32BE(r,Math.floor(t/4294967296),0),writeUInt32BE(r,t%4294967296,4),r}function uint32be(t){let r=new Uint8Array(4);return writeUInt32BE(r,t),r}function lengthAndInput(t){return concat(uint32be(t.length),t)}async function concatKdf(t,r,c){let E=Math.ceil((r>>3)/32),P=new Uint8Array(32*E);for(let r=0;r<E;r++){let E=new Uint8Array(4+t.length+c.length);E.set(uint32be(r+1)),E.set(t,4),E.set(c,4+t.length),P.set(await (0,u.default)("sha256",E),32*r)}return P.slice(0,r>>3)}r.encoder=new TextEncoder,r.decoder=new TextDecoder,r.concat=concat,r.p2s=p2s,r.uint64be=uint64be,r.uint32be=uint32be,r.lengthAndInput=lengthAndInput,r.concatKdf=concatKdf},48826:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.bitLength=void 0;let u=c(67013),E=c(38444);function bitLength(t){switch(t){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new u.JOSENotSupported(`Unsupported JWE Algorithm: ${t}`)}}r.bitLength=bitLength,r.default=t=>(0,E.default)(new Uint8Array(bitLength(t)>>3))},18736:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(67013),E=c(85658);r.default=(t,r)=>{if(r.length<<3!==(0,E.bitLength)(t))throw new u.JWEInvalid("Invalid Initialization Vector length")}},21554:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(74380),E=c(52920),symmetricTypeCheck=(t,r)=>{if(!(r instanceof Uint8Array)){if(!(0,E.default)(r))throw TypeError((0,u.withAlg)(t,r,...E.types,"Uint8Array"));if("secret"!==r.type)throw TypeError(`${E.types.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},asymmetricTypeCheck=(t,r,c)=>{if(!(0,E.default)(r))throw TypeError((0,u.withAlg)(t,r,...E.types));if("secret"===r.type)throw TypeError(`${E.types.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===c&&"public"===r.type)throw TypeError(`${E.types.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===c&&"public"===r.type)throw TypeError(`${E.types.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(r.algorithm&&"verify"===c&&"private"===r.type)throw TypeError(`${E.types.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(r.algorithm&&"encrypt"===c&&"private"===r.type)throw TypeError(`${E.types.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)};r.default=(t,r,c)=>{let u=t.startsWith("HS")||"dir"===t||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t);u?symmetricTypeCheck(t,r):asymmetricTypeCheck(t,r,c)}},79475:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(67013);function checkP2s(t){if(!(t instanceof Uint8Array)||t.length<8)throw new u.JWEInvalid("PBES2 Salt Input must be 8 or more octets")}r.default=checkP2s},95518:(t,r)=>{"use strict";function unusable(t,r="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${r} must be ${t}`)}function isAlgorithm(t,r){return t.name===r}function getHashLength(t){return parseInt(t.name.slice(4),10)}function getNamedCurve(t){switch(t){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}function checkUsage(t,r){if(r.length&&!r.some(r=>t.usages.includes(r))){let t="CryptoKey does not support this operation, its usages must include ";if(r.length>2){let c=r.pop();t+=`one of ${r.join(", ")}, or ${c}.`}else 2===r.length?t+=`one of ${r[0]} or ${r[1]}.`:t+=`${r[0]}.`;throw TypeError(t)}}function checkSigCryptoKey(t,r,...c){switch(r){case"HS256":case"HS384":case"HS512":{if(!isAlgorithm(t.algorithm,"HMAC"))throw unusable("HMAC");let c=parseInt(r.slice(2),10),u=getHashLength(t.algorithm.hash);if(u!==c)throw unusable(`SHA-${c}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!isAlgorithm(t.algorithm,"RSASSA-PKCS1-v1_5"))throw unusable("RSASSA-PKCS1-v1_5");let c=parseInt(r.slice(2),10),u=getHashLength(t.algorithm.hash);if(u!==c)throw unusable(`SHA-${c}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!isAlgorithm(t.algorithm,"RSA-PSS"))throw unusable("RSA-PSS");let c=parseInt(r.slice(2),10),u=getHashLength(t.algorithm.hash);if(u!==c)throw unusable(`SHA-${c}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==t.algorithm.name&&"Ed448"!==t.algorithm.name)throw unusable("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!isAlgorithm(t.algorithm,"ECDSA"))throw unusable("ECDSA");let c=getNamedCurve(r),u=t.algorithm.namedCurve;if(u!==c)throw unusable(c,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}checkUsage(t,c)}function checkEncCryptoKey(t,r,...c){switch(r){case"A128GCM":case"A192GCM":case"A256GCM":{if(!isAlgorithm(t.algorithm,"AES-GCM"))throw unusable("AES-GCM");let c=parseInt(r.slice(1,4),10),u=t.algorithm.length;if(u!==c)throw unusable(c,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!isAlgorithm(t.algorithm,"AES-KW"))throw unusable("AES-KW");let c=parseInt(r.slice(1,4),10),u=t.algorithm.length;if(u!==c)throw unusable(c,"algorithm.length");break}case"ECDH":switch(t.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw unusable("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!isAlgorithm(t.algorithm,"PBKDF2"))throw unusable("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!isAlgorithm(t.algorithm,"RSA-OAEP"))throw unusable("RSA-OAEP");let c=parseInt(r.slice(9),10)||1,u=getHashLength(t.algorithm.hash);if(u!==c)throw unusable(`SHA-${c}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}checkUsage(t,c)}Object.defineProperty(r,"__esModule",{value:!0}),r.checkEncCryptoKey=r.checkSigCryptoKey=void 0,r.checkSigCryptoKey=checkSigCryptoKey,r.checkEncCryptoKey=checkEncCryptoKey},57910:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(42778),E=c(25426),P=c(31019),O=c(92992),J=c(52339),W=c(67013),K=c(48826),R=c(65622),U=c(21554),D=c(89567),B=c(13345);async function decryptKeyManagement(t,r,c,F,q){switch((0,U.default)(t,r,"decrypt"),t){case"dir":if(void 0!==c)throw new W.JWEInvalid("Encountered unexpected JWE Encrypted Key");return r;case"ECDH-ES":if(void 0!==c)throw new W.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let P,O;if(!(0,D.default)(F.epk))throw new W.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!E.ecdhAllowed(r))throw new W.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let U=await (0,R.importJWK)(F.epk,t);if(void 0!==F.apu){if("string"!=typeof F.apu)throw new W.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{P=(0,J.decode)(F.apu)}catch{throw new W.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==F.apv){if("string"!=typeof F.apv)throw new W.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{O=(0,J.decode)(F.apv)}catch{throw new W.JWEInvalid("Failed to base64url decode the apv")}}let B=await E.deriveKey(U,r,"ECDH-ES"===t?F.enc:t,"ECDH-ES"===t?(0,K.bitLength)(F.enc):parseInt(t.slice(-5,-2),10),P,O);if("ECDH-ES"===t)return B;if(void 0===c)throw new W.JWEInvalid("JWE Encrypted Key missing");return(0,u.unwrap)(t.slice(-6),B,c)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===c)throw new W.JWEInvalid("JWE Encrypted Key missing");return(0,O.decrypt)(t,r,c);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let u;if(void 0===c)throw new W.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof F.p2c)throw new W.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let E=(null==q?void 0:q.maxPBES2Count)||1e4;if(F.p2c>E)throw new W.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof F.p2s)throw new W.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{u=(0,J.decode)(F.p2s)}catch{throw new W.JWEInvalid("Failed to base64url decode the p2s")}return(0,P.decrypt)(t,r,c,F.p2c,u)}case"A128KW":case"A192KW":case"A256KW":if(void 0===c)throw new W.JWEInvalid("JWE Encrypted Key missing");return(0,u.unwrap)(t,r,c);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let u,E;if(void 0===c)throw new W.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof F.iv)throw new W.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof F.tag)throw new W.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{u=(0,J.decode)(F.iv)}catch{throw new W.JWEInvalid("Failed to base64url decode the iv")}try{E=(0,J.decode)(F.tag)}catch{throw new W.JWEInvalid("Failed to base64url decode the tag")}return(0,B.unwrap)(t,r,c,u,E)}default:throw new W.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}r.default=decryptKeyManagement},30601:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(42778),E=c(25426),P=c(31019),O=c(92992),J=c(52339),W=c(48826),K=c(67013),R=c(96173),U=c(21554),D=c(13345);async function encryptKeyManagement(t,r,c,B,F={}){let q,G,V;switch((0,U.default)(t,c,"encrypt"),t){case"dir":V=c;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!E.ecdhAllowed(c))throw new K.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:P,apv:O}=F,{epk:U}=F;U||(U=(await E.generateEpk(c)).privateKey);let{x:D,y:X,crv:Y,kty:Z}=await (0,R.exportJWK)(U),Q=await E.deriveKey(c,U,"ECDH-ES"===t?r:t,"ECDH-ES"===t?(0,W.bitLength)(r):parseInt(t.slice(-5,-2),10),P,O);if(G={epk:{x:D,crv:Y,kty:Z}},"EC"===Z&&(G.epk.y=X),P&&(G.apu=(0,J.encode)(P)),O&&(G.apv=(0,J.encode)(O)),"ECDH-ES"===t){V=Q;break}V=B||(0,W.default)(r);let ee=t.slice(-6);q=await (0,u.wrap)(ee,Q,V);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":V=B||(0,W.default)(r),q=await (0,O.encrypt)(t,c,V);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{V=B||(0,W.default)(r);let{p2c:u,p2s:E}=F;({encryptedKey:q,...G}=await (0,P.encrypt)(t,c,V,u,E));break}case"A128KW":case"A192KW":case"A256KW":V=B||(0,W.default)(r),q=await (0,u.wrap)(t,c,V);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{V=B||(0,W.default)(r);let{iv:u}=F;({encryptedKey:q,...G}=await (0,D.wrap)(t,c,V,u));break}default:throw new K.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:V,encryptedKey:q,parameters:G}}r.default=encryptKeyManagement},76262:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=t=>Math.floor(t.getTime()/1e3)},74380:(t,r)=>{"use strict";function message(t,r,...c){if(c.length>2){let r=c.pop();t+=`one of type ${c.join(", ")}, or ${r}.`}else 2===c.length?t+=`one of type ${c[0]} or ${c[1]}.`:t+=`of type ${c[0]}.`;return null==r?t+=` Received ${r}`:"function"==typeof r&&r.name?t+=` Received function ${r.name}`:"object"==typeof r&&null!=r&&r.constructor&&r.constructor.name&&(t+=` Received an instance of ${r.constructor.name}`),t}function withAlg(t,r,...c){return message(`Key for the ${t} algorithm must be `,r,...c)}Object.defineProperty(r,"__esModule",{value:!0}),r.withAlg=void 0,r.default=(t,...r)=>message("Key must be ",t,...r),r.withAlg=withAlg},36622:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=(...t)=>{let r;let c=t.filter(Boolean);if(0===c.length||1===c.length)return!0;for(let t of c){let c=Object.keys(t);if(!r||0===r.size){r=new Set(c);continue}for(let t of c){if(r.has(t))return!1;r.add(t)}}return!0}},89567:(t,r)=>{"use strict";function isObjectLike(t){return"object"==typeof t&&null!==t}function isObject(t){if(!isObjectLike(t)||"[object Object]"!==Object.prototype.toString.call(t))return!1;if(null===Object.getPrototypeOf(t))return!0;let r=t;for(;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(t)===r}Object.defineProperty(r,"__esModule",{value:!0}),r.default=isObject},85658:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.bitLength=void 0;let u=c(67013),E=c(38444);function bitLength(t){switch(t){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new u.JOSENotSupported(`Unsupported JWE Algorithm: ${t}`)}}r.bitLength=bitLength,r.default=t=>(0,E.default)(new Uint8Array(bitLength(t)>>3))},25186:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(67013),E=c(12246),P=c(76262),O=c(81227),J=c(89567),normalizeTyp=t=>t.toLowerCase().replace(/^application\//,""),checkAudiencePresence=(t,r)=>"string"==typeof t?r.includes(t):!!Array.isArray(t)&&r.some(Set.prototype.has.bind(new Set(t)));r.default=(t,r,c={})=>{let W,K;let{typ:R}=c;if(R&&("string"!=typeof t.typ||normalizeTyp(t.typ)!==normalizeTyp(R)))throw new u.JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");try{W=JSON.parse(E.decoder.decode(r))}catch{}if(!(0,J.default)(W))throw new u.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims:U=[],issuer:D,subject:B,audience:F,maxTokenAge:q}=c;for(let t of(void 0!==q&&U.push("iat"),void 0!==F&&U.push("aud"),void 0!==B&&U.push("sub"),void 0!==D&&U.push("iss"),new Set(U.reverse())))if(!(t in W))throw new u.JWTClaimValidationFailed(`missing required "${t}" claim`,t,"missing");if(D&&!(Array.isArray(D)?D:[D]).includes(W.iss))throw new u.JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(B&&W.sub!==B)throw new u.JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(F&&!checkAudiencePresence(W.aud,"string"==typeof F?[F]:F))throw new u.JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");switch(typeof c.clockTolerance){case"string":K=(0,O.default)(c.clockTolerance);break;case"number":K=c.clockTolerance;break;case"undefined":K=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:G}=c,V=(0,P.default)(G||new Date);if((void 0!==W.iat||q)&&"number"!=typeof W.iat)throw new u.JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(void 0!==W.nbf){if("number"!=typeof W.nbf)throw new u.JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(W.nbf>V+K)throw new u.JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==W.exp){if("number"!=typeof W.exp)throw new u.JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(W.exp<=V-K)throw new u.JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(q){let t=V-W.iat,r="number"==typeof q?q:(0,O.default)(q);if(t-K>r)throw new u.JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(t<0-K)throw new u.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return W}},81227:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let c=604800,u=31557600,E=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;r.default=t=>{let r=E.exec(t);if(!r)throw TypeError("Invalid time period format");let P=parseFloat(r[1]),O=r[2].toLowerCase();switch(O){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(P);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*P);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*P);case"day":case"days":case"d":return Math.round(86400*P);case"week":case"weeks":case"w":return Math.round(P*c);default:return Math.round(P*u)}}},21074:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=(t,r)=>{if(void 0!==r&&(!Array.isArray(r)||r.some(t=>"string"!=typeof t)))throw TypeError(`"${t}" option must be an array of strings`);if(r)return new Set(r)}},33481:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(67013);function validateCrit(t,r,c,E,P){let O;if(void 0!==P.crit&&void 0===E.crit)throw new t('"crit" (Critical) Header Parameter MUST be integrity protected');if(!E||void 0===E.crit)return new Set;if(!Array.isArray(E.crit)||0===E.crit.length||E.crit.some(t=>"string"!=typeof t||0===t.length))throw new t('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let J of(O=void 0!==c?new Map([...Object.entries(c),...r.entries()]):r,E.crit)){if(!O.has(J))throw new u.JOSENotSupported(`Extension Header Parameter "${J}" is not recognized`);if(void 0===P[J])throw new t(`Extension Header Parameter "${J}" is missing`);if(O.get(J)&&void 0===E[J])throw new t(`Extension Header Parameter "${J}" MUST be integrity protected`)}return new Set(E.crit)}r.default=validateCrit},42778:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.unwrap=r.wrap=void 0;let u=c(14300),E=c(6113),P=c(67013),O=c(12246),J=c(24444),W=c(95518),K=c(32874),R=c(74380),U=c(11124),D=c(52920);function checkKeySize(t,r){if(t.symmetricKeySize<<3!==parseInt(r.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${r}`)}function ensureKeyObject(t,r,c){if((0,K.default)(t))return t;if(t instanceof Uint8Array)return(0,E.createSecretKey)(t);if((0,J.isCryptoKey)(t))return(0,W.checkEncCryptoKey)(t,r,c),E.KeyObject.from(t);throw TypeError((0,R.default)(t,...D.types,"Uint8Array"))}r.wrap=(t,r,c)=>{let J=parseInt(t.slice(1,4),10),W=`aes${J}-wrap`;if(!(0,U.default)(W))throw new P.JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`);let K=ensureKeyObject(r,t,"wrapKey");checkKeySize(K,t);let R=(0,E.createCipheriv)(W,K,u.Buffer.alloc(8,166));return(0,O.concat)(R.update(c),R.final())},r.unwrap=(t,r,c)=>{let J=parseInt(t.slice(1,4),10),W=`aes${J}-wrap`;if(!(0,U.default)(W))throw new P.JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`);let K=ensureKeyObject(r,t,"unwrapKey");checkKeySize(K,t);let R=(0,E.createDecipheriv)(W,K,u.Buffer.alloc(8,166));return(0,O.concat)(R.update(c),R.final())}},93586:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromX509=r.fromSPKI=r.fromPKCS8=r.toPKCS8=r.toSPKI=void 0;let u=c(6113),E=c(14300),P=c(24444),O=c(32874),J=c(74380),W=c(52920),genericExport=(t,r,c)=>{let E;if((0,P.isCryptoKey)(c)){if(!c.extractable)throw TypeError("CryptoKey is not extractable");E=u.KeyObject.from(c)}else if((0,O.default)(c))E=c;else throw TypeError((0,J.default)(c,...W.types));if(E.type!==t)throw TypeError(`key is not a ${t} key`);return E.export({format:"pem",type:r})};r.toSPKI=t=>genericExport("public","spki",t),r.toPKCS8=t=>genericExport("private","pkcs8",t),r.fromPKCS8=t=>(0,u.createPrivateKey)({key:E.Buffer.from(t.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""),"base64"),type:"pkcs8",format:"der"}),r.fromSPKI=t=>(0,u.createPublicKey)({key:E.Buffer.from(t.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""),"base64"),type:"spki",format:"der"}),r.fromX509=t=>(0,u.createPublicKey)({key:t,type:"spki",format:"pem"})},15580:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let Asn1SequenceDecoder=class Asn1SequenceDecoder{constructor(t){if(48!==t[0])throw TypeError();this.buffer=t,this.offset=1;let r=this.decodeLength();if(r!==t.length-this.offset)throw TypeError()}decodeLength(){let t=this.buffer[this.offset++];if(128&t){let r=-129&t;t=0;for(let c=0;c<r;c++)t=t<<8|this.buffer[this.offset+c];this.offset+=r}return t}unsignedInteger(){if(2!==this.buffer[this.offset++])throw TypeError();let t=this.decodeLength();0===this.buffer[this.offset]&&(this.offset++,t--);let r=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,r}end(){if(this.offset!==this.buffer.length)throw TypeError()}};r.default=Asn1SequenceDecoder},82109:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(14300),E=c(67013),P=u.Buffer.from([0]),O=u.Buffer.from([2]),J=u.Buffer.from([3]),W=u.Buffer.from([48]),K=u.Buffer.from([4]),encodeLength=t=>{if(t<128)return u.Buffer.from([t]);let r=u.Buffer.alloc(5);r.writeUInt32BE(t,1);let c=1;for(;0===r[c];)c++;return r[c-1]=128|5-c,r.slice(c-1)},R=new Map([["P-256",u.Buffer.from("06 08 2A 86 48 CE 3D 03 01 07".replace(/ /g,""),"hex")],["secp256k1",u.Buffer.from("06 05 2B 81 04 00 0A".replace(/ /g,""),"hex")],["P-384",u.Buffer.from("06 05 2B 81 04 00 22".replace(/ /g,""),"hex")],["P-521",u.Buffer.from("06 05 2B 81 04 00 23".replace(/ /g,""),"hex")],["ecPublicKey",u.Buffer.from("06 07 2A 86 48 CE 3D 02 01".replace(/ /g,""),"hex")],["X25519",u.Buffer.from("06 03 2B 65 6E".replace(/ /g,""),"hex")],["X448",u.Buffer.from("06 03 2B 65 6F".replace(/ /g,""),"hex")],["Ed25519",u.Buffer.from("06 03 2B 65 70".replace(/ /g,""),"hex")],["Ed448",u.Buffer.from("06 03 2B 65 71".replace(/ /g,""),"hex")]]);let DumbAsn1Encoder=class DumbAsn1Encoder{constructor(){this.length=0,this.elements=[]}oidFor(t){let r=R.get(t);if(!r)throw new E.JOSENotSupported("Invalid or unsupported OID");this.elements.push(r),this.length+=r.length}zero(){this.elements.push(O,u.Buffer.from([1]),P),this.length+=3}one(){this.elements.push(O,u.Buffer.from([1]),u.Buffer.from([1])),this.length+=3}unsignedInteger(t){if(128&t[0]){let r=encodeLength(t.length+1);this.elements.push(O,r,P,t),this.length+=2+r.length+t.length}else{let r=0;for(;0===t[r]&&(128&t[r+1])==0;)r++;let c=encodeLength(t.length-r);this.elements.push(O,encodeLength(t.length-r),t.slice(r)),this.length+=1+c.length+t.length-r}}octStr(t){let r=encodeLength(t.length);this.elements.push(K,encodeLength(t.length),t),this.length+=1+r.length+t.length}bitStr(t){let r=encodeLength(t.length+1);this.elements.push(J,encodeLength(t.length+1),P,t),this.length+=1+r.length+t.length+1}add(t){this.elements.push(t),this.length+=t.length}end(t=W){let r=encodeLength(this.length);return u.Buffer.concat([t,r,...this.elements],1+r.length+this.length)}};r.default=DumbAsn1Encoder},52339:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decode=r.encode=r.encodeBase64=r.decodeBase64=void 0;let u=c(14300),E=c(12246);function normalize(t){let r=t;return r instanceof Uint8Array&&(r=E.decoder.decode(r)),r}u.Buffer.isEncoding("base64url")?r.encode=t=>u.Buffer.from(t).toString("base64url"):r.encode=t=>u.Buffer.from(t).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),r.decodeBase64=t=>u.Buffer.from(t,"base64"),r.encodeBase64=t=>u.Buffer.from(t).toString("base64"),r.decode=t=>u.Buffer.from(normalize(t),"base64")},524:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(12246);function cbcTag(t,r,c,P,O,J){let W=(0,E.concat)(t,r,c,(0,E.uint64be)(t.length<<3)),K=(0,u.createHmac)(`sha${P}`,O);return K.update(W),K.digest().slice(0,J>>3)}r.default=cbcTag},16770:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(67013),E=c(32874);r.default=(t,r)=>{let c;switch(t){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(t.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(t.slice(1,4),10);break;default:throw new u.JOSENotSupported(`Content Encryption Algorithm ${t} is not supported either by JOSE or your javascript runtime`)}if(r instanceof Uint8Array){let t=r.byteLength<<3;if(t!==c)throw new u.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${t} bits`);return}if((0,E.default)(r)&&"secret"===r.type){let t=r.symmetricKeySize<<3;if(t!==c)throw new u.JWEInvalid(`Invalid Content Encryption Key length. Expected ${c} bits, got ${t} bits`);return}throw TypeError("Invalid Content Encryption Key type")}},68719:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setModulusLength=r.weakMap=void 0,r.weakMap=new WeakMap;let getLength=(t,r)=>{let c=t.readUInt8(1);if((128&c)==0)return 0===r?c:getLength(t.subarray(2+c),r-1);let u=127&c;c=0;for(let r=0;r<u;r++){c<<=8;let u=t.readUInt8(2+r);c|=u}return 0===r?c:getLength(t.subarray(2+c),r-1)},getLengthOfSeqIndex=(t,r)=>{let c=t.readUInt8(1);return(128&c)==0?getLength(t.subarray(2),r):getLength(t.subarray(2+(127&c)),r)},getModulusLength=t=>{var c,u;if(r.weakMap.has(t))return r.weakMap.get(t);let E=null!==(u=null===(c=t.asymmetricKeyDetails)||void 0===c?void 0:c.modulusLength)&&void 0!==u?u:getLengthOfSeqIndex(t.export({format:"der",type:"pkcs1"}),"private"===t.type?1:0)-1<<3;return r.weakMap.set(t,E),E};r.setModulusLength=(t,c)=>{r.weakMap.set(t,c)},r.default=(t,r)=>{if(2048>getModulusLength(t))throw TypeError(`${r} requires key modulusLength to be 2048 bits or larger`)}},11124:(t,r,c)=>{"use strict";let u;Object.defineProperty(r,"__esModule",{value:!0});let E=c(6113);r.default=t=>(u||(u=new Set((0,E.getCiphers)())),u.has(t))},82026:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(18736),P=c(16770),O=c(12246),J=c(67013),W=c(32072),K=c(524),R=c(24444),U=c(95518),D=c(32874),B=c(74380),F=c(11124),q=c(52920);function cbcDecrypt(t,r,c,E,P,R){let U,B;let q=parseInt(t.slice(1,4),10);(0,D.default)(r)&&(r=r.export());let G=r.subarray(q>>3),V=r.subarray(0,q>>3),X=parseInt(t.slice(-3),10),Y=`aes-${q}-cbc`;if(!(0,F.default)(Y))throw new J.JOSENotSupported(`alg ${t} is not supported by your javascript runtime`);let Z=(0,K.default)(R,E,c,X,V,q);try{U=(0,W.default)(P,Z)}catch{}if(!U)throw new J.JWEDecryptionFailed;try{let t=(0,u.createDecipheriv)(Y,G,E);B=(0,O.concat)(t.update(c),t.final())}catch{}if(!B)throw new J.JWEDecryptionFailed;return B}function gcmDecrypt(t,r,c,E,P,O){let W=parseInt(t.slice(1,4),10),K=`aes-${W}-gcm`;if(!(0,F.default)(K))throw new J.JOSENotSupported(`alg ${t} is not supported by your javascript runtime`);try{let t=(0,u.createDecipheriv)(K,r,E,{authTagLength:16});t.setAuthTag(P),O.byteLength&&t.setAAD(O,{plaintextLength:c.length});let J=t.update(c);return t.final(),J}catch{throw new J.JWEDecryptionFailed}}r.default=(t,r,c,O,W,K)=>{let F;if((0,R.isCryptoKey)(r))(0,U.checkEncCryptoKey)(r,t,"decrypt"),F=u.KeyObject.from(r);else if(r instanceof Uint8Array||(0,D.default)(r))F=r;else throw TypeError((0,B.default)(r,...q.types,"Uint8Array"));switch((0,P.default)(t,F),(0,E.default)(t,O),t){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return cbcDecrypt(t,F,c,O,W,K);case"A128GCM":case"A192GCM":case"A256GCM":return gcmDecrypt(t,F,c,O,W,K);default:throw new J.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},19457:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113);r.default=(t,r)=>(0,u.createHash)(t).update(r).digest()},24211:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(67013);function dsaDigest(t){switch(t){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"EdDSA":return;default:throw new u.JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}r.default=dsaDigest},25426:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ecdhAllowed=r.generateEpk=r.deriveKey=void 0;let u=c(6113),E=c(73837),P=c(49018),O=c(12246),J=c(67013),W=c(24444),K=c(95518),R=c(32874),U=c(74380),D=c(52920),B=(0,E.promisify)(u.generateKeyPair);async function deriveKey(t,r,c,E,P=new Uint8Array(0),J=new Uint8Array(0)){let B,F;if((0,W.isCryptoKey)(t))(0,K.checkEncCryptoKey)(t,"ECDH"),B=u.KeyObject.from(t);else if((0,R.default)(t))B=t;else throw TypeError((0,U.default)(t,...D.types));if((0,W.isCryptoKey)(r))(0,K.checkEncCryptoKey)(r,"ECDH","deriveBits"),F=u.KeyObject.from(r);else if((0,R.default)(r))F=r;else throw TypeError((0,U.default)(r,...D.types));let q=(0,O.concat)((0,O.lengthAndInput)(O.encoder.encode(c)),(0,O.lengthAndInput)(P),(0,O.lengthAndInput)(J),(0,O.uint32be)(E)),G=(0,u.diffieHellman)({privateKey:F,publicKey:B});return(0,O.concatKdf)(G,E,q)}async function generateEpk(t){let r;if((0,W.isCryptoKey)(t))r=u.KeyObject.from(t);else if((0,R.default)(t))r=t;else throw TypeError((0,U.default)(t,...D.types));switch(r.asymmetricKeyType){case"x25519":return B("x25519");case"x448":return B("x448");case"ec":{let t=(0,P.default)(r);return B("ec",{namedCurve:t})}default:throw new J.JOSENotSupported("Invalid or unsupported EPK")}}r.deriveKey=deriveKey,r.generateEpk=generateEpk,r.ecdhAllowed=t=>["P-256","P-384","P-521","X25519","X448"].includes((0,P.default)(t))},22964:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(18736),P=c(16770),O=c(12246),J=c(524),W=c(24444),K=c(95518),R=c(32874),U=c(74380),D=c(67013),B=c(11124),F=c(52920);function cbcEncrypt(t,r,c,E,P){let W=parseInt(t.slice(1,4),10);(0,R.default)(c)&&(c=c.export());let K=c.subarray(W>>3),U=c.subarray(0,W>>3),F=`aes-${W}-cbc`;if(!(0,B.default)(F))throw new D.JOSENotSupported(`alg ${t} is not supported by your javascript runtime`);let q=(0,u.createCipheriv)(F,K,E),G=(0,O.concat)(q.update(r),q.final()),V=parseInt(t.slice(-3),10),X=(0,J.default)(P,E,G,V,U,W);return{ciphertext:G,tag:X}}function gcmEncrypt(t,r,c,E,P){let O=parseInt(t.slice(1,4),10),J=`aes-${O}-gcm`;if(!(0,B.default)(J))throw new D.JOSENotSupported(`alg ${t} is not supported by your javascript runtime`);let W=(0,u.createCipheriv)(J,c,E,{authTagLength:16});P.byteLength&&W.setAAD(P,{plaintextLength:r.length});let K=W.update(r);W.final();let R=W.getAuthTag();return{ciphertext:K,tag:R}}r.default=(t,r,c,O,J)=>{let B;if((0,W.isCryptoKey)(c))(0,K.checkEncCryptoKey)(c,t,"encrypt"),B=u.KeyObject.from(c);else if(c instanceof Uint8Array||(0,R.default)(c))B=c;else throw TypeError((0,U.default)(c,...F.types,"Uint8Array"));switch((0,P.default)(t,B),(0,E.default)(t,O),t){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return cbcEncrypt(t,r,B,O,J);case"A128GCM":case"A192GCM":case"A256GCM":return gcmEncrypt(t,r,B,O,J);default:throw new D.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},31581:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(13685),E=c(95687),P=c(82361),O=c(67013),J=c(12246),fetchJwks=async(t,r,c)=>{let W;switch(t.protocol){case"https:":W=E.get;break;case"http:":W=u.get;break;default:throw TypeError("Unsupported URL protocol.")}let{agent:K,headers:R}=c,U=W(t.href,{agent:K,timeout:r,headers:R}),[D]=await Promise.race([(0,P.once)(U,"response"),(0,P.once)(U,"timeout")]);if(!D)throw U.destroy(),new O.JWKSTimeout;if(200!==D.statusCode)throw new O.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");let B=[];for await(let t of D)B.push(t);try{return JSON.parse(J.decoder.decode((0,J.concat)(...B)))}catch{throw new O.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}};r.default=fetchJwks},43521:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.jwkImport=r.jwkExport=r.rsaPssParams=r.oneShotCallback=void 0;let[c,u]=process.versions.node.split(".").map(t=>parseInt(t,10));r.oneShotCallback=c>=16||15===c&&u>=13,r.rsaPssParams=!("electron"in process.versions)&&(c>=17||16===c&&u>=9),r.jwkExport=c>=16||15===c&&u>=9,r.jwkImport=c>=16||15===c&&u>=12},20418:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.generateKeyPair=r.generateSecret=void 0;let u=c(6113),E=c(73837),P=c(38444),O=c(68719),J=c(67013),W=(0,E.promisify)(u.generateKeyPair);async function generateSecret(t,r){let c;switch(t){case"HS256":case"HS384":case"HS512":case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":c=parseInt(t.slice(-3),10);break;case"A128KW":case"A192KW":case"A256KW":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":c=parseInt(t.slice(1,4),10);break;default:throw new J.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return(0,u.createSecretKey)((0,P.default)(new Uint8Array(c>>3)))}async function generateKeyPair(t,r){var c,u;switch(t){case"RS256":case"RS384":case"RS512":case"PS256":case"PS384":case"PS512":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":case"RSA1_5":{let t=null!==(c=null==r?void 0:r.modulusLength)&&void 0!==c?c:2048;if("number"!=typeof t||t<2048)throw new J.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");let u=await W("rsa",{modulusLength:t,publicExponent:65537});return(0,O.setModulusLength)(u.privateKey,t),(0,O.setModulusLength)(u.publicKey,t),u}case"ES256":return W("ec",{namedCurve:"P-256"});case"ES256K":return W("ec",{namedCurve:"secp256k1"});case"ES384":return W("ec",{namedCurve:"P-384"});case"ES512":return W("ec",{namedCurve:"P-521"});case"EdDSA":switch(null==r?void 0:r.crv){case void 0:case"Ed25519":return W("ed25519");case"Ed448":return W("ed448");default:throw new J.JOSENotSupported("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":let E=null!==(u=null==r?void 0:r.crv)&&void 0!==u?u:"P-256";switch(E){case void 0:case"P-256":case"P-384":case"P-521":return W("ec",{namedCurve:E});case"X25519":return W("x25519");case"X448":return W("x448");default:throw new J.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}default:throw new J.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}}r.generateSecret=generateSecret,r.generateKeyPair=generateKeyPair},49018:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setCurve=r.weakMap=void 0;let u=c(14300),E=c(6113),P=c(67013),O=c(24444),J=c(32874),W=c(74380),K=c(52920),R=u.Buffer.from([42,134,72,206,61,3,1,7]),U=u.Buffer.from([43,129,4,0,34]),D=u.Buffer.from([43,129,4,0,35]),B=u.Buffer.from([43,129,4,0,10]);r.weakMap=new WeakMap;let namedCurveToJOSE=t=>{switch(t){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new P.JOSENotSupported("Unsupported key curve for this operation")}},getNamedCurve=(t,c)=>{var u;let F;if((0,O.isCryptoKey)(t))F=E.KeyObject.from(t);else if((0,J.default)(t))F=t;else throw TypeError((0,W.default)(t,...K.types));if("secret"===F.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(F.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${F.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${F.asymmetricKeyType.slice(1)}`;case"ec":{if(r.weakMap.has(F))return r.weakMap.get(F);let t=null===(u=F.asymmetricKeyDetails)||void 0===u?void 0:u.namedCurve;if(t||"private"!==F.type){if(!t){let r=F.export({format:"der",type:"spki"}),c=r[1]<128?14:15,u=r[c],E=r.slice(c+1,c+1+u);if(E.equals(R))t="prime256v1";else if(E.equals(U))t="secp384r1";else if(E.equals(D))t="secp521r1";else if(E.equals(B))t="secp256k1";else throw new P.JOSENotSupported("Unsupported key curve for this operation")}}else t=getNamedCurve((0,E.createPublicKey)(F),!0);if(c)return t;let O=namedCurveToJOSE(t);return r.weakMap.set(F,O),O}default:throw TypeError("Invalid asymmetric key type for this operation")}};function setCurve(t,c){r.weakMap.set(t,c)}r.setCurve=setCurve,r.default=getNamedCurve},83847:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(24444),P=c(95518),O=c(74380),J=c(52920);function getSignVerifyKey(t,r,c){if(r instanceof Uint8Array){if(!t.startsWith("HS"))throw TypeError((0,O.default)(r,...J.types));return(0,u.createSecretKey)(r)}if(r instanceof u.KeyObject)return r;if((0,E.isCryptoKey)(r))return(0,P.checkSigCryptoKey)(r,t,c),u.KeyObject.from(r);throw TypeError((0,O.default)(r,...J.types,"Uint8Array"))}r.default=getSignVerifyKey},33556:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(67013);function hmacDigest(t){switch(t){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new u.JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}r.default=hmacDigest},52920:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.types=void 0;let u=c(24444),E=c(32874);r.default=t=>(0,E.default)(t)||(0,u.isCryptoKey)(t);let P=["KeyObject"];r.types=P,(globalThis.CryptoKey||(null===u.default||void 0===u.default?void 0:u.default.CryptoKey))&&P.push("CryptoKey")},32874:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(73837);r.default=E.types.isKeyObject?t=>E.types.isKeyObject(t):t=>null!=t&&t instanceof u.KeyObject},43073:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(14300),E=c(6113),P=c(52339),O=c(67013),J=c(49018),W=c(68719),K=c(82109),R=c(43521);r.default=t=>{if(R.jwkImport&&"oct"!==t.kty)return t.d?(0,E.createPrivateKey)({format:"jwk",key:t}):(0,E.createPublicKey)({format:"jwk",key:t});switch(t.kty){case"oct":return(0,E.createSecretKey)((0,P.decode)(t.k));case"RSA":{let r=new K.default,c=void 0!==t.d,P=u.Buffer.from(t.n,"base64"),O=u.Buffer.from(t.e,"base64");c?(r.zero(),r.unsignedInteger(P),r.unsignedInteger(O),r.unsignedInteger(u.Buffer.from(t.d,"base64")),r.unsignedInteger(u.Buffer.from(t.p,"base64")),r.unsignedInteger(u.Buffer.from(t.q,"base64")),r.unsignedInteger(u.Buffer.from(t.dp,"base64")),r.unsignedInteger(u.Buffer.from(t.dq,"base64")),r.unsignedInteger(u.Buffer.from(t.qi,"base64"))):(r.unsignedInteger(P),r.unsignedInteger(O));let J=r.end(),R={key:J,format:"der",type:"pkcs1"},U=c?(0,E.createPrivateKey)(R):(0,E.createPublicKey)(R);return(0,W.setModulusLength)(U,P.length<<3),U}case"EC":{let r=new K.default,c=void 0!==t.d,P=u.Buffer.concat([u.Buffer.alloc(1,4),u.Buffer.from(t.x,"base64"),u.Buffer.from(t.y,"base64")]);if(c){r.zero();let c=new K.default;c.oidFor("ecPublicKey"),c.oidFor(t.crv),r.add(c.end());let O=new K.default;O.one(),O.octStr(u.Buffer.from(t.d,"base64"));let W=new K.default;W.bitStr(P);let R=W.end(u.Buffer.from([161]));O.add(R);let U=O.end(),D=new K.default;D.add(U);let B=D.end(u.Buffer.from([4]));r.add(B);let F=r.end(),q=(0,E.createPrivateKey)({key:F,format:"der",type:"pkcs8"});return(0,J.setCurve)(q,t.crv),q}let O=new K.default;O.oidFor("ecPublicKey"),O.oidFor(t.crv),r.add(O.end()),r.bitStr(P);let W=r.end(),R=(0,E.createPublicKey)({key:W,format:"der",type:"spki"});return(0,J.setCurve)(R,t.crv),R}case"OKP":{let r=new K.default,c=void 0!==t.d;if(c){r.zero();let c=new K.default;c.oidFor(t.crv),r.add(c.end());let P=new K.default;P.octStr(u.Buffer.from(t.d,"base64"));let O=P.end(u.Buffer.from([4]));r.add(O);let J=r.end();return(0,E.createPrivateKey)({key:J,format:"der",type:"pkcs8"})}let P=new K.default;P.oidFor(t.crv),r.add(P.end()),r.bitStr(u.Buffer.from(t.x,"base64"));let O=r.end();return(0,E.createPublicKey)({key:O,format:"der",type:"spki"})}default:throw new O.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}}},91795:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(52339),P=c(15580),O=c(67013),J=c(49018),W=c(24444),K=c(32874),R=c(74380),U=c(52920),D=c(43521),keyToJWK=t=>{let r;if((0,W.isCryptoKey)(t)){if(!t.extractable)throw TypeError("CryptoKey is not extractable");r=u.KeyObject.from(t)}else if((0,K.default)(t))r=t;else if(t instanceof Uint8Array)return{kty:"oct",k:(0,E.encode)(t)};else throw TypeError((0,R.default)(t,...U.types,"Uint8Array"));if(D.jwkExport){if("secret"!==r.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(r.asymmetricKeyType))throw new O.JOSENotSupported("Unsupported key asymmetricKeyType");return r.export({format:"jwk"})}switch(r.type){case"secret":return{kty:"oct",k:(0,E.encode)(r.export())};case"private":case"public":switch(r.asymmetricKeyType){case"rsa":{let t;let c=r.export({format:"der",type:"pkcs1"}),u=new P.default(c);"private"===r.type&&u.unsignedInteger();let O=(0,E.encode)(u.unsignedInteger()),J=(0,E.encode)(u.unsignedInteger());return"private"===r.type&&(t={d:(0,E.encode)(u.unsignedInteger()),p:(0,E.encode)(u.unsignedInteger()),q:(0,E.encode)(u.unsignedInteger()),dp:(0,E.encode)(u.unsignedInteger()),dq:(0,E.encode)(u.unsignedInteger()),qi:(0,E.encode)(u.unsignedInteger())}),u.end(),{kty:"RSA",n:O,e:J,...t}}case"ec":{let t,c,P;let W=(0,J.default)(r);switch(W){case"secp256k1":t=64,c=33,P=-1;break;case"P-256":t=64,c=36,P=-1;break;case"P-384":t=96,c=35,P=-3;break;case"P-521":t=132,c=35,P=-3;break;default:throw new O.JOSENotSupported("Unsupported curve")}if("public"===r.type){let c=r.export({type:"spki",format:"der"});return{kty:"EC",crv:W,x:(0,E.encode)(c.subarray(-t,-t/2)),y:(0,E.encode)(c.subarray(-t/2))}}let K=r.export({type:"pkcs8",format:"der"});return K.length<100&&(c+=P),{...keyToJWK((0,u.createPublicKey)(r)),d:(0,E.encode)(K.subarray(c,c+t/2))}}case"ed25519":case"x25519":{let t=(0,J.default)(r);if("public"===r.type){let c=r.export({type:"spki",format:"der"});return{kty:"OKP",crv:t,x:(0,E.encode)(c.subarray(-32))}}let c=r.export({type:"pkcs8",format:"der"});return{...keyToJWK((0,u.createPublicKey)(r)),d:(0,E.encode)(c.subarray(-32))}}case"ed448":case"x448":{let t=(0,J.default)(r);if("public"===r.type){let c=r.export({type:"spki",format:"der"});return{kty:"OKP",crv:t,x:(0,E.encode)(c.subarray("Ed448"===t?-57:-56))}}let c=r.export({type:"pkcs8",format:"der"});return{...keyToJWK((0,u.createPublicKey)(r)),d:(0,E.encode)(c.subarray("Ed448"===t?-57:-56))}}default:throw new O.JOSENotSupported("Unsupported key asymmetricKeyType")}default:throw new O.JOSENotSupported("Unsupported key type")}};r.default=keyToJWK},83590:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=c(49018),P=c(67013),O=c(68719),J=c(43521),W={padding:u.constants.RSA_PKCS1_PSS_PADDING,saltLength:u.constants.RSA_PSS_SALTLEN_DIGEST},K=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);function keyForCrypto(t,r){switch(t){case"EdDSA":if(!["ed25519","ed448"].includes(r.asymmetricKeyType))throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");return r;case"RS256":case"RS384":case"RS512":if("rsa"!==r.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,O.default)(r,t),r;case J.rsaPssParams&&"PS256":case J.rsaPssParams&&"PS384":case J.rsaPssParams&&"PS512":if("rsa-pss"===r.asymmetricKeyType){let{hashAlgorithm:c,mgf1HashAlgorithm:u,saltLength:E}=r.asymmetricKeyDetails,P=parseInt(t.slice(-3),10);if(void 0!==c&&(c!==`sha${P}`||u!==c))throw TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${t}`);if(void 0!==E&&E>P>>3)throw TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${t}`)}else if("rsa"!==r.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");return(0,O.default)(r,t),{key:r,...W};case!J.rsaPssParams&&"PS256":case!J.rsaPssParams&&"PS384":case!J.rsaPssParams&&"PS512":if("rsa"!==r.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,O.default)(r,t),{key:r,...W};case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==r.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let c=(0,E.default)(r),u=K.get(t);if(c!==u)throw TypeError(`Invalid key curve for the algorithm, its curve must be ${u}, got ${c}`);return{dsaEncoding:"ieee-p1363",key:r}}default:throw new P.JOSENotSupported(`alg ${t} is not supported either by JOSE or your javascript runtime`)}}r.default=keyForCrypto},31019:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decrypt=r.encrypt=void 0;let u=c(73837),E=c(6113),P=c(38444),O=c(12246),J=c(52339),W=c(42778),K=c(79475),R=c(24444),U=c(95518),D=c(32874),B=c(74380),F=c(52920),q=(0,u.promisify)(E.pbkdf2);function getPassword(t,r){if((0,D.default)(t))return t.export();if(t instanceof Uint8Array)return t;if((0,R.isCryptoKey)(t))return(0,U.checkEncCryptoKey)(t,r,"deriveBits","deriveKey"),E.KeyObject.from(t).export();throw TypeError((0,B.default)(t,...F.types,"Uint8Array"))}let encrypt=async(t,r,c,u=2048,E=(0,P.default)(new Uint8Array(16)))=>{(0,K.default)(E);let R=(0,O.p2s)(t,E),U=parseInt(t.slice(13,16),10)>>3,D=getPassword(r,t),B=await q(D,R,u,U,`sha${t.slice(8,11)}`),F=await (0,W.wrap)(t.slice(-6),B,c);return{encryptedKey:F,p2c:u,p2s:(0,J.encode)(E)}};r.encrypt=encrypt;let decrypt=async(t,r,c,u,E)=>{(0,K.default)(E);let P=(0,O.p2s)(t,E),J=parseInt(t.slice(13,16),10)>>3,R=getPassword(r,t),U=await q(R,P,u,J,`sha${t.slice(8,11)}`);return(0,W.unwrap)(t.slice(-6),U,c)};r.decrypt=decrypt},38444:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=c(6113);Object.defineProperty(r,"default",{enumerable:!0,get:function(){return u.randomFillSync}})},92992:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decrypt=r.encrypt=void 0;let u=c(6113),E=c(68719),P=c(24444),O=c(95518),J=c(32874),W=c(74380),K=c(52920),checkKey=(t,r)=>{if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");(0,E.default)(t,r)},resolvePadding=t=>{switch(t){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return u.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return u.constants.RSA_PKCS1_PADDING;default:return}},resolveOaepHash=t=>{switch(t){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function ensureKeyObject(t,r,...c){if((0,J.default)(t))return t;if((0,P.isCryptoKey)(t))return(0,O.checkEncCryptoKey)(t,r,...c),u.KeyObject.from(t);throw TypeError((0,W.default)(t,...K.types))}r.encrypt=(t,r,c)=>{let E=resolvePadding(t),P=resolveOaepHash(t),O=ensureKeyObject(r,t,"wrapKey","encrypt");return checkKey(O,t),(0,u.publicEncrypt)({key:O,oaepHash:P,padding:E},c)},r.decrypt=(t,r,c)=>{let E=resolvePadding(t),P=resolveOaepHash(t),O=ensureKeyObject(r,t,"unwrapKey","decrypt");return checkKey(O,t),(0,u.privateDecrypt)({key:O,oaepHash:P,padding:E},c)}},21062:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default="node:crypto"},64376:(t,r,c)=>{"use strict";let u;Object.defineProperty(r,"__esModule",{value:!0});let E=c(6113),P=c(73837),O=c(24211),J=c(33556),W=c(83590),K=c(83847);u=E.sign.length>3?(0,P.promisify)(E.sign):E.sign;let sign=async(t,r,c)=>{let P=(0,K.default)(t,r,"sign");if(t.startsWith("HS")){let r=E.createHmac((0,J.default)(t),P);return r.update(c),r.digest()}return u((0,O.default)(t),c,(0,W.default)(t,P))};r.default=sign},32072:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(6113),E=u.timingSafeEqual;r.default=E},85134:(t,r,c)=>{"use strict";let u;Object.defineProperty(r,"__esModule",{value:!0});let E=c(6113),P=c(73837),O=c(24211),J=c(83590),W=c(64376),K=c(83847),R=c(43521);u=E.verify.length>4&&R.oneShotCallback?(0,P.promisify)(E.verify):E.verify;let verify=async(t,r,c,P)=>{let R=(0,K.default)(t,r,"verify");if(t.startsWith("HS")){let r=await (0,W.default)(t,R,P);try{return E.timingSafeEqual(c,r)}catch{return!1}}let U=(0,O.default)(t),D=(0,J.default)(t,R);try{return await u(U,P,D,c)}catch{return!1}};r.default=verify},24444:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isCryptoKey=void 0;let u=c(6113),E=c(73837),P=u.webcrypto;r.default=P,r.isCryptoKey=E.types.isCryptoKey?t=>E.types.isCryptoKey(t):t=>!1},29178:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deflate=r.inflate=void 0;let u=c(73837),E=c(59796),P=c(67013),O=(0,u.promisify)(E.inflateRaw),J=(0,u.promisify)(E.deflateRaw);r.inflate=t=>O(t,{maxOutputLength:25e4}).catch(()=>{throw new P.JWEDecompressionFailed}),r.deflate=t=>J(t)},48931:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decode=r.encode=void 0;let u=c(52339);r.encode=u.encode,r.decode=u.decode},79331:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decodeJwt=void 0;let u=c(48931),E=c(12246),P=c(89567),O=c(67013);function decodeJwt(t){let r,c;if("string"!=typeof t)throw new O.JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:J,length:W}=t.split(".");if(5===W)throw new O.JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(3!==W)throw new O.JWTInvalid("Invalid JWT");if(!J)throw new O.JWTInvalid("JWTs must contain a payload");try{r=(0,u.decode)(J)}catch{throw new O.JWTInvalid("Failed to base64url decode the payload")}try{c=JSON.parse(E.decoder.decode(r))}catch{throw new O.JWTInvalid("Failed to parse the decoded payload as JSON")}if(!(0,P.default)(c))throw new O.JWTInvalid("Invalid JWT Claims Set");return c}r.decodeJwt=decodeJwt},51865:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.decodeProtectedHeader=void 0;let u=c(48931),E=c(12246),P=c(89567);function decodeProtectedHeader(t){let r;if("string"==typeof t){let c=t.split(".");(3===c.length||5===c.length)&&([r]=c)}else if("object"==typeof t&&t){if("protected"in t)r=t.protected;else throw TypeError("Token does not contain a Protected Header")}try{if("string"!=typeof r||!r)throw Error();let t=JSON.parse(E.decoder.decode((0,u.decode)(r)));if(!(0,P.default)(t))throw Error();return t}catch{throw TypeError("Invalid Token or Protected Header formatting")}}r.decodeProtectedHeader=decodeProtectedHeader},67013:(t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.JWSSignatureVerificationFailed=r.JWKSTimeout=r.JWKSMultipleMatchingKeys=r.JWKSNoMatchingKey=r.JWKSInvalid=r.JWKInvalid=r.JWTInvalid=r.JWSInvalid=r.JWEInvalid=r.JWEDecompressionFailed=r.JWEDecryptionFailed=r.JOSENotSupported=r.JOSEAlgNotAllowed=r.JWTExpired=r.JWTClaimValidationFailed=r.JOSEError=void 0;let JOSEError=class JOSEError extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(t){var r;super(t),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null===(r=Error.captureStackTrace)||void 0===r||r.call(Error,this,this.constructor)}};r.JOSEError=JOSEError;let JWTClaimValidationFailed=class JWTClaimValidationFailed extends JOSEError{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(t,r="unspecified",c="unspecified"){super(t),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=r,this.reason=c}};r.JWTClaimValidationFailed=JWTClaimValidationFailed;let JWTExpired=class JWTExpired extends JOSEError{static get code(){return"ERR_JWT_EXPIRED"}constructor(t,r="unspecified",c="unspecified"){super(t),this.code="ERR_JWT_EXPIRED",this.claim=r,this.reason=c}};r.JWTExpired=JWTExpired;let JOSEAlgNotAllowed=class JOSEAlgNotAllowed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}};r.JOSEAlgNotAllowed=JOSEAlgNotAllowed;let JOSENotSupported=class JOSENotSupported extends JOSEError{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}};r.JOSENotSupported=JOSENotSupported;let JWEDecryptionFailed=class JWEDecryptionFailed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}};r.JWEDecryptionFailed=JWEDecryptionFailed;let JWEDecompressionFailed=class JWEDecompressionFailed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWE_DECOMPRESSION_FAILED",this.message="decompression operation failed"}static get code(){return"ERR_JWE_DECOMPRESSION_FAILED"}};r.JWEDecompressionFailed=JWEDecompressionFailed;let JWEInvalid=class JWEInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}};r.JWEInvalid=JWEInvalid;let JWSInvalid=class JWSInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}};r.JWSInvalid=JWSInvalid;let JWTInvalid=class JWTInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}};r.JWTInvalid=JWTInvalid;let JWKInvalid=class JWKInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}};r.JWKInvalid=JWKInvalid;let JWKSInvalid=class JWKSInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}};r.JWKSInvalid=JWKSInvalid;let JWKSNoMatchingKey=class JWKSNoMatchingKey extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}};r.JWKSNoMatchingKey=JWKSNoMatchingKey;let JWKSMultipleMatchingKeys=class JWKSMultipleMatchingKeys extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}};r.JWKSMultipleMatchingKeys=JWKSMultipleMatchingKeys,Symbol.asyncIterator;let JWKSTimeout=class JWKSTimeout extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}};r.JWKSTimeout=JWKSTimeout;let JWSSignatureVerificationFailed=class JWSSignatureVerificationFailed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}};r.JWSSignatureVerificationFailed=JWSSignatureVerificationFailed},95298:(t,r,c)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});let u=c(21062);r.default=u.default},70557:(t,r,c)=>{"use strict";let u=c(57242),E=Symbol("max"),P=Symbol("length"),O=Symbol("lengthCalculator"),J=Symbol("allowStale"),W=Symbol("maxAge"),K=Symbol("dispose"),R=Symbol("noDisposeOnSet"),U=Symbol("lruList"),D=Symbol("cache"),B=Symbol("updateAgeOnGet"),naiveLength=()=>1;let LRUCache=class LRUCache{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw TypeError("max must be a non-negative number");this[E]=t.max||1/0;let r=t.length||naiveLength;if(this[O]="function"!=typeof r?naiveLength:r,this[J]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw TypeError("maxAge must be a number");this[W]=t.maxAge||0,this[K]=t.dispose,this[R]=t.noDisposeOnSet||!1,this[B]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw TypeError("max must be a non-negative number");this[E]=t||1/0,trim(this)}get max(){return this[E]}set allowStale(t){this[J]=!!t}get allowStale(){return this[J]}set maxAge(t){if("number"!=typeof t)throw TypeError("maxAge must be a non-negative number");this[W]=t,trim(this)}get maxAge(){return this[W]}set lengthCalculator(t){"function"!=typeof t&&(t=naiveLength),t!==this[O]&&(this[O]=t,this[P]=0,this[U].forEach(t=>{t.length=this[O](t.value,t.key),this[P]+=t.length})),trim(this)}get lengthCalculator(){return this[O]}get length(){return this[P]}get itemCount(){return this[U].length}rforEach(t,r){r=r||this;for(let c=this[U].tail;null!==c;){let u=c.prev;forEachStep(this,t,c,r),c=u}}forEach(t,r){r=r||this;for(let c=this[U].head;null!==c;){let u=c.next;forEachStep(this,t,c,r),c=u}}keys(){return this[U].toArray().map(t=>t.key)}values(){return this[U].toArray().map(t=>t.value)}reset(){this[K]&&this[U]&&this[U].length&&this[U].forEach(t=>this[K](t.key,t.value)),this[D]=new Map,this[U]=new u,this[P]=0}dump(){return this[U].map(t=>!isStale(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[U]}set(t,r,c){if((c=c||this[W])&&"number"!=typeof c)throw TypeError("maxAge must be a number");let u=c?Date.now():0,J=this[O](r,t);if(this[D].has(t)){if(J>this[E])return del(this,this[D].get(t)),!1;let O=this[D].get(t),W=O.value;return this[K]&&!this[R]&&this[K](t,W.value),W.now=u,W.maxAge=c,W.value=r,this[P]+=J-W.length,W.length=J,this.get(t),trim(this),!0}let B=new Entry(t,r,J,u,c);return B.length>this[E]?(this[K]&&this[K](t,r),!1):(this[P]+=B.length,this[U].unshift(B),this[D].set(t,this[U].head),trim(this),!0)}has(t){if(!this[D].has(t))return!1;let r=this[D].get(t).value;return!isStale(this,r)}get(t){return get(this,t,!0)}peek(t){return get(this,t,!1)}pop(){let t=this[U].tail;return t?(del(this,t),t.value):null}del(t){del(this,this[D].get(t))}load(t){this.reset();let r=Date.now();for(let c=t.length-1;c>=0;c--){let u=t[c],E=u.e||0;if(0===E)this.set(u.k,u.v);else{let t=E-r;t>0&&this.set(u.k,u.v,t)}}}prune(){this[D].forEach((t,r)=>get(this,r,!1))}};let get=(t,r,c)=>{let u=t[D].get(r);if(u){let r=u.value;if(isStale(t,r)){if(del(t,u),!t[J])return}else c&&(t[B]&&(u.value.now=Date.now()),t[U].unshiftNode(u));return r.value}},isStale=(t,r)=>{if(!r||!r.maxAge&&!t[W])return!1;let c=Date.now()-r.now;return r.maxAge?c>r.maxAge:t[W]&&c>t[W]},trim=t=>{if(t[P]>t[E])for(let r=t[U].tail;t[P]>t[E]&&null!==r;){let c=r.prev;del(t,r),r=c}},del=(t,r)=>{if(r){let c=r.value;t[K]&&t[K](c.key,c.value),t[P]-=c.length,t[D].delete(c.key),t[U].removeNode(r)}};let Entry=class Entry{constructor(t,r,c,u,E){this.key=t,this.value=r,this.length=c,this.now=u,this.maxAge=E||0}};let forEachStep=(t,r,c,u)=>{let E=c.value;isStale(t,E)&&(del(t,c),t[J]||(E=void 0)),E&&r.call(u,E.value,E.key,t)};t.exports=LRUCache},84793:(t,r,c)=>{"use strict";var u=c(6113);function objectHash(t,r){return r=applyDefaults(t,r),hash(t,r)}(r=t.exports=objectHash).sha1=function(t){return objectHash(t)},r.keys=function(t){return objectHash(t,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},r.MD5=function(t){return objectHash(t,{algorithm:"md5",encoding:"hex"})},r.keysMD5=function(t){return objectHash(t,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var E=u.getHashes?u.getHashes().slice():["sha1","md5"];E.push("passthrough");var P=["buffer","hex","binary","base64"];function applyDefaults(t,r){r=r||{};var c={};if(c.algorithm=r.algorithm||"sha1",c.encoding=r.encoding||"hex",c.excludeValues=!!r.excludeValues,c.algorithm=c.algorithm.toLowerCase(),c.encoding=c.encoding.toLowerCase(),c.ignoreUnknown=!0===r.ignoreUnknown,c.respectType=!1!==r.respectType,c.respectFunctionNames=!1!==r.respectFunctionNames,c.respectFunctionProperties=!1!==r.respectFunctionProperties,c.unorderedArrays=!0===r.unorderedArrays,c.unorderedSets=!1!==r.unorderedSets,c.unorderedObjects=!1!==r.unorderedObjects,c.replacer=r.replacer||void 0,c.excludeKeys=r.excludeKeys||void 0,void 0===t)throw Error("Object argument required.");for(var u=0;u<E.length;++u)E[u].toLowerCase()===c.algorithm.toLowerCase()&&(c.algorithm=E[u]);if(-1===E.indexOf(c.algorithm))throw Error('Algorithm "'+c.algorithm+'"  not supported. supported values: '+E.join(", "));if(-1===P.indexOf(c.encoding)&&"passthrough"!==c.algorithm)throw Error('Encoding "'+c.encoding+'"  not supported. supported values: '+P.join(", "));return c}function isNativeFunction(t){return"function"==typeof t&&null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(t))}function hash(t,r){if(void 0===(c="passthrough"!==r.algorithm?u.createHash(r.algorithm):new PassThrough).write&&(c.write=c.update,c.end=c.update),typeHasher(r,c).dispatch(t),c.update||c.end(""),c.digest)return c.digest("buffer"===r.encoding?void 0:r.encoding);var c,E=c.read();return"buffer"===r.encoding?E:E.toString(r.encoding)}function typeHasher(t,r,c){c=c||[];var write=function(t){return r.update?r.update(t,"utf8"):r.write(t,"utf8")};return{dispatch:function(r){t.replacer&&(r=t.replacer(r));var c=typeof r;return null===r&&(c="null"),this["_"+c](r)},_object:function(r){var u=Object.prototype.toString.call(r),E=/\[object (.*)\]/i.exec(u);E=(E=E?E[1]:"unknown:["+u+"]").toLowerCase();var P=null;if((P=c.indexOf(r))>=0)return this.dispatch("[CIRCULAR:"+P+"]");if(c.push(r),"undefined"!=typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(r))return write("buffer:"),write(r);if("object"!==E&&"function"!==E&&"asyncfunction"!==E){if(this["_"+E])this["_"+E](r);else if(t.ignoreUnknown)return write("["+E+"]");else throw Error('Unknown object type "'+E+'"')}else{var O=Object.keys(r);t.unorderedObjects&&(O=O.sort()),!1===t.respectType||isNativeFunction(r)||O.splice(0,0,"prototype","__proto__","constructor"),t.excludeKeys&&(O=O.filter(function(r){return!t.excludeKeys(r)})),write("object:"+O.length+":");var J=this;return O.forEach(function(c){J.dispatch(c),write(":"),t.excludeValues||J.dispatch(r[c]),write(",")})}},_array:function(r,u){u=void 0!==u?u:!1!==t.unorderedArrays;var E=this;if(write("array:"+r.length+":"),!u||r.length<=1)return r.forEach(function(t){return E.dispatch(t)});var P=[],O=r.map(function(r){var u=new PassThrough,E=c.slice();return typeHasher(t,u,E).dispatch(r),P=P.concat(E.slice(c.length)),u.read().toString()});return c=c.concat(P),O.sort(),this._array(O,!1)},_date:function(t){return write("date:"+t.toJSON())},_symbol:function(t){return write("symbol:"+t.toString())},_error:function(t){return write("error:"+t.toString())},_boolean:function(t){return write("bool:"+t.toString())},_string:function(t){write("string:"+t.length+":"),write(t.toString())},_function:function(r){write("fn:"),isNativeFunction(r)?this.dispatch("[native]"):this.dispatch(r.toString()),!1!==t.respectFunctionNames&&this.dispatch("function-name:"+String(r.name)),t.respectFunctionProperties&&this._object(r)},_number:function(t){return write("number:"+t.toString())},_xml:function(t){return write("xml:"+t.toString())},_null:function(){return write("Null")},_undefined:function(){return write("Undefined")},_regexp:function(t){return write("regex:"+t.toString())},_uint8array:function(t){return write("uint8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint8clampedarray:function(t){return write("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(t))},_int8array:function(t){return write("uint8array:"),this.dispatch(Array.prototype.slice.call(t))},_uint16array:function(t){return write("uint16array:"),this.dispatch(Array.prototype.slice.call(t))},_int16array:function(t){return write("uint16array:"),this.dispatch(Array.prototype.slice.call(t))},_uint32array:function(t){return write("uint32array:"),this.dispatch(Array.prototype.slice.call(t))},_int32array:function(t){return write("uint32array:"),this.dispatch(Array.prototype.slice.call(t))},_float32array:function(t){return write("float32array:"),this.dispatch(Array.prototype.slice.call(t))},_float64array:function(t){return write("float64array:"),this.dispatch(Array.prototype.slice.call(t))},_arraybuffer:function(t){return write("arraybuffer:"),this.dispatch(new Uint8Array(t))},_url:function(t){return write("url:"+t.toString(),"utf8")},_map:function(r){write("map:");var c=Array.from(r);return this._array(c,!1!==t.unorderedSets)},_set:function(r){write("set:");var c=Array.from(r);return this._array(c,!1!==t.unorderedSets)},_file:function(t){return write("file:"),this.dispatch([t.name,t.size,t.type,t.lastModfied])},_blob:function(){if(t.ignoreUnknown)return write("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return write("domwindow")},_bigint:function(t){return write("bigint:"+t.toString())},_process:function(){return write("process")},_timer:function(){return write("timer")},_pipe:function(){return write("pipe")},_tcp:function(){return write("tcp")},_udp:function(){return write("udp")},_tty:function(){return write("tty")},_statwatcher:function(){return write("statwatcher")},_securecontext:function(){return write("securecontext")},_connection:function(){return write("connection")},_zlib:function(){return write("zlib")},_context:function(){return write("context")},_nodescript:function(){return write("nodescript")},_httpparser:function(){return write("httpparser")},_dataview:function(){return write("dataview")},_signal:function(){return write("signal")},_fsevent:function(){return write("fsevent")},_tlswrap:function(){return write("tlswrap")}}}function PassThrough(){return{buf:"",write:function(t){this.buf+=t},end:function(t){this.buf+=t},read:function(){return this.buf}}}r.writeToStream=function(t,r,c){return void 0===c&&(c=r,r={}),typeHasher(r=applyDefaults(t,r),c).dispatch(t)}},32302:function(t,r,c){(function(t,r){var c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i,u=/^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/,E=/[\s\n\\/='"\0<>]/,P=/^xlink:?./,O=/["&<]/;function a(t){if(!1===O.test(t+=""))return t;for(var r=0,c=0,u="",E="";c<t.length;c++){switch(t.charCodeAt(c)){case 34:E="&quot;";break;case 38:E="&amp;";break;case 60:E="&lt;";break;default:continue}c!==r&&(u+=t.slice(r,c)),u+=E,r=c+1}return c!==r&&(u+=t.slice(r,c)),u}var l=function(t,r){return String(t).replace(/(\n+)/g,"$1"+(r||"	"))},f=function(t,r,c){return String(t).length>(r||40)||!c&&-1!==String(t).indexOf("\n")||-1!==String(t).indexOf("<")},J={},W=/([A-Z])/g;function p(t){var r="";for(var u in t){var E=t[u];null!=E&&""!==E&&(r&&(r+=" "),r+="-"==u[0]?u:J[u]||(J[u]=u.replace(W,"-$1").toLowerCase()),r="number"==typeof E&&!1===c.test(u)?r+": "+E+"px;":r+": "+E+";")}return r||void 0}function d(t,r){return Array.isArray(r)?r.reduce(d,t):null!=r&&!1!==r&&t.push(r),t}function _(){this.__d=!0}function v(t,r){return{__v:t,context:r,props:t.props,setState:_,forceUpdate:_,__d:!0,__h:[]}}function g(t,r){var c=t.contextType,u=c&&r[c.__c];return null!=c?u?u.props.value:c.__:r}var K=[];function y(t,c,O,J,W,R){if(null==t||"boolean"==typeof t)return"";if("object"!=typeof t)return a(t);var U=O.pretty,D=U&&"string"==typeof U?U:"	";if(Array.isArray(t)){for(var B="",F=0;F<t.length;F++)U&&F>0&&(B+="\n"),B+=y(t[F],c,O,J,W,R);return B}var q,G=t.type,V=t.props,X=!1;if("function"==typeof G){if(X=!0,!O.shallow||!J&&!1!==O.renderRootComponent){if(G===r.Fragment){var Y=[];return d(Y,t.props.children),y(Y,c,O,!1!==O.shallowHighOrder,W,R)}var Z,Q=t.__c=v(t,c);r.options.__b&&r.options.__b(t);var ee=r.options.__r;if(G.prototype&&"function"==typeof G.prototype.render){var et=g(G,c);(Q=t.__c=new G(V,et)).__v=t,Q._dirty=Q.__d=!0,Q.props=V,null==Q.state&&(Q.state={}),null==Q._nextState&&null==Q.__s&&(Q._nextState=Q.__s=Q.state),Q.context=et,G.getDerivedStateFromProps?Q.state=Object.assign({},Q.state,G.getDerivedStateFromProps(Q.props,Q.state)):Q.componentWillMount&&(Q.componentWillMount(),Q.state=Q._nextState!==Q.state?Q._nextState:Q.__s!==Q.state?Q.__s:Q.state),ee&&ee(t),Z=Q.render(Q.props,Q.state,Q.context)}else for(var er=g(G,c),en=0;Q.__d&&en++<25;)Q.__d=!1,ee&&ee(t),Z=G.call(t.__c,V,er);return Q.getChildContext&&(c=Object.assign({},c,Q.getChildContext())),r.options.diffed&&r.options.diffed(t),y(Z,c,O,!1!==O.shallowHighOrder,W,R)}G=(q=G).displayName||q!==Function&&q.name||function(t){var r=(Function.prototype.toString.call(t).match(/^\s*function\s+([^( ]+)/)||"")[1];if(!r){for(var c=-1,u=K.length;u--;)if(K[u]===t){c=u;break}c<0&&(c=K.push(t)-1),r="UnnamedComponent"+c}return r}(q)}var ei,eo,ea="<"+G;if(V){var es=Object.keys(V);O&&!0===O.sortAttributes&&es.sort();for(var ec=0;ec<es.length;ec++){var el=es[ec],ed=V[el];if("children"!==el){if(!E.test(el)&&(O&&O.allAttributes||"key"!==el&&"ref"!==el&&"__self"!==el&&"__source"!==el)){if("defaultValue"===el)el="value";else if("defaultChecked"===el)el="checked";else if("defaultSelected"===el)el="selected";else if("className"===el){if(void 0!==V.class)continue;el="class"}else W&&P.test(el)&&(el=el.toLowerCase().replace(/^xlink:?/,"xlink:"));if("htmlFor"===el){if(V.for)continue;el="for"}"style"===el&&ed&&"object"==typeof ed&&(ed=p(ed)),"a"===el[0]&&"r"===el[1]&&"boolean"==typeof ed&&(ed=String(ed));var eu=O.attributeHook&&O.attributeHook(el,ed,c,O,X);if(eu||""===eu)ea+=eu;else if("dangerouslySetInnerHTML"===el)eo=ed&&ed.__html;else if("textarea"===G&&"value"===el)ei=ed;else if((ed||0===ed||""===ed)&&"function"!=typeof ed){if(!(!0!==ed&&""!==ed||(ed=el,O&&O.xml))){ea=ea+" "+el;continue}if("value"===el){if("select"===G){R=ed;continue}"option"===G&&R==ed&&void 0===V.selected&&(ea+=" selected")}ea=ea+" "+el+'="'+a(ed)+'"'}}}else ei=ed}}if(U){var ep=ea.replace(/\n\s*/," ");ep===ea||~ep.indexOf("\n")?U&&~ea.indexOf("\n")&&(ea+="\n"):ea=ep}if(ea+=">",E.test(G))throw Error(G+" is not a valid HTML tag name in "+ea);var eh,ef=u.test(G)||O.voidElements&&O.voidElements.test(G),ey=[];if(eo)U&&f(eo)&&(eo="\n"+D+l(eo,D)),ea+=eo;else if(null!=ei&&d(eh=[],ei).length){for(var eg=U&&~ea.indexOf("\n"),em=!1,e_=0;e_<eh.length;e_++){var ev=eh[e_];if(null!=ev&&!1!==ev){var ew=y(ev,c,O,!0,"svg"===G||"foreignObject"!==G&&W,R);if(U&&!eg&&f(ew)&&(eg=!0),ew){if(U){var eb=ew.length>0&&"<"!=ew[0];em&&eb?ey[ey.length-1]+=ew:ey.push(ew),em=eb}else ey.push(ew)}}}if(U&&eg)for(var eS=ey.length;eS--;)ey[eS]="\n"+D+l(ey[eS],D)}if(ey.length||eo)ea+=ey.join("");else if(O&&O.xml)return ea.substring(0,ea.length-1)+" />";return!ef||eh||eo?(U&&~ea.indexOf("\n")&&(ea+="\n"),ea=ea+"</"+G+">"):ea=ea.replace(/>$/," />"),ea}var R={shallow:!0};S.render=S;var b=function(t,r){return S(t,r,R)},U=[];function S(t,c,u){c=c||{};var E,P=r.options.__s;return r.options.__s=!0,E=u&&(u.pretty||u.voidElements||u.sortAttributes||u.shallow||u.allAttributes||u.xml||u.attributeHook)?y(t,c,u):j(t,c,!1,void 0),r.options.__c&&r.options.__c(t,U),r.options.__s=P,U.length=0,E}function k(t,r){return"className"===t?"class":"htmlFor"===t?"for":"defaultValue"===t?"value":"defaultChecked"===t?"checked":"defaultSelected"===t?"selected":r&&P.test(t)?t.toLowerCase().replace(/^xlink:?/,"xlink:"):t}function w(t,r){return"style"===t&&null!=r&&"object"==typeof r?p(r):"a"===t[0]&&"r"===t[1]&&"boolean"==typeof r?String(r):r}var D=Array.isArray,B=Object.assign;function j(t,c,P,O){if(null==t||!0===t||!1===t||""===t)return"";if("object"!=typeof t)return a(t);if(D(t)){for(var J="",W=0;W<t.length;W++)J+=j(t[W],c,P,O);return J}r.options.__b&&r.options.__b(t);var K=t.type,R=t.props;if("function"==typeof K){if(K===r.Fragment)return j(t.props.children,c,P,O);X=K.prototype&&"function"==typeof K.prototype.render?(U=c,q=g(F=t.type,U),G=new F(t.props,q),t.__c=G,G.__v=t,G.__d=!0,G.props=t.props,null==G.state&&(G.state={}),null==G.__s&&(G.__s=G.state),G.context=q,F.getDerivedStateFromProps?G.state=B({},G.state,F.getDerivedStateFromProps(G.props,G.state)):G.componentWillMount&&(G.componentWillMount(),G.state=G.__s!==G.state?G.__s:G.state),(V=r.options.__r)&&V(t),G.render(G.props,G.state,G.context)):function(t,c){var u,E=v(t,c),P=g(t.type,c);t.__c=E;for(var O=r.options.__r,J=0;E.__d&&J++<25;)E.__d=!1,O&&O(t),u=t.type.call(E,t.props,P);return u}(t,c);var U,F,q,G,V,X,Y=t.__c;Y.getChildContext&&(c=B({},c,Y.getChildContext()));var Z=j(X,c,P,O);return r.options.diffed&&r.options.diffed(t),Z}var Q,ee,et="<";if(et+=K,R)for(var er in Q=R.children,R){var en=R[er];if(!("key"===er||"ref"===er||"__self"===er||"__source"===er||"children"===er||"className"===er&&"class"in R||"htmlFor"===er&&"for"in R||E.test(er))){if(en=w(er=k(er,P),en),"dangerouslySetInnerHTML"===er)ee=en&&en.__html;else if("textarea"===K&&"value"===er)Q=en;else if((en||0===en||""===en)&&"function"!=typeof en){if(!0===en||""===en){en=er,et=et+" "+er;continue}if("value"===er){if("select"===K){O=en;continue}"option"!==K||O!=en||"selected"in R||(et+=" selected")}et=et+" "+er+'="'+a(en)+'"'}}}var ei=et;if(et+=">",E.test(K))throw Error(K+" is not a valid HTML tag name in "+et);var eo="",ea=!1;if(ee)eo+=ee,ea=!0;else if("string"==typeof Q)eo+=a(Q),ea=!0;else if(D(Q))for(var es=0;es<Q.length;es++){var ec=Q[es];if(null!=ec&&!1!==ec){var el=j(ec,c,"svg"===K||"foreignObject"!==K&&P,O);el&&(eo+=el,ea=!0)}}else if(null!=Q&&!1!==Q&&!0!==Q){var ed=j(Q,c,"svg"===K||"foreignObject"!==K&&P,O);ed&&(eo+=ed,ea=!0)}if(r.options.diffed&&r.options.diffed(t),ea)et+=eo;else if(u.test(K))return ei+" />";return et+"</"+K+">"}S.shallowRender=b,t.default=S,t.render=S,t.renderToStaticMarkup=S,t.renderToString=S,t.shallowRender=b})(r,c(22838))},54412:(t,r,c)=>{"use strict";t.exports=c(32302).default},22838:(t,r)=>{var c,u,E,P,O,J,W={},K=[],R=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function s(t,r){for(var c in r)t[c]=r[c];return t}function a(t){var r=t.parentNode;r&&r.removeChild(t)}function v(t,r,u){var E,P,O,J={};for(O in r)"key"==O?E=r[O]:"ref"==O?P=r[O]:J[O]=r[O];if(arguments.length>2&&(J.children=arguments.length>3?c.call(arguments,2):u),"function"==typeof t&&null!=t.defaultProps)for(O in t.defaultProps)void 0===J[O]&&(J[O]=t.defaultProps[O]);return h(t,J,E,P,null)}function h(t,r,c,P,O){var J={type:t,props:r,key:c,ref:P,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==O?++E:O};return null==O&&null!=u.vnode&&u.vnode(J),J}function p(t){return t.children}function y(t,r){this.props=t,this.context=r}function d(t,r){if(null==r)return t.__?d(t.__,t.__.__k.indexOf(t)+1):null;for(var c;r<t.__k.length;r++)if(null!=(c=t.__k[r])&&null!=c.__e)return c.__e;return"function"==typeof t.type?d(t):null}function _(t){var r,c;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,r=0;r<t.__k.length;r++)if(null!=(c=t.__k[r])&&null!=c.__e){t.__e=t.__c.base=c.__e;break}return _(t)}}function k(t){(!t.__d&&(t.__d=!0)&&P.push(t)&&!x.__r++||O!==u.debounceRendering)&&((O=u.debounceRendering)||setTimeout)(x)}function x(){for(var t;x.__r=P.length;)t=P.sort(function(t,r){return t.__v.__b-r.__v.__b}),P=[],t.some(function(t){var r,c,u,E,P;t.__d&&(E=(u=t.__v).__e,(P=t.__P)&&(r=[],(c=s({},u)).__v=u.__v+1,I(P,u,c,t.__n,void 0!==P.ownerSVGElement,null!=u.__h?[E]:null,r,null==E?d(u):E,u.__h),T(r,u),u.__e!=E&&_(u)))})}function b(t,r,c,u,E,P,O,J,R,U){var D,B,F,q,G,V,X,Y=u&&u.__k||K,Z=Y.length;for(c.__k=[],D=0;D<r.length;D++)if(null!=(q=c.__k[D]=null==(q=r[D])||"boolean"==typeof q?null:"string"==typeof q||"number"==typeof q||"bigint"==typeof q?h(null,q,null,null,q):Array.isArray(q)?h(p,{children:q},null,null,null):q.__b>0?h(q.type,q.props,q.key,q.ref?q.ref:null,q.__v):q)){if(q.__=c,q.__b=c.__b+1,null===(F=Y[D])||F&&q.key==F.key&&q.type===F.type)Y[D]=void 0;else for(B=0;B<Z;B++){if((F=Y[B])&&q.key==F.key&&q.type===F.type){Y[B]=void 0;break}F=null}I(t,q,F=F||W,E,P,O,J,R,U),G=q.__e,(B=q.ref)&&F.ref!=B&&(X||(X=[]),F.ref&&X.push(F.ref,null,q),X.push(B,q.__c||G,q)),null!=G?(null==V&&(V=G),"function"==typeof q.type&&q.__k===F.__k?q.__d=R=g(q,R,t):R=w(t,q,F,Y,G,R),"function"==typeof c.type&&(c.__d=R)):R&&F.__e==R&&R.parentNode!=t&&(R=d(F))}for(c.__e=V,D=Z;D--;)null!=Y[D]&&L(Y[D],Y[D]);if(X)for(D=0;D<X.length;D++)z(X[D],X[++D],X[++D])}function g(t,r,c){for(var u,E=t.__k,P=0;E&&P<E.length;P++)(u=E[P])&&(u.__=t,r="function"==typeof u.type?g(u,r,c):w(c,u,u,E,u.__e,r));return r}function w(t,r,c,u,E,P){var O,J,W;if(void 0!==r.__d)O=r.__d,r.__d=void 0;else if(null==c||E!=P||null==E.parentNode)e:if(null==P||P.parentNode!==t)t.appendChild(E),O=null;else{for(J=P,W=0;(J=J.nextSibling)&&W<u.length;W+=1)if(J==E)break e;t.insertBefore(E,P),O=P}return void 0!==O?O:E.nextSibling}function m(t,r,c,u,E){var P;for(P in c)"children"===P||"key"===P||P in r||C(t,P,null,c[P],u);for(P in r)E&&"function"!=typeof r[P]||"children"===P||"key"===P||"value"===P||"checked"===P||c[P]===r[P]||C(t,P,r[P],c[P],u)}function A(t,r,c){"-"===r[0]?t.setProperty(r,c):t[r]=null==c?"":"number"!=typeof c||R.test(r)?c:c+"px"}function C(t,r,c,u,E){var P;e:if("style"===r){if("string"==typeof c)t.style.cssText=c;else{if("string"==typeof u&&(t.style.cssText=u=""),u)for(r in u)c&&r in c||A(t.style,r,"");if(c)for(r in c)u&&c[r]===u[r]||A(t.style,r,c[r])}}else if("o"===r[0]&&"n"===r[1])P=r!==(r=r.replace(/Capture$/,"")),r=r.toLowerCase() in t?r.toLowerCase().slice(2):r.slice(2),t.l||(t.l={}),t.l[r+P]=c,c?u||t.addEventListener(r,P?H:$,P):t.removeEventListener(r,P?H:$,P);else if("dangerouslySetInnerHTML"!==r){if(E)r=r.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==r&&"list"!==r&&"form"!==r&&"tabIndex"!==r&&"download"!==r&&r in t)try{t[r]=null==c?"":c;break e}catch(t){}"function"==typeof c||(null==c||!1===c&&-1==r.indexOf("-")?t.removeAttribute(r):t.setAttribute(r,c))}}function $(t){this.l[t.type+!1](u.event?u.event(t):t)}function H(t){this.l[t.type+!0](u.event?u.event(t):t)}function I(t,r,c,E,P,O,J,W,K){var R,U,D,B,F,q,G,V,X,Y,Z,Q,ee,et,er,en=r.type;if(void 0!==r.constructor)return null;null!=c.__h&&(K=c.__h,W=r.__e=c.__e,r.__h=null,O=[W]),(R=u.__b)&&R(r);try{e:if("function"==typeof en){if(V=r.props,X=(R=en.contextType)&&E[R.__c],Y=R?X?X.props.value:R.__:E,c.__c?G=(U=r.__c=c.__c).__=U.__E:("prototype"in en&&en.prototype.render?r.__c=U=new en(V,Y):(r.__c=U=new y(V,Y),U.constructor=en,U.render=M),X&&X.sub(U),U.props=V,U.state||(U.state={}),U.context=Y,U.__n=E,D=U.__d=!0,U.__h=[],U._sb=[]),null==U.__s&&(U.__s=U.state),null!=en.getDerivedStateFromProps&&(U.__s==U.state&&(U.__s=s({},U.__s)),s(U.__s,en.getDerivedStateFromProps(V,U.__s))),B=U.props,F=U.state,D)null==en.getDerivedStateFromProps&&null!=U.componentWillMount&&U.componentWillMount(),null!=U.componentDidMount&&U.__h.push(U.componentDidMount);else{if(null==en.getDerivedStateFromProps&&V!==B&&null!=U.componentWillReceiveProps&&U.componentWillReceiveProps(V,Y),!U.__e&&null!=U.shouldComponentUpdate&&!1===U.shouldComponentUpdate(V,U.__s,Y)||r.__v===c.__v){for(U.props=V,U.state=U.__s,r.__v!==c.__v&&(U.__d=!1),U.__v=r,r.__e=c.__e,r.__k=c.__k,r.__k.forEach(function(t){t&&(t.__=r)}),Z=0;Z<U._sb.length;Z++)U.__h.push(U._sb[Z]);U._sb=[],U.__h.length&&J.push(U);break e}null!=U.componentWillUpdate&&U.componentWillUpdate(V,U.__s,Y),null!=U.componentDidUpdate&&U.__h.push(function(){U.componentDidUpdate(B,F,q)})}if(U.context=Y,U.props=V,U.__v=r,U.__P=t,Q=u.__r,ee=0,"prototype"in en&&en.prototype.render){for(U.state=U.__s,U.__d=!1,Q&&Q(r),R=U.render(U.props,U.state,U.context),et=0;et<U._sb.length;et++)U.__h.push(U._sb[et]);U._sb=[]}else do U.__d=!1,Q&&Q(r),R=U.render(U.props,U.state,U.context),U.state=U.__s;while(U.__d&&++ee<25);U.state=U.__s,null!=U.getChildContext&&(E=s(s({},E),U.getChildContext())),D||null==U.getSnapshotBeforeUpdate||(q=U.getSnapshotBeforeUpdate(B,F)),er=null!=R&&R.type===p&&null==R.key?R.props.children:R,b(t,Array.isArray(er)?er:[er],r,c,E,P,O,J,W,K),U.base=r.__e,r.__h=null,U.__h.length&&J.push(U),G&&(U.__E=U.__=null),U.__e=!1}else null==O&&r.__v===c.__v?(r.__k=c.__k,r.__e=c.__e):r.__e=j(c.__e,r,c,E,P,O,J,K);(R=u.diffed)&&R(r)}catch(t){r.__v=null,(K||null!=O)&&(r.__e=W,r.__h=!!K,O[O.indexOf(W)]=null),u.__e(t,r,c)}}function T(t,r){u.__c&&u.__c(r,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(t){t.call(r)})}catch(t){u.__e(t,r.__v)}})}function j(t,r,u,E,P,O,J,K){var R,U,D,B=u.props,F=r.props,q=r.type,G=0;if("svg"===q&&(P=!0),null!=O){for(;G<O.length;G++)if((R=O[G])&&"setAttribute"in R==!!q&&(q?R.localName===q:3===R.nodeType)){t=R,O[G]=null;break}}if(null==t){if(null===q)return document.createTextNode(F);t=P?document.createElementNS("http://www.w3.org/2000/svg",q):document.createElement(q,F.is&&F),O=null,K=!1}if(null===q)B===F||K&&t.data===F||(t.data=F);else{if(O=O&&c.call(t.childNodes),U=(B=u.props||W).dangerouslySetInnerHTML,D=F.dangerouslySetInnerHTML,!K){if(null!=O)for(B={},G=0;G<t.attributes.length;G++)B[t.attributes[G].name]=t.attributes[G].value;(D||U)&&(D&&(U&&D.__html==U.__html||D.__html===t.innerHTML)||(t.innerHTML=D&&D.__html||""))}if(m(t,F,B,P,K),D)r.__k=[];else if(b(t,Array.isArray(G=r.props.children)?G:[G],r,u,E,P&&"foreignObject"!==q,O,J,O?O[0]:u.__k&&d(u,0),K),null!=O)for(G=O.length;G--;)null!=O[G]&&a(O[G]);K||("value"in F&&void 0!==(G=F.value)&&(G!==t.value||"progress"===q&&!G||"option"===q&&G!==B.value)&&C(t,"value",G,B.value,!1),"checked"in F&&void 0!==(G=F.checked)&&G!==t.checked&&C(t,"checked",G,B.checked,!1))}return t}function z(t,r,c){try{"function"==typeof t?t(r):t.current=r}catch(t){u.__e(t,c)}}function L(t,r,c){var E,P;if(u.unmount&&u.unmount(t),(E=t.ref)&&(E.current&&E.current!==t.__e||z(E,null,r)),null!=(E=t.__c)){if(E.componentWillUnmount)try{E.componentWillUnmount()}catch(t){u.__e(t,r)}E.base=E.__P=null,t.__c=void 0}if(E=t.__k)for(P=0;P<E.length;P++)E[P]&&L(E[P],r,c||"function"!=typeof t.type);c||null==t.__e||a(t.__e),t.__=t.__e=t.__d=void 0}function M(t,r,c){return this.constructor(t,c)}function N(t,r,E){var P,O,J;u.__&&u.__(t,r),O=(P="function"==typeof E)?null:E&&E.__k||r.__k,J=[],I(r,t=(!P&&E||r).__k=v(p,null,[t]),O||W,W,void 0!==r.ownerSVGElement,!P&&E?[E]:O?null:r.firstChild?c.call(r.childNodes):null,J,!P&&E?E:O?O.__e:r.firstChild,P),T(J,t)}c=K.slice,u={__e:function(t,r,c,u){for(var E,P,O;r=r.__;)if((E=r.__c)&&!E.__)try{if((P=E.constructor)&&null!=P.getDerivedStateFromError&&(E.setState(P.getDerivedStateFromError(t)),O=E.__d),null!=E.componentDidCatch&&(E.componentDidCatch(t,u||{}),O=E.__d),O)return E.__E=E}catch(r){t=r}throw t}},E=0,y.prototype.setState=function(t,r){var c;c=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=s({},this.state),"function"==typeof t&&(t=t(s({},c),this.props)),t&&s(c,t),null!=t&&this.__v&&(r&&this._sb.push(r),k(this))},y.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),k(this))},y.prototype.render=p,P=[],x.__r=0,J=0,r.Component=y,r.Fragment=p,r.cloneElement=function(t,r,u){var E,P,O,J=s({},t.props);for(O in r)"key"==O?E=r[O]:"ref"==O?P=r[O]:J[O]=r[O];return arguments.length>2&&(J.children=arguments.length>3?c.call(arguments,2):u),h(t.type,J,E||t.key,P||t.ref,null)},r.createContext=function(t,r){var c={__c:r="__cC"+J++,__:t,Consumer:function(t,r){return t.children(r)},Provider:function(t){var c,u;return this.getChildContext||(c=[],(u={})[r]=this,this.getChildContext=function(){return u},this.shouldComponentUpdate=function(t){this.props.value!==t.value&&c.some(k)},this.sub=function(t){c.push(t);var r=t.componentWillUnmount;t.componentWillUnmount=function(){c.splice(c.indexOf(t),1),r&&r.call(t)}}),t.children}};return c.Provider.__=c.Consumer.contextType=c},r.createElement=v,r.createRef=function(){return{current:null}},r.h=v,r.hydrate=function n(t,r){N(t,r,n)},r.isValidElement=function(t){return null!=t&&void 0===t.constructor},r.options=u,r.render=N,r.toChildArray=function n(t,r){return r=r||[],null==t||"boolean"==typeof t||(Array.isArray(t)?t.some(function(t){n(t,r)}):r.push(t)),r}},62903:(t,r,c)=>{"use strict";let u,E;c.r(r),c.d(r,{NIL:()=>er,parse:()=>G,stringify:()=>D,v1:()=>q,v3:()=>Y,v4:()=>Z,v5:()=>et,validate:()=>R,version:()=>en});var P=c(6113),O=c.n(P);let J=new Uint8Array(256),W=J.length;function rng(){return W>J.length-16&&(O().randomFillSync(J),W=0),J.slice(W,W+=16)}let K=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function validate(t){return"string"==typeof t&&K.test(t)}let R=validate,U=[];for(let t=0;t<256;++t)U.push((t+256).toString(16).substr(1));function stringify(t,r=0){let c=(U[t[r+0]]+U[t[r+1]]+U[t[r+2]]+U[t[r+3]]+"-"+U[t[r+4]]+U[t[r+5]]+"-"+U[t[r+6]]+U[t[r+7]]+"-"+U[t[r+8]]+U[t[r+9]]+"-"+U[t[r+10]]+U[t[r+11]]+U[t[r+12]]+U[t[r+13]]+U[t[r+14]]+U[t[r+15]]).toLowerCase();if(!R(c))throw TypeError("Stringified UUID is invalid");return c}let D=stringify,B=0,F=0;function v1(t,r,c){let P=r&&c||0,O=r||Array(16),J=(t=t||{}).node||u,W=void 0!==t.clockseq?t.clockseq:E;if(null==J||null==W){let r=t.random||(t.rng||rng)();null==J&&(J=u=[1|r[0],r[1],r[2],r[3],r[4],r[5]]),null==W&&(W=E=(r[6]<<8|r[7])&16383)}let K=void 0!==t.msecs?t.msecs:Date.now(),R=void 0!==t.nsecs?t.nsecs:F+1,U=K-B+(R-F)/1e4;if(U<0&&void 0===t.clockseq&&(W=W+1&16383),(U<0||K>B)&&void 0===t.nsecs&&(R=0),R>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");B=K,F=R,E=W,K+=122192928e5;let q=((268435455&K)*1e4+R)%4294967296;O[P++]=q>>>24&255,O[P++]=q>>>16&255,O[P++]=q>>>8&255,O[P++]=255&q;let G=K/4294967296*1e4&268435455;O[P++]=G>>>8&255,O[P++]=255&G,O[P++]=G>>>24&15|16,O[P++]=G>>>16&255,O[P++]=W>>>8|128,O[P++]=255&W;for(let t=0;t<6;++t)O[P+t]=J[t];return r||D(O)}let q=v1;function parse(t){let r;if(!R(t))throw TypeError("Invalid UUID");let c=new Uint8Array(16);return c[0]=(r=parseInt(t.slice(0,8),16))>>>24,c[1]=r>>>16&255,c[2]=r>>>8&255,c[3]=255&r,c[4]=(r=parseInt(t.slice(9,13),16))>>>8,c[5]=255&r,c[6]=(r=parseInt(t.slice(14,18),16))>>>8,c[7]=255&r,c[8]=(r=parseInt(t.slice(19,23),16))>>>8,c[9]=255&r,c[10]=(r=parseInt(t.slice(24,36),16))/1099511627776&255,c[11]=r/4294967296&255,c[12]=r>>>24&255,c[13]=r>>>16&255,c[14]=r>>>8&255,c[15]=255&r,c}let G=parse;function stringToBytes(t){t=unescape(encodeURIComponent(t));let r=[];for(let c=0;c<t.length;++c)r.push(t.charCodeAt(c));return r}function v35(t,r,c){function generateUUID(t,u,E,P){if("string"==typeof t&&(t=stringToBytes(t)),"string"==typeof u&&(u=G(u)),16!==u.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let O=new Uint8Array(16+t.length);if(O.set(u),O.set(t,u.length),(O=c(O))[6]=15&O[6]|r,O[8]=63&O[8]|128,E){P=P||0;for(let t=0;t<16;++t)E[P+t]=O[t];return E}return D(O)}try{generateUUID.name=t}catch(t){}return generateUUID.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",generateUUID.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",generateUUID}function md5(t){return Array.isArray(t)?t=Buffer.from(t):"string"==typeof t&&(t=Buffer.from(t,"utf8")),O().createHash("md5").update(t).digest()}let V=md5,X=v35("v3",48,V),Y=X;function v4(t,r,c){t=t||{};let u=t.random||(t.rng||rng)();if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,r){c=c||0;for(let t=0;t<16;++t)r[c+t]=u[t];return r}return D(u)}let Z=v4;function sha1(t){return Array.isArray(t)?t=Buffer.from(t):"string"==typeof t&&(t=Buffer.from(t,"utf8")),O().createHash("sha1").update(t).digest()}let Q=sha1,ee=v35("v5",80,Q),et=ee,er="00000000-0000-0000-0000-000000000000";function version(t){if(!R(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)}let en=version},7281:t=>{"use strict";t.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}},57242:(t,r,c)=>{"use strict";function Yallist(t){var r=this;if(r instanceof Yallist||(r=new Yallist),r.tail=null,r.head=null,r.length=0,t&&"function"==typeof t.forEach)t.forEach(function(t){r.push(t)});else if(arguments.length>0)for(var c=0,u=arguments.length;c<u;c++)r.push(arguments[c]);return r}function insert(t,r,c){var u=r===t.head?new Node(c,null,r,t):new Node(c,r,r.next,t);return null===u.next&&(t.tail=u),null===u.prev&&(t.head=u),t.length++,u}function push(t,r){t.tail=new Node(r,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function unshift(t,r){t.head=new Node(r,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function Node(t,r,c,u){if(!(this instanceof Node))return new Node(t,r,c,u);this.list=u,this.value=t,r?(r.next=this,this.prev=r):this.prev=null,c?(c.prev=this,this.next=c):this.next=null}t.exports=Yallist,Yallist.Node=Node,Yallist.create=Yallist,Yallist.prototype.removeNode=function(t){if(t.list!==this)throw Error("removing node which does not belong to this list");var r=t.next,c=t.prev;return r&&(r.prev=c),c&&(c.next=r),t===this.head&&(this.head=r),t===this.tail&&(this.tail=c),t.list.length--,t.next=null,t.prev=null,t.list=null,r},Yallist.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var r=this.head;t.list=this,t.next=r,r&&(r.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},Yallist.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var r=this.tail;t.list=this,t.prev=r,r&&(r.next=t),this.tail=t,this.head||(this.head=t),this.length++}},Yallist.prototype.push=function(){for(var t=0,r=arguments.length;t<r;t++)push(this,arguments[t]);return this.length},Yallist.prototype.unshift=function(){for(var t=0,r=arguments.length;t<r;t++)unshift(this,arguments[t]);return this.length},Yallist.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},Yallist.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},Yallist.prototype.forEach=function(t,r){r=r||this;for(var c=this.head,u=0;null!==c;u++)t.call(r,c.value,u,this),c=c.next},Yallist.prototype.forEachReverse=function(t,r){r=r||this;for(var c=this.tail,u=this.length-1;null!==c;u--)t.call(r,c.value,u,this),c=c.prev},Yallist.prototype.get=function(t){for(var r=0,c=this.head;null!==c&&r<t;r++)c=c.next;if(r===t&&null!==c)return c.value},Yallist.prototype.getReverse=function(t){for(var r=0,c=this.tail;null!==c&&r<t;r++)c=c.prev;if(r===t&&null!==c)return c.value},Yallist.prototype.map=function(t,r){r=r||this;for(var c=new Yallist,u=this.head;null!==u;)c.push(t.call(r,u.value,this)),u=u.next;return c},Yallist.prototype.mapReverse=function(t,r){r=r||this;for(var c=new Yallist,u=this.tail;null!==u;)c.push(t.call(r,u.value,this)),u=u.prev;return c},Yallist.prototype.reduce=function(t,r){var c,u=this.head;if(arguments.length>1)c=r;else if(this.head)u=this.head.next,c=this.head.value;else throw TypeError("Reduce of empty list with no initial value");for(var E=0;null!==u;E++)c=t(c,u.value,E),u=u.next;return c},Yallist.prototype.reduceReverse=function(t,r){var c,u=this.tail;if(arguments.length>1)c=r;else if(this.tail)u=this.tail.prev,c=this.tail.value;else throw TypeError("Reduce of empty list with no initial value");for(var E=this.length-1;null!==u;E--)c=t(c,u.value,E),u=u.prev;return c},Yallist.prototype.toArray=function(){for(var t=Array(this.length),r=0,c=this.head;null!==c;r++)t[r]=c.value,c=c.next;return t},Yallist.prototype.toArrayReverse=function(){for(var t=Array(this.length),r=0,c=this.tail;null!==c;r++)t[r]=c.value,c=c.prev;return t},Yallist.prototype.slice=function(t,r){(r=r||this.length)<0&&(r+=this.length),(t=t||0)<0&&(t+=this.length);var c=new Yallist;if(r<t||r<0)return c;t<0&&(t=0),r>this.length&&(r=this.length);for(var u=0,E=this.head;null!==E&&u<t;u++)E=E.next;for(;null!==E&&u<r;u++,E=E.next)c.push(E.value);return c},Yallist.prototype.sliceReverse=function(t,r){(r=r||this.length)<0&&(r+=this.length),(t=t||0)<0&&(t+=this.length);var c=new Yallist;if(r<t||r<0)return c;t<0&&(t=0),r>this.length&&(r=this.length);for(var u=this.length,E=this.tail;null!==E&&u>r;u--)E=E.prev;for(;null!==E&&u>t;u--,E=E.prev)c.push(E.value);return c},Yallist.prototype.splice=function(t,r,...c){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var u=0,E=this.head;null!==E&&u<t;u++)E=E.next;for(var P=[],u=0;E&&u<r;u++)P.push(E.value),E=this.removeNode(E);null===E&&(E=this.tail),E!==this.head&&E!==this.tail&&(E=E.prev);for(var u=0;u<c.length;u++)E=insert(this,E,c[u]);return P},Yallist.prototype.reverse=function(){for(var t=this.head,r=this.tail,c=t;null!==c;c=c.prev){var u=c.prev;c.prev=c.next,c.next=u}return this.head=r,this.tail=t,this};try{c(7281)(Yallist)}catch(t){}},28016:t=>{"use strict";function _OverloadYield(t,r){this.v=t,this.k=r}t.exports=_OverloadYield,t.exports.__esModule=!0,t.exports.default=t.exports},57384:t=>{"use strict";function _assertThisInitialized(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}t.exports=_assertThisInitialized,t.exports.__esModule=!0,t.exports.default=t.exports},48824:t=>{"use strict";function asyncGeneratorStep(t,r,c,u,E,P,O){try{var J=t[P](O),W=J.value}catch(t){return void c(t)}J.done?r(W):Promise.resolve(W).then(u,E)}function _asyncToGenerator(t){return function(){var r=this,c=arguments;return new Promise(function(u,E){var P=t.apply(r,c);function _next(t){asyncGeneratorStep(P,u,E,_next,_throw,"next",t)}function _throw(t){asyncGeneratorStep(P,u,E,_next,_throw,"throw",t)}_next(void 0)})}}t.exports=_asyncToGenerator,t.exports.__esModule=!0,t.exports.default=t.exports},36707:t=>{"use strict";function _classCallCheck(t,r){if(!(t instanceof r))throw TypeError("Cannot call a class as a function")}t.exports=_classCallCheck,t.exports.__esModule=!0,t.exports.default=t.exports},89250:(t,r,c)=>{"use strict";var u=c(15501),E=c(4474);function _construct(t,r,c){if(u())return Reflect.construct.apply(null,arguments);var P=[null];P.push.apply(P,r);var O=new(t.bind.apply(t,P));return c&&E(O,c.prototype),O}t.exports=_construct,t.exports.__esModule=!0,t.exports.default=t.exports},91390:(t,r,c)=>{"use strict";var u=c(54987);function _defineProperties(t,r){for(var c=0;c<r.length;c++){var E=r[c];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(t,u(E.key),E)}}function _createClass(t,r,c){return r&&_defineProperties(t.prototype,r),c&&_defineProperties(t,c),Object.defineProperty(t,"prototype",{writable:!1}),t}t.exports=_createClass,t.exports.__esModule=!0,t.exports.default=t.exports},92174:(t,r,c)=>{"use strict";var u=c(54987);function _defineProperty(t,r,c){return(r=u(r))in t?Object.defineProperty(t,r,{value:c,enumerable:!0,configurable:!0,writable:!0}):t[r]=c,t}t.exports=_defineProperty,t.exports.__esModule=!0,t.exports.default=t.exports},14432:t=>{"use strict";function _extends(){return t.exports=_extends=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var c=arguments[r];for(var u in c)({}).hasOwnProperty.call(c,u)&&(t[u]=c[u])}return t},t.exports.__esModule=!0,t.exports.default=t.exports,_extends.apply(null,arguments)}t.exports=_extends,t.exports.__esModule=!0,t.exports.default=t.exports},51327:t=>{"use strict";function _getPrototypeOf(r){return t.exports=_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,_getPrototypeOf(r)}t.exports=_getPrototypeOf,t.exports.__esModule=!0,t.exports.default=t.exports},52603:(t,r,c)=>{"use strict";var u=c(4474);function _inherits(t,r){if("function"!=typeof r&&null!==r)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&u(t,r)}t.exports=_inherits,t.exports.__esModule=!0,t.exports.default=t.exports},2049:t=>{"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}t.exports=_interopRequireDefault,t.exports.__esModule=!0,t.exports.default=t.exports},55357:t=>{"use strict";function _isNativeFunction(t){try{return -1!==Function.toString.call(t).indexOf("[native code]")}catch(r){return"function"==typeof t}}t.exports=_isNativeFunction,t.exports.__esModule=!0,t.exports.default=t.exports},15501:t=>{"use strict";function _isNativeReflectConstruct(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(t.exports=_isNativeReflectConstruct=function(){return!!r},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=_isNativeReflectConstruct,t.exports.__esModule=!0,t.exports.default=t.exports},17257:(t,r,c)=>{"use strict";var u=c(44493).default,E=c(57384);function _possibleConstructorReturn(t,r){if(r&&("object"==u(r)||"function"==typeof r))return r;if(void 0!==r)throw TypeError("Derived constructors may only return object or undefined");return E(t)}t.exports=_possibleConstructorReturn,t.exports.__esModule=!0,t.exports.default=t.exports},75881:(t,r,c)=>{"use strict";var u=c(23667);function _regenerator(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var r,c,E="function"==typeof Symbol?Symbol:{},P=E.iterator||"@@iterator",O=E.toStringTag||"@@toStringTag";function i(t,E,P,O){var W=Object.create((E&&E.prototype instanceof Generator?E:Generator).prototype);return u(W,"_invoke",function(t,u,E){var P,O,W,K=0,R=E||[],U=!1,D={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function(t,c){return P=t,O=0,W=r,D.n=c,J}};function d(t,u){for(O=t,W=u,c=0;!U&&K&&!E&&c<R.length;c++){var E,P=R[c],B=D.p,F=P[2];t>3?(E=F===u)&&(W=P[(O=P[4])?5:(O=3,3)],P[4]=P[5]=r):P[0]<=B&&((E=t<2&&B<P[1])?(O=0,D.v=u,D.n=P[1]):B<F&&(E=t<3||P[0]>u||u>F)&&(P[4]=t,P[5]=u,D.n=F,O=0))}if(E||t>1)return J;throw U=!0,u}return function(E,R,B){if(K>1)throw TypeError("Generator is already running");for(U&&1===R&&d(R,B),O=R,W=B;(c=O<2?r:W)||!U;){P||(O?O<3?(O>1&&(D.n=-1),d(O,W)):D.n=W:D.v=W);try{if(K=2,P){if(O||(E="next"),c=P[E]){if(!(c=c.call(P,W)))throw TypeError("iterator result is not an object");if(!c.done)return c;W=c.value,O<2&&(O=0)}else 1===O&&(c=P.return)&&c.call(P),O<2&&(W=TypeError("The iterator does not provide a '"+E+"' method"),O=1);P=r}else if((c=(U=D.n<0)?W:t.call(u,D))!==J)break}catch(t){P=r,O=1,W=t}finally{K=1}}return{value:c,done:U}}}(t,P,O),!0),W}var J={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}c=Object.getPrototypeOf;var W=[][P]?c(c([][P]())):(u(c={},P,function(){return this}),c),K=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(W);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,u(t,O,"GeneratorFunction")),t.prototype=Object.create(K),t}return GeneratorFunction.prototype=GeneratorFunctionPrototype,u(K,"constructor",GeneratorFunctionPrototype),u(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName="GeneratorFunction",u(GeneratorFunctionPrototype,O,"GeneratorFunction"),u(K),u(K,O,"Generator"),u(K,P,function(){return this}),u(K,"toString",function(){return"[object Generator]"}),(t.exports=_regenerator=function(){return{w:i,m:f}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=_regenerator,t.exports.__esModule=!0,t.exports.default=t.exports},62414:(t,r,c)=>{"use strict";var u=c(26008);function _regeneratorAsync(t,r,c,E,P){var O=u(t,r,c,E,P);return O.next().then(function(t){return t.done?t.value:O.next()})}t.exports=_regeneratorAsync,t.exports.__esModule=!0,t.exports.default=t.exports},26008:(t,r,c)=>{"use strict";var u=c(75881),E=c(81267);function _regeneratorAsyncGen(t,r,c,P,O){return new E(u().w(t,r,c,P),O||Promise)}t.exports=_regeneratorAsyncGen,t.exports.__esModule=!0,t.exports.default=t.exports},81267:(t,r,c)=>{"use strict";var u=c(28016),E=c(23667);function AsyncIterator(t,r){var c;function n(c,E,P,O){try{var J=t[c](E),W=J.value;return W instanceof u?r.resolve(W.v).then(function(t){n("next",t,P,O)},function(t){n("throw",t,P,O)}):r.resolve(W).then(function(t){J.value=t,P(J)},function(t){return n("throw",t,P,O)})}catch(t){O(t)}}this.next||(E(AsyncIterator.prototype),E(AsyncIterator.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),E(this,"_invoke",function(t,u,E){function f(){return new r(function(r,c){n(t,E,r,c)})}return c=c?c.then(f,f):f()},!0)}t.exports=AsyncIterator,t.exports.__esModule=!0,t.exports.default=t.exports},23667:t=>{"use strict";function _regeneratorDefine(r,c,u,E){var P=Object.defineProperty;try{P({},"",{})}catch(t){P=0}t.exports=_regeneratorDefine=function(t,r,c,u){function o(r,c){_regeneratorDefine(t,r,function(t){return this._invoke(r,c,t)})}r?P?P(t,r,{value:c,enumerable:!u,configurable:!u,writable:!u}):t[r]=c:(o("next",0),o("throw",1),o("return",2))},t.exports.__esModule=!0,t.exports.default=t.exports,_regeneratorDefine(r,c,u,E)}t.exports=_regeneratorDefine,t.exports.__esModule=!0,t.exports.default=t.exports},71012:t=>{"use strict";function _regeneratorKeys(t){var r=Object(t),c=[];for(var u in r)c.unshift(u);return function e(){for(;c.length;)if((u=c.pop())in r)return e.value=u,e.done=!1,e;return e.done=!0,e}}t.exports=_regeneratorKeys,t.exports.__esModule=!0,t.exports.default=t.exports},86601:(t,r,c)=>{"use strict";var u=c(28016),E=c(75881),P=c(62414),O=c(26008),J=c(81267),W=c(71012),K=c(97038);function _regeneratorRuntime(){var r=E(),c=r.m(_regeneratorRuntime),R=(Object.getPrototypeOf?Object.getPrototypeOf(c):c.__proto__).constructor;function n(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===R||"GeneratorFunction"===(r.displayName||r.name))}var U={throw:1,return:2,break:3,continue:3};function a(t){var r,c;return function(u){r||(r={stop:function(){return c(u.a,2)},catch:function(){return u.v},abrupt:function(t,r){return c(u.a,U[t],r)},delegateYield:function(t,E,P){return r.resultName=E,c(u.d,K(t),P)},finish:function(t){return c(u.f,t)}},c=function(t,c,E){u.p=r.prev,u.n=r.next;try{return t(c,E)}finally{r.next=u.n}}),r.resultName&&(r[r.resultName]=u.v,r.resultName=void 0),r.sent=u.v,r.next=u.n;try{return t.call(this,r)}finally{u.p=r.prev,u.n=r.next}}}return(t.exports=_regeneratorRuntime=function(){return{wrap:function(t,c,u,E){return r.w(a(t),c,u,E&&E.reverse())},isGeneratorFunction:n,mark:r.m,awrap:function(t,r){return new u(t,r)},AsyncIterator:J,async:function(t,r,c,u,E){return(n(r)?O:P)(a(t),r,c,u,E)},keys:W,values:K}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=_regeneratorRuntime,t.exports.__esModule=!0,t.exports.default=t.exports},97038:(t,r,c)=>{"use strict";var u=c(44493).default;function _regeneratorValues(t){if(null!=t){var r=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],c=0;if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&c>=t.length&&(t=void 0),{value:t&&t[c++],done:!t}}}}throw TypeError(u(t)+" is not iterable")}t.exports=_regeneratorValues,t.exports.__esModule=!0,t.exports.default=t.exports},4474:t=>{"use strict";function _setPrototypeOf(r,c){return t.exports=_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},t.exports.__esModule=!0,t.exports.default=t.exports,_setPrototypeOf(r,c)}t.exports=_setPrototypeOf,t.exports.__esModule=!0,t.exports.default=t.exports},14171:(t,r,c)=>{"use strict";var u=c(44493).default;function toPrimitive(t,r){if("object"!=u(t)||!t)return t;var c=t[Symbol.toPrimitive];if(void 0!==c){var E=c.call(t,r||"default");if("object"!=u(E))return E;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}t.exports=toPrimitive,t.exports.__esModule=!0,t.exports.default=t.exports},54987:(t,r,c)=>{"use strict";var u=c(44493).default,E=c(14171);function toPropertyKey(t){var r=E(t,"string");return"symbol"==u(r)?r:r+""}t.exports=toPropertyKey,t.exports.__esModule=!0,t.exports.default=t.exports},44493:t=>{"use strict";function _typeof(r){return t.exports=_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,_typeof(r)}t.exports=_typeof,t.exports.__esModule=!0,t.exports.default=t.exports},49903:(t,r,c)=>{"use strict";var u=c(51327),E=c(4474),P=c(55357),O=c(89250);function _wrapNativeSuper(r){var c="function"==typeof Map?new Map:void 0;return t.exports=_wrapNativeSuper=function(t){if(null===t||!P(t))return t;if("function"!=typeof t)throw TypeError("Super expression must either be null or a function");if(void 0!==c){if(c.has(t))return c.get(t);c.set(t,Wrapper)}function Wrapper(){return O(t,arguments,u(this).constructor)}return Wrapper.prototype=Object.create(t.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),E(Wrapper,t)},t.exports.__esModule=!0,t.exports.default=t.exports,_wrapNativeSuper(r)}t.exports=_wrapNativeSuper,t.exports.__esModule=!0,t.exports.default=t.exports},21264:(t,r,c)=>{"use strict";var u=c(86601)();t.exports=u;try{regeneratorRuntime=u}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=u:Function("r","regeneratorRuntime = r")(u)}},87658:t=>{"use strict";t.exports=JSON.parse('{"name":"openid-client","version":"5.7.1","description":"OpenID Connect Relying Party (RP, Client) implementation for Node.js runtime, supports passportjs","keywords":["auth","authentication","basic","certified","client","connect","dynamic","electron","hybrid","identity","implicit","oauth","oauth2","oidc","openid","passport","relying party","strategy"],"homepage":"https://github.com/panva/openid-client","repository":"panva/openid-client","funding":{"url":"https://github.com/sponsors/panva"},"license":"MIT","author":"Filip Skokan <panva.ip@gmail.com>","exports":{"types":"./types/index.d.ts","import":"./lib/index.mjs","require":"./lib/index.js"},"main":"./lib/index.js","types":"./types/index.d.ts","files":["lib","types/index.d.ts"],"scripts":{"format":"npx prettier --loglevel silent --write ./lib ./test ./certification ./types","test":"mocha test/**/*.test.js"},"dependencies":{"jose":"^4.15.9","lru-cache":"^6.0.0","object-hash":"^2.2.0","oidc-token-hash":"^5.0.3"},"devDependencies":{"@types/node":"^16.18.106","@types/passport":"^1.0.16","base64url":"^3.0.1","chai":"^4.5.0","mocha":"^10.7.3","nock":"^13.5.5","prettier":"^2.8.8","readable-mock-req":"^0.2.2","sinon":"^9.2.4","timekeeper":"^2.3.1"},"standard-version":{"scripts":{"postchangelog":"sed -i \'\' -e \'s/### \\\\[/## [/g\' CHANGELOG.md"},"types":[{"type":"feat","section":"Features"},{"type":"fix","section":"Fixes"},{"type":"chore","hidden":true},{"type":"docs","hidden":true},{"type":"style","hidden":true},{"type":"refactor","section":"Refactor","hidden":false},{"type":"perf","section":"Performance","hidden":false},{"type":"test","hidden":true}]}}')}};